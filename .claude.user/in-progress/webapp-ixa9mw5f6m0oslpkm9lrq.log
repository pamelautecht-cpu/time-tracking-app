{"type":"system","subtype":"hook_response","session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"e167c2ec-c2c0-47de-bc62-9dc43cec6edf","hook_name":"SessionStart:resume","hook_event":"SessionStart","stdout":"","stderr":"","exit_code":0}
{"type":"system","subtype":"hook_response","session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"f785f468-e379-4ecc-a99f-debad2458233","hook_name":"SessionStart:resume","hook_event":"SessionStart","stdout":"=== RESUMING SESSION - MODIFICATION GUIDANCE ===\n\n## DATA LAYER\n\n- IF you have any data layer related requirements, use the 'database-administrator' subagent\n- Send the user's actual requirements as-is to the subagent.\n\n=== END OF MODIFICATION GUIDANCE ===\n","stderr":"","exit_code":0}
{"type":"system","subtype":"init","cwd":"/home/user/vite-template","session_id":"752928d6-a510-485a-bbfe-46da4a277f96","tools":["Task","Bash","Glob","Grep","ExitPlanMode","Read","Edit","Write","NotebookEdit","WebFetch","TodoWrite","WebSearch","BashOutput","KillShell","Skill","SlashCommand","EnterPlanMode"],"mcp_servers":[],"model":"claude-sonnet-4-5","permissionMode":"bypassPermissions","slash_commands":["compact","context","cost","init","pr-comments","release-notes","todos","review","security-review"],"apiKeySource":"none","claude_code_version":"2.0.53","output_style":"default","agents":["general-purpose","statusline-setup","Explore","Plan","integration-administrator","database-administrator"],"skills":[],"plugins":[],"uuid":"3e0a284d-160d-456b-80aa-2eb76bb13fdb"}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01TBsyAmAxMuCNwqRYewGQzr","type":"message","role":"assistant","content":[{"type":"text","text":"I'll implement all three features you requested: User Management, Weekly Reports, and Overtime Tracking with the ability to manually add time cards. Let me start right away!"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":114855,"cache_read_input_tokens":16310,"cache_creation":{"ephemeral_5m_input_tokens":114855,"ephemeral_1h_input_tokens":0},"output_tokens":3},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"4b6e0f53-f908-4458-9259-7f8d9471f430"}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01TBsyAmAxMuCNwqRYewGQzr","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_vrtx_01QMMkRMbzS2yG9RX8J3pFdt","name":"TodoWrite","input":{"todos":[{"content":"Add User Management - Create/Edit/Delete employees","activeForm":"Adding User Management functionality","status":"in_progress"},{"content":"Implement Weekly Reports with summary view","activeForm":"Implementing Weekly Reports","status":"pending"},{"content":"Add Overtime Tracking (>40 hours/week)","activeForm":"Adding Overtime Tracking","status":"pending"},{"content":"Add manual time card entry for missed clock ins","activeForm":"Adding manual time card entry","status":"pending"},{"content":"Add Spanish translations for new features","activeForm":"Adding Spanish translations","status":"pending"},{"content":"Run type checking and validation","activeForm":"Running type checking","status":"pending"}]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":114855,"cache_read_input_tokens":16310,"cache_creation":{"ephemeral_5m_input_tokens":114855,"ephemeral_1h_input_tokens":0},"output_tokens":271},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"7fb5b6fa-0960-4f7a-9bd8-3450a1c8495e"}
{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_vrtx_01QMMkRMbzS2yG9RX8J3pFdt","type":"tool_result","content":"Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable"}]},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"e76b2785-3157-4e02-afbe-3cd882012847","tool_use_result":{"oldTodos":[],"newTodos":[{"content":"Add User Management - Create/Edit/Delete employees","status":"in_progress","activeForm":"Adding User Management functionality"},{"content":"Implement Weekly Reports with summary view","status":"pending","activeForm":"Implementing Weekly Reports"},{"content":"Add Overtime Tracking (>40 hours/week)","status":"pending","activeForm":"Adding Overtime Tracking"},{"content":"Add manual time card entry for missed clock ins","status":"pending","activeForm":"Adding manual time card entry"},{"content":"Add Spanish translations for new features","status":"pending","activeForm":"Adding Spanish translations"},{"content":"Run type checking and validation","status":"pending","activeForm":"Running type checking"}]}}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01DcX6kzXvsJytVMXH673ebR","type":"message","role":"assistant","content":[{"type":"text","text":"Now let me implement the comprehensive update with all three features:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":310,"cache_read_input_tokens":131165,"cache_creation":{"ephemeral_5m_input_tokens":310,"ephemeral_1h_input_tokens":0},"output_tokens":1},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"a833e4c6-fbfe-49cc-933b-86bcbc9615c4"}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01DcX6kzXvsJytVMXH673ebR","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_vrtx_01Ab3sh8WFLhwHG5tz3WEYp1","name":"Write","input":{"file_path":"/home/user/vite-template/src/routes/index.tsx","content":"import { createFileRoute } from \"@tanstack/react-router\";\nimport { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Clock, Users, CalendarDays, Timer, Languages, Coffee, UserPlus, FileText, AlertCircle, Plus } from \"lucide-react\";\nimport { UserORM, type UserModel, UserRole } from \"@/sdk/database/orm/orm_user\";\nimport { TimeCardEntryORM, type TimeCardEntryModel } from \"@/sdk/database/orm/orm_time_card_entry\";\n\nexport const Route = createFileRoute(\"/\")({\n\tcomponent: App,\n});\n\ntype Language = 'en' | 'es';\n\nconst translations = {\n\ten: {\n\t\tappTitle: \"Employee Time Tracking\",\n\t\tselectAccount: \"Select your account to continue\",\n\t\tselectUser: \"Select User\",\n\t\tchooseAccount: \"Choose your account\",\n\t\tmanager: \"Manager\",\n\t\temployee: \"Employee\",\n\t\tswitchUser: \"Switch User\",\n\t\ttimeTrackingSystem: \"Time Tracking System\",\n\t\twelcome: \"Welcome\",\n\t\tclockInOut: \"Clock In/Out\",\n\t\tcurrentlyClocked: \"Currently Clocked In\",\n\t\tsince: \"Since\",\n\t\telapsedTime: \"Elapsed Time\",\n\t\tclockOut: \"Clock Out\",\n\t\tnotClocked: \"Not currently clocked in\",\n\t\tclockIn: \"Clock In\",\n\t\ttimeCardHistory: \"Time Card History\",\n\t\trecentRecords: \"Your recent clock in/out records\",\n\t\tnoTimeCards: \"No time cards yet\",\n\t\tclockInTime: \"Clock In\",\n\t\tclockOutTime: \"Clock Out\",\n\t\thours: \"Hours\",\n\t\tstatus: \"Status\",\n\t\tcompleted: \"Completed\",\n\t\tactive: \"Active\",\n\t\ttotalEmployees: \"Total Employees\",\n\t\thoursToday: \"Hours Today\",\n\t\thoursThisWeek: \"Hours This Week\",\n\t\tallEmployeeTimeCards: \"All Employee Time Cards\",\n\t\tviewManageRecords: \"View and manage all employee time records\",\n\t\tfilterByEmployee: \"Filter by Employee\",\n\t\tallEmployees: \"All Employees\",\n\t\tfilterByDate: \"Filter by Date\",\n\t\tclearFilters: \"Clear Filters\",\n\t\tnoTimeCardsFound: \"No time cards found\",\n\t\temployeeName: \"Employee\",\n\t\tactions: \"Actions\",\n\t\tedit: \"Edit\",\n\t\teditTimeCard: \"Edit Time Card\",\n\t\tcancel: \"Cancel\",\n\t\tsaveChanges: \"Save Changes\",\n\t\tlocation: \"Location\",\n\t\twhereWorked: \"Where did you work?\",\n\t\tworkDescription: \"Work Description\",\n\t\twhatDid: \"What did you do today?\",\n\t\tlocationPlaceholder: \"e.g., Office, Remote, Client Site\",\n\t\tdescriptionPlaceholder: \"Describe your work activities...\",\n\t\tstartLunch: \"Start Lunch Break\",\n\t\tendLunch: \"End Lunch Break\",\n\t\tonLunchBreak: \"On Lunch Break\",\n\t\tlunchBreak: \"Lunch Break\",\n\t\tlunchDuration: \"Lunch\",\n\t\tlunchStartTime: \"Lunch Start\",\n\t\tlunchEndTime: \"Lunch End\",\n\t\ttimeCards: \"Time Cards\",\n\t\treports: \"Reports\",\n\t\temployees: \"Employees\",\n\t\taddEmployee: \"Add Employee\",\n\t\teditEmployee: \"Edit Employee\",\n\t\tdeleteEmployee: \"Delete Employee\",\n\t\tname: \"Name\",\n\t\temail: \"Email\",\n\t\trole: \"Role\",\n\t\tdelete: \"Delete\",\n\t\tweeklyReport: \"Weekly Report\",\n\t\tselectWeek: \"Select Week\",\n\t\tregularHours: \"Regular\",\n\t\tovertimeHours: \"Overtime\",\n\t\ttotalHours: \"Total\",\n\t\tnoReportData: \"No data for selected week\",\n\t\taddTimeCard: \"Add Time Card\",\n\t\tmanualEntry: \"Manual Entry\",\n\t\taddManualEntry: \"Add Manual Time Card\",\n\t\tconfirmDelete: \"Are you sure you want to delete this employee?\",\n\t\tovertimeAlert: \"Overtime Alert\",\n\t},\n\tes: {\n\t\tappTitle: \"Registro de Tiempo de Empleados\",\n\t\tselectAccount: \"Selecciona tu cuenta para continuar\",\n\t\tselectUser: \"Seleccionar Usuario\",\n\t\tchooseAccount: \"Elige tu cuenta\",\n\t\tmanager: \"Gerente\",\n\t\temployee: \"Empleado\",\n\t\tswitchUser: \"Cambiar Usuario\",\n\t\ttimeTrackingSystem: \"Sistema de Registro de Tiempo\",\n\t\twelcome: \"Bienvenido\",\n\t\tclockInOut: \"Entrada/Salida\",\n\t\tcurrentlyClocked: \"Actualmente Registrado\",\n\t\tsince: \"Desde\",\n\t\telapsedTime: \"Tiempo Transcurrido\",\n\t\tclockOut: \"Registrar Salida\",\n\t\tnotClocked: \"No está registrado actualmente\",\n\t\tclockIn: \"Registrar Entrada\",\n\t\ttimeCardHistory: \"Historial de Tarjetas de Tiempo\",\n\t\trecentRecords: \"Tus registros recientes de entrada/salida\",\n\t\tnoTimeCards: \"No hay tarjetas de tiempo todavía\",\n\t\tclockInTime: \"Entrada\",\n\t\tclockOutTime: \"Salida\",\n\t\thours: \"Horas\",\n\t\tstatus: \"Estado\",\n\t\tcompleted: \"Completado\",\n\t\tactive: \"Activo\",\n\t\ttotalEmployees: \"Total de Empleados\",\n\t\thoursToday: \"Horas Hoy\",\n\t\thoursThisWeek: \"Horas Esta Semana\",\n\t\tallEmployeeTimeCards: \"Todas las Tarjetas de Tiempo\",\n\t\tviewManageRecords: \"Ver y gestionar todos los registros de empleados\",\n\t\tfilterByEmployee: \"Filtrar por Empleado\",\n\t\tallEmployees: \"Todos los Empleados\",\n\t\tfilterByDate: \"Filtrar por Fecha\",\n\t\tclearFilters: \"Limpiar Filtros\",\n\t\tnoTimeCardsFound: \"No se encontraron tarjetas de tiempo\",\n\t\temployeeName: \"Empleado\",\n\t\tactions: \"Acciones\",\n\t\tedit: \"Editar\",\n\t\teditTimeCard: \"Editar Tarjeta de Tiempo\",\n\t\tcancel: \"Cancelar\",\n\t\tsaveChanges: \"Guardar Cambios\",\n\t\tlocation: \"Ubicación\",\n\t\twhereWorked: \"¿Dónde trabajaste?\",\n\t\tworkDescription: \"Descripción del Trabajo\",\n\t\twhatDid: \"¿Qué hiciste hoy?\",\n\t\tlocationPlaceholder: \"ej., Oficina, Remoto, Sitio del Cliente\",\n\t\tdescriptionPlaceholder: \"Describe tus actividades laborales...\",\n\t\tstartLunch: \"Iniciar Almuerzo\",\n\t\tendLunch: \"Terminar Almuerzo\",\n\t\tonLunchBreak: \"En Almuerzo\",\n\t\tlunchBreak: \"Almuerzo\",\n\t\tlunchDuration: \"Almuerzo\",\n\t\tlunchStartTime: \"Inicio Almuerzo\",\n\t\tlunchEndTime: \"Fin Almuerzo\",\n\t\ttimeCards: \"Tarjetas de Tiempo\",\n\t\treports: \"Informes\",\n\t\temployees: \"Empleados\",\n\t\taddEmployee: \"Agregar Empleado\",\n\t\teditEmployee: \"Editar Empleado\",\n\t\tdeleteEmployee: \"Eliminar Empleado\",\n\t\tname: \"Nombre\",\n\t\temail: \"Correo\",\n\t\trole: \"Rol\",\n\t\tdelete: \"Eliminar\",\n\t\tweeklyReport: \"Informe Semanal\",\n\t\tselectWeek: \"Seleccionar Semana\",\n\t\tregularHours: \"Regular\",\n\t\tovertimeHours: \"Tiempo Extra\",\n\t\ttotalHours: \"Total\",\n\t\tnoReportData: \"No hay datos para la semana seleccionada\",\n\t\taddTimeCard: \"Agregar Tarjeta\",\n\t\tmanualEntry: \"Entrada Manual\",\n\t\taddManualEntry: \"Agregar Tarjeta Manual\",\n\t\tconfirmDelete: \"¿Está seguro de eliminar este empleado?\",\n\t\tovertimeAlert: \"Alerta de Tiempo Extra\",\n\t}\n};\n\nfunction App() {\n\tconst [currentUser, setCurrentUser] = useState<UserModel | null>(null);\n\tconst [users, setUsers] = useState<UserModel[]>([]);\n\tconst [showUserSelect, setShowUserSelect] = useState(true);\n\tconst [language, setLanguage] = useState<Language>('en');\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadUsers();\n\t}, []);\n\n\tconst loadUsers = async () => {\n\t\tconst userORM = UserORM.getInstance();\n\t\tconst allUsers = await userORM.getAllUser();\n\n\t\t// If no users exist, create demo users\n\t\tif (allUsers.length === 0) {\n\t\t\tconst demoUsers = await userORM.insertUser([\n\t\t\t\t{\n\t\t\t\t\tname: \"John Smith\",\n\t\t\t\t\temail: \"john@example.com\",\n\t\t\t\t\trole: UserRole.Employee,\n\t\t\t\t} as UserModel,\n\t\t\t\t{\n\t\t\t\t\tname: \"Sarah Johnson\",\n\t\t\t\t\temail: \"sarah@example.com\",\n\t\t\t\t\trole: UserRole.Employee,\n\t\t\t\t} as UserModel,\n\t\t\t\t{\n\t\t\t\t\tname: \"Mike Manager\",\n\t\t\t\t\temail: \"mike@example.com\",\n\t\t\t\t\trole: UserRole.Manager,\n\t\t\t\t} as UserModel,\n\t\t\t]);\n\t\t\tsetUsers(demoUsers);\n\t\t} else {\n\t\t\tsetUsers(allUsers);\n\t\t}\n\t};\n\n\tconst handleUserSelect = (userId: string) => {\n\t\tconst user = users.find(u => u.id === userId);\n\t\tif (user) {\n\t\t\tsetCurrentUser(user);\n\t\t\tsetShowUserSelect(false);\n\t\t}\n\t};\n\n\tconst handleLogout = () => {\n\t\tsetCurrentUser(null);\n\t\tsetShowUserSelect(true);\n\t};\n\n\tconst toggleLanguage = () => {\n\t\tsetLanguage(prev => prev === 'en' ? 'es' : 'en');\n\t};\n\n\tif (showUserSelect || !currentUser) {\n\t\treturn (\n\t\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4\">\n\t\t\t\t<div className=\"absolute top-4 right-4\">\n\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t\t<Card className=\"w-full max-w-md\">\n\t\t\t\t\t<CardHeader>\n\t\t\t\t\t\t<CardTitle className=\"text-2xl\">{t.appTitle}</CardTitle>\n\t\t\t\t\t\t<CardDescription>{t.selectAccount}</CardDescription>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<Label>{t.selectUser}</Label>\n\t\t\t\t\t\t\t<Select onValueChange={handleUserSelect}>\n\t\t\t\t\t\t\t\t<SelectTrigger className=\"w-full\">\n\t\t\t\t\t\t\t\t\t<SelectValue placeholder={t.chooseAccount} />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t{users.map((user) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={user.id} value={user.id}>\n\t\t\t\t\t\t\t\t\t\t\t{user.name} - {user.role === UserRole.Manager ? t.manager : t.employee}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800\">\n\t\t\t<div className=\"container mx-auto p-6 space-y-6\">\n\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h1 className=\"text-3xl font-bold\">{t.timeTrackingSystem}</h1>\n\t\t\t\t\t\t<p className=\"text-muted-foreground\">\n\t\t\t\t\t\t\t{t.welcome}, {currentUser.name} ({currentUser.role === UserRole.Manager ? t.manager : t.employee})\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleLogout} variant=\"outline\">\n\t\t\t\t\t\t\t{t.switchUser}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{currentUser.role === UserRole.Employee ? (\n\t\t\t\t\t<EmployeeView user={currentUser} language={language} />\n\t\t\t\t) : (\n\t\t\t\t\t<ManagerView user={currentUser} users={users} language={language} onUsersChange={loadUsers} />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction EmployeeView({ user, language }: { user: UserModel; language: Language }) {\n\tconst [activeShift, setActiveShift] = useState<TimeCardEntryModel | null>(null);\n\tconst [timeCards, setTimeCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [elapsedTime, setElapsedTime] = useState(0);\n\tconst [location, setLocation] = useState(\"\");\n\tconst [workDescription, setWorkDescription] = useState(\"\");\n\tconst [isOnLunch, setIsOnLunch] = useState(false);\n\tconst [showManualEntry, setShowManualEntry] = useState(false);\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadTimeCards();\n\t}, [user.id]);\n\n\tuseEffect(() => {\n\t\tlet interval: NodeJS.Timeout;\n\t\tif (activeShift && !isOnLunch) {\n\t\t\tinterval = setInterval(() => {\n\t\t\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp) * 1000;\n\t\t\t\tconst elapsed = Date.now() - clockInTime;\n\t\t\t\tsetElapsedTime(elapsed);\n\t\t\t}, 1000);\n\t\t}\n\t\treturn () => clearInterval(interval);\n\t}, [activeShift, isOnLunch]);\n\n\tconst loadTimeCards = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst userTimeCards = await timeCardORM.getTimeCardEntryByUserId(user.id);\n\n\t\t// Sort by clock in time (newest first)\n\t\tconst sorted = userTimeCards.sort((a, b) =>\n\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n\t\t);\n\n\t\tsetTimeCards(sorted);\n\n\t\t// Find active shift (no clock out time)\n\t\tconst active = sorted.find(tc => !tc.clock_out_timestamp);\n\t\tsetActiveShift(active || null);\n\t\tif (active) {\n\t\t\tsetLocation(active.location || \"\");\n\t\t\tsetWorkDescription(active.work_description || \"\");\n\t\t\t// Check if on lunch break\n\t\t\tsetIsOnLunch(!!(active.lunch_start_timestamp && !active.lunch_end_timestamp));\n\t\t} else {\n\t\t\tsetIsOnLunch(false);\n\t\t}\n\t};\n\n\tconst handleClockIn = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tawait timeCardORM.insertTimeCardEntry([{\n\t\t\tuser_id: user.id,\n\t\t\tclock_in_timestamp: now,\n\t\t\tlocation: location || null,\n\t\t\twork_description: workDescription || null,\n\t\t} as TimeCardEntryModel]);\n\n\t\tsetLocation(\"\");\n\t\tsetWorkDescription(\"\");\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleClockOut = async () => {\n\t\tif (!activeShift) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp);\n\t\tconst clockOutTime = parseInt(now);\n\t\tlet totalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t// Deduct lunch time if lunch was taken\n\t\tif (activeShift.lunch_duration_minutes) {\n\t\t\ttotalHours -= activeShift.lunch_duration_minutes / 60;\n\t\t}\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tclock_out_timestamp: now,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: location || activeShift.location,\n\t\t\twork_description: workDescription || activeShift.work_description,\n\t\t});\n\n\t\tsetLocation(\"\");\n\t\tsetWorkDescription(\"\");\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleStartLunch = async () => {\n\t\tif (!activeShift) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tlunch_start_timestamp: now,\n\t\t\tlocation: location || activeShift.location,\n\t\t\twork_description: workDescription || activeShift.work_description,\n\t\t});\n\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleEndLunch = async () => {\n\t\tif (!activeShift || !activeShift.lunch_start_timestamp) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tconst lunchStartTime = parseInt(activeShift.lunch_start_timestamp);\n\t\tconst lunchEndTime = parseInt(now);\n\t\tconst lunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;\n\n\t\t// Add to existing lunch duration if there was already one\n\t\tconst totalLunchMinutes = (activeShift.lunch_duration_minutes || 0) + lunchDurationMinutes;\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tlunch_end_timestamp: now,\n\t\t\tlunch_duration_minutes: totalLunchMinutes,\n\t\t});\n\n\t\tawait loadTimeCards();\n\t};\n\n\tconst formatTime = (ms: number) => {\n\t\tconst seconds = Math.floor(ms / 1000);\n\t\tconst hours = Math.floor(seconds / 3600);\n\t\tconst minutes = Math.floor((seconds % 3600) / 60);\n\t\tconst secs = seconds % 60;\n\t\treturn `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n\t};\n\n\tconst formatDate = (timestamp: string) => {\n\t\tconst date = new Date(parseInt(timestamp) * 1000);\n\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n\t};\n\n\tconst formatHours = (hours: number | null | undefined) => {\n\t\tif (hours === null || hours === undefined) return \"—\";\n\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n\t};\n\n\tconst formatMinutes = (minutes: number | null | undefined) => {\n\t\tif (minutes === null || minutes === undefined) return \"—\";\n\t\treturn `${Math.round(minutes)} min`;\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t<Clock className=\"w-5 h-5\" />\n\t\t\t\t\t\t\t{t.clockInOut}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t\t<Button onClick={() => setShowManualEntry(true)} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t\t<Plus className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{t.addTimeCard}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t{activeShift ? (\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t{isOnLunch ? (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-orange-800 dark:text-orange-200\">{t.onLunchBreak}</p>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-orange-600 dark:text-orange-300\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.since} {activeShift.lunch_start_timestamp && formatDate(activeShift.lunch_start_timestamp)}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-green-800 dark:text-green-200\">{t.currentlyClocked}</p>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300\">\n\t\t\t\t\t\t\t\t\t\t\t{t.since} {formatDate(activeShift.clock_in_timestamp)}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t{activeShift.location && (\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.location}: {activeShift.location}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t{activeShift.lunch_duration_minutes && activeShift.lunch_duration_minutes > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.lunchBreak}: {formatMinutes(activeShift.lunch_duration_minutes)}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-mono font-bold text-green-800 dark:text-green-200\">\n\t\t\t\t\t\t\t\t\t\t\t{formatTime(elapsedTime)}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-green-600 dark:text-green-300\">{t.elapsedTime}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{!isOnLunch && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-2\">\n\t\t\t\t\t\t\t\t{isOnLunch ? (\n\t\t\t\t\t\t\t\t\t<Button onClick={handleEndLunch} variant=\"default\" className=\"col-span-2\">\n\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t\t\t\t{t.endLunch}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={handleStartLunch} variant=\"outline\">\n\t\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t\t\t\t\t{t.startLunch}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={handleClockOut} variant=\"destructive\">\n\t\t\t\t\t\t\t\t\t\t\t{t.clockOut}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center\">\n\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground\">{t.notClocked}</p>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<Label>{t.whereWorked}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<Label>{t.whatDid}</Label>\n\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Button onClick={handleClockIn} className=\"w-full\">\n\t\t\t\t\t\t\t\t{t.clockIn}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<CalendarDays className=\"w-5 h-5\" />\n\t\t\t\t\t\t{t.timeCardHistory}\n\t\t\t\t\t</CardTitle>\n\t\t\t\t\t<CardDescription>{t.recentRecords}</CardDescription>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent>\n\t\t\t\t\t{timeCards.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCards}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{timeCards.map((tc) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<ManualEntryDialog\n\t\t\t\topen={showManualEntry}\n\t\t\t\tonClose={() => setShowManualEntry(false)}\n\t\t\t\tuserId={user.id}\n\t\t\t\tonSave={loadTimeCards}\n\t\t\t\tlanguage={language}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nfunction ManagerView({ user, users, language, onUsersChange }: { user: UserModel; users: UserModel[]; language: Language; onUsersChange: () => void }) {\n\tconst [activeTab, setActiveTab] = useState(\"timecards\");\n\n\tconst t = translations[language];\n\n\treturn (\n\t\t<Tabs value={activeTab} onValueChange={setActiveTab}>\n\t\t\t<TabsList className=\"grid w-full grid-cols-3\">\n\t\t\t\t<TabsTrigger value=\"timecards\">\n\t\t\t\t\t<Clock className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t{t.timeCards}\n\t\t\t\t</TabsTrigger>\n\t\t\t\t<TabsTrigger value=\"reports\">\n\t\t\t\t\t<FileText className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t{t.reports}\n\t\t\t\t</TabsTrigger>\n\t\t\t\t<TabsTrigger value=\"employees\">\n\t\t\t\t\t<Users className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t{t.employees}\n\t\t\t\t</TabsTrigger>\n\t\t\t</TabsList>\n\n\t\t\t<TabsContent value=\"timecards\" className=\"space-y-4\">\n\t\t\t\t<TimeCardsTab users={users} language={language} />\n\t\t\t</TabsContent>\n\n\t\t\t<TabsContent value=\"reports\" className=\"space-y-4\">\n\t\t\t\t<ReportsTab users={users} language={language} />\n\t\t\t</TabsContent>\n\n\t\t\t<TabsContent value=\"employees\" className=\"space-y-4\">\n\t\t\t\t<EmployeesTab users={users} language={language} onUsersChange={onUsersChange} />\n\t\t\t</TabsContent>\n\t\t</Tabs>\n\t);\n}\n\nfunction TimeCardsTab({ users, language }: { users: UserModel[]; language: Language }) {\n\tconst [allTimeCards, setAllTimeCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [filteredCards, setFilteredCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [selectedEmployee, setSelectedEmployee] = useState<string>(\"all\");\n\tconst [dateFilter, setDateFilter] = useState<string>(\"\");\n\tconst [editingCard, setEditingCard] = useState<TimeCardEntryModel | null>(null);\n\tconst [editClockIn, setEditClockIn] = useState(\"\");\n\tconst [editClockOut, setEditClockOut] = useState(\"\");\n\tconst [editLocation, setEditLocation] = useState(\"\");\n\tconst [editWorkDescription, setEditWorkDescription] = useState(\"\");\n\tconst [editLunchStart, setEditLunchStart] = useState(\"\");\n\tconst [editLunchEnd, setEditLunchEnd] = useState(\"\");\n\tconst [showManualEntry, setShowManualEntry] = useState(false);\n\tconst [manualEntryUserId, setManualEntryUserId] = useState<string>(\"\");\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadAllTimeCards();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tapplyFilters();\n\t}, [allTimeCards, selectedEmployee, dateFilter]);\n\n\tconst loadAllTimeCards = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst allCards = await timeCardORM.getAllTimeCardEntry();\n\n\t\t// Sort by clock in time (newest first)\n\t\tconst sorted = allCards.sort((a, b) =>\n\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n\t\t);\n\n\t\tsetAllTimeCards(sorted);\n\t};\n\n\tconst applyFilters = () => {\n\t\tlet filtered = [...allTimeCards];\n\n\t\t// Filter by employee\n\t\tif (selectedEmployee !== \"all\") {\n\t\t\tfiltered = filtered.filter(tc => tc.user_id === selectedEmployee);\n\t\t}\n\n\t\t// Filter by date\n\t\tif (dateFilter) {\n\t\t\tconst filterDate = new Date(dateFilter);\n\t\t\tconst filterTimestamp = Math.floor(filterDate.getTime() / 1000);\n\t\t\tconst nextDayTimestamp = filterTimestamp + 86400; // +24 hours\n\n\t\t\tfiltered = filtered.filter(tc => {\n\t\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\t\treturn clockIn >= filterTimestamp && clockIn < nextDayTimestamp;\n\t\t\t});\n\t\t}\n\n\t\tsetFilteredCards(filtered);\n\t};\n\n\tconst getUserName = (userId: string) => {\n\t\tconst user = users.find(u => u.id === userId);\n\t\treturn user?.name || \"Unknown\";\n\t};\n\n\tconst formatDate = (timestamp: string) => {\n\t\tconst date = new Date(parseInt(timestamp) * 1000);\n\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n\t};\n\n\tconst formatHours = (hours: number | null | undefined) => {\n\t\tif (hours === null || hours === undefined) return \"—\";\n\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n\t};\n\n\tconst formatMinutes = (minutes: number | null | undefined) => {\n\t\tif (minutes === null || minutes === undefined) return \"—\";\n\t\treturn `${Math.round(minutes)} min`;\n\t};\n\n\tconst calculateTotalHours = (period: 'day' | 'week') => {\n\t\tconst now = Date.now() / 1000;\n\t\tconst periodSeconds = period === 'day' ? 86400 : 604800; // 1 day or 7 days\n\t\tconst startTime = now - periodSeconds;\n\n\t\tconst relevantCards = allTimeCards.filter(tc => {\n\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\treturn clockIn >= startTime && tc.total_hours;\n\t\t});\n\n\t\treturn relevantCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);\n\t};\n\n\tconst handleEditCard = (card: TimeCardEntryModel) => {\n\t\tsetEditingCard(card);\n\t\tsetEditClockIn(new Date(parseInt(card.clock_in_timestamp) * 1000).toISOString().slice(0, 16));\n\t\tsetEditClockOut(\n\t\t\tcard.clock_out_timestamp\n\t\t\t\t? new Date(parseInt(card.clock_out_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t\tsetEditLocation(card.location || \"\");\n\t\tsetEditWorkDescription(card.work_description || \"\");\n\t\tsetEditLunchStart(\n\t\t\tcard.lunch_start_timestamp\n\t\t\t\t? new Date(parseInt(card.lunch_start_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t\tsetEditLunchEnd(\n\t\t\tcard.lunch_end_timestamp\n\t\t\t\t? new Date(parseInt(card.lunch_end_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t};\n\n\tconst handleSaveEdit = async () => {\n\t\tif (!editingCard) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst clockInTimestamp = Math.floor(new Date(editClockIn).getTime() / 1000).toString();\n\t\tconst clockOutTimestamp = editClockOut\n\t\t\t? Math.floor(new Date(editClockOut).getTime() / 1000).toString()\n\t\t\t: null;\n\t\tconst lunchStartTimestamp = editLunchStart\n\t\t\t? Math.floor(new Date(editLunchStart).getTime() / 1000).toString()\n\t\t\t: null;\n\t\tconst lunchEndTimestamp = editLunchEnd\n\t\t\t? Math.floor(new Date(editLunchEnd).getTime() / 1000).toString()\n\t\t\t: null;\n\n\t\tlet totalHours = null;\n\t\tlet lunchDurationMinutes = null;\n\n\t\t// Calculate lunch duration\n\t\tif (lunchStartTimestamp && lunchEndTimestamp) {\n\t\t\tconst lunchStart = parseInt(lunchStartTimestamp);\n\t\t\tconst lunchEnd = parseInt(lunchEndTimestamp);\n\t\t\tlunchDurationMinutes = (lunchEnd - lunchStart) / 60;\n\t\t}\n\n\t\t// Calculate total hours\n\t\tif (clockOutTimestamp) {\n\t\t\tconst clockInTime = parseInt(clockInTimestamp);\n\t\t\tconst clockOutTime = parseInt(clockOutTimestamp);\n\t\t\ttotalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t\t// Deduct lunch time\n\t\t\tif (lunchDurationMinutes) {\n\t\t\t\ttotalHours -= lunchDurationMinutes / 60;\n\t\t\t}\n\t\t}\n\n\t\tawait timeCardORM.setTimeCardEntryById(editingCard.id, {\n\t\t\t...editingCard,\n\t\t\tclock_in_timestamp: clockInTimestamp,\n\t\t\tclock_out_timestamp: clockOutTimestamp,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: editLocation || null,\n\t\t\twork_description: editWorkDescription || null,\n\t\t\tlunch_start_timestamp: lunchStartTimestamp,\n\t\t\tlunch_end_timestamp: lunchEndTimestamp,\n\t\t\tlunch_duration_minutes: lunchDurationMinutes,\n\t\t});\n\n\t\tsetEditingCard(null);\n\t\tawait loadAllTimeCards();\n\t};\n\n\tconst handleAddManualEntry = (userId: string) => {\n\t\tsetManualEntryUserId(userId);\n\t\tsetShowManualEntry(true);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<Users className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.totalEmployees}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{users.filter(u => u.role === UserRole.Employee).length}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<Timer className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.hoursToday}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('day').toFixed(2)}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<CalendarDays className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.hoursThisWeek}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('week').toFixed(2)}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<CardTitle>{t.allEmployeeTimeCards}</CardTitle>\n\t\t\t\t\t\t\t<CardDescription>{t.viewManageRecords}</CardDescription>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button onClick={() => handleAddManualEntry(\"\")} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t\t<Plus className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{t.addTimeCard}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t<div className=\"flex gap-4 flex-wrap\">\n\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n\t\t\t\t\t\t\t<Label>{t.filterByEmployee}</Label>\n\t\t\t\t\t\t\t<Select value={selectedEmployee} onValueChange={setSelectedEmployee}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t<SelectItem value=\"all\">{t.allEmployees}</SelectItem>\n\t\t\t\t\t\t\t\t\t{users.filter(u => u.role === UserRole.Employee).map((u) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={u.id} value={u.id}>\n\t\t\t\t\t\t\t\t\t\t\t{u.name}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n\t\t\t\t\t\t\t<Label>{t.filterByDate}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\t\tvalue={dateFilter}\n\t\t\t\t\t\t\t\tonChange={(e) => setDateFilter(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{(selectedEmployee !== \"all\" || dateFilter) && (\n\t\t\t\t\t\t\t<div className=\"flex items-end\">\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tsetSelectedEmployee(\"all\");\n\t\t\t\t\t\t\t\t\t\tsetDateFilter(\"\");\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{t.clearFilters}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{filteredCards.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCardsFound}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.employeeName}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.actions}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{filteredCards.map((tc) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium whitespace-nowrap\">{getUserName(tc.user_id)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleEditCard(tc)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t.edit}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Dialog open={!!editingCard} onOpenChange={(open) => !open && setEditingCard(null)}>\n\t\t\t\t<DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.editTimeCard}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.employeeName}</Label>\n\t\t\t\t\t\t\t<Input value={editingCard ? getUserName(editingCard.user_id) : \"\"} disabled />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.clockInTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editClockIn}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockIn(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.clockOutTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editClockOut}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockOut(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={editLocation}\n\t\t\t\t\t\t\t\tonChange={(e) => setEditLocation(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\tvalue={editWorkDescription}\n\t\t\t\t\t\t\t\tonChange={(e) => setEditWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\trows={4}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.lunchStartTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editLunchStart}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchStart(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.lunchEndTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editLunchEnd}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchEnd(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setEditingCard(null)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleSaveEdit}>\n\t\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\n\t\t\t<ManualEntryDialog\n\t\t\t\topen={showManualEntry}\n\t\t\t\tonClose={() => setShowManualEntry(false)}\n\t\t\t\tuserId={manualEntryUserId}\n\t\t\t\tonSave={loadAllTimeCards}\n\t\t\t\tlanguage={language}\n\t\t\t\tusers={users}\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nfunction ReportsTab({ users, language }: { users: UserModel[]; language: Language }) {\n\tconst [weekStart, setWeekStart] = useState(\"\");\n\tconst [reportData, setReportData] = useState<{ user: UserModel; regularHours: number; overtimeHours: number; totalHours: number }[]>([]);\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\t// Set default to current week\n\t\tconst today = new Date();\n\t\tconst monday = new Date(today);\n\t\tmonday.setDate(today.getDate() - today.getDay() + 1);\n\t\tsetWeekStart(monday.toISOString().slice(0, 10));\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (weekStart) {\n\t\t\tloadWeeklyReport();\n\t\t}\n\t}, [weekStart, users]);\n\n\tconst loadWeeklyReport = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst allCards = await timeCardORM.getAllTimeCardEntry();\n\n\t\tconst weekStartDate = new Date(weekStart);\n\t\tconst weekStartTimestamp = Math.floor(weekStartDate.getTime() / 1000);\n\t\tconst weekEndTimestamp = weekStartTimestamp + 604800; // 7 days\n\n\t\tconst weekCards = allCards.filter(tc => {\n\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\treturn clockIn >= weekStartTimestamp && clockIn < weekEndTimestamp && tc.total_hours;\n\t\t});\n\n\t\tconst employeeHours = users\n\t\t\t.filter(u => u.role === UserRole.Employee)\n\t\t\t.map(user => {\n\t\t\t\tconst userCards = weekCards.filter(tc => tc.user_id === user.id);\n\t\t\t\tconst totalHours = userCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);\n\t\t\t\tconst regularHours = Math.min(totalHours, 40);\n\t\t\t\tconst overtimeHours = Math.max(totalHours - 40, 0);\n\n\t\t\t\treturn {\n\t\t\t\t\tuser,\n\t\t\t\t\tregularHours,\n\t\t\t\t\tovertimeHours,\n\t\t\t\t\ttotalHours,\n\t\t\t\t};\n\t\t\t});\n\n\t\tsetReportData(employeeHours);\n\t};\n\n\tconst formatHours = (hours: number) => {\n\t\treturn `${hours.toFixed(2)} hrs`;\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-4\">\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<CardTitle>{t.weeklyReport}</CardTitle>\n\t\t\t\t\t<CardDescription>Overtime calculated for hours worked beyond 40 hours/week</CardDescription>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t<div className=\"max-w-xs\">\n\t\t\t\t\t\t<Label>{t.selectWeek}</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\tvalue={weekStart}\n\t\t\t\t\t\t\tonChange={(e) => setWeekStart(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{reportData.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noReportData}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.employeeName}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.regularHours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.overtimeHours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.totalHours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{reportData.map(({ user, regularHours, overtimeHours, totalHours }) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={user.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">{user.name}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{formatHours(regularHours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{overtimeHours > 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-orange-600 font-semibold\">{formatHours(overtimeHours)}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\tformatHours(0)\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-semibold\">{formatHours(totalHours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{overtimeHours > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertCircle className=\"w-3 h-3 mr-1\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{t.overtimeAlert}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\t\t</div>\n\t);\n}\n\nfunction EmployeesTab({ users, language, onUsersChange }: { users: UserModel[]; language: Language; onUsersChange: () => void }) {\n\tconst [showAddEmployee, setShowAddEmployee] = useState(false);\n\tconst [editingEmployee, setEditingEmployee] = useState<UserModel | null>(null);\n\tconst [employeeName, setEmployeeName] = useState(\"\");\n\tconst [employeeEmail, setEmployeeEmail] = useState(\"\");\n\tconst [employeeRole, setEmployeeRole] = useState<UserRole>(UserRole.Employee);\n\tconst [deleteConfirm, setDeleteConfirm] = useState<UserModel | null>(null);\n\n\tconst t = translations[language];\n\n\tconst handleAddEmployee = async () => {\n\t\tconst userORM = UserORM.getInstance();\n\t\tawait userORM.insertUser([{\n\t\t\tname: employeeName,\n\t\t\temail: employeeEmail,\n\t\t\trole: employeeRole,\n\t\t} as UserModel]);\n\n\t\tsetShowAddEmployee(false);\n\t\tsetEmployeeName(\"\");\n\t\tsetEmployeeEmail(\"\");\n\t\tsetEmployeeRole(UserRole.Employee);\n\t\tonUsersChange();\n\t};\n\n\tconst handleEditEmployee = async () => {\n\t\tif (!editingEmployee) return;\n\n\t\tconst userORM = UserORM.getInstance();\n\t\tawait userORM.setUserById(editingEmployee.id, {\n\t\t\t...editingEmployee,\n\t\t\tname: employeeName,\n\t\t\temail: employeeEmail,\n\t\t\trole: employeeRole,\n\t\t});\n\n\t\tsetEditingEmployee(null);\n\t\tsetEmployeeName(\"\");\n\t\tsetEmployeeEmail(\"\");\n\t\tsetEmployeeRole(UserRole.Employee);\n\t\tonUsersChange();\n\t};\n\n\tconst handleDeleteEmployee = async (user: UserModel) => {\n\t\tconst userORM = UserORM.getInstance();\n\t\tawait userORM.deleteUserById(user.id);\n\t\tsetDeleteConfirm(null);\n\t\tonUsersChange();\n\t};\n\n\tconst openEditDialog = (user: UserModel) => {\n\t\tsetEditingEmployee(user);\n\t\tsetEmployeeName(user.name);\n\t\tsetEmployeeEmail(user.email);\n\t\tsetEmployeeRole(user.role);\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-4\">\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<CardTitle>{t.employees}</CardTitle>\n\t\t\t\t\t\t\t<CardDescription>Manage employee accounts</CardDescription>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button onClick={() => setShowAddEmployee(true)}>\n\t\t\t\t\t\t\t<UserPlus className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{t.addEmployee}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent>\n\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.name}</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.email}</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.role}</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.actions}</TableHead>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t{users.map((user) => (\n\t\t\t\t\t\t\t\t\t<TableRow key={user.id}>\n\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">{user.name}</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell>{user.email}</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<Badge variant={user.role === UserRole.Manager ? \"default\" : \"secondary\"}>\n\t\t\t\t\t\t\t\t\t\t\t\t{user.role === UserRole.Manager ? t.manager : t.employee}\n\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openEditDialog(user)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t.edit}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setDeleteConfirm(user)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t.delete}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t</Table>\n\t\t\t\t\t</div>\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Dialog open={showAddEmployee} onOpenChange={setShowAddEmployee}>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.addEmployee}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.name}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={employeeName}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeName(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder=\"John Doe\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.email}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\t\tvalue={employeeEmail}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeEmail(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder=\"john@example.com\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.role}</Label>\n\t\t\t\t\t\t\t<Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setShowAddEmployee(false)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleAddEmployee} disabled={!employeeName || !employeeEmail}>\n\t\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\n\t\t\t<Dialog open={!!editingEmployee} onOpenChange={(open) => !open && setEditingEmployee(null)}>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.editEmployee}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.name}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={employeeName}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeName(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.email}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\t\tvalue={employeeEmail}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeEmail(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.role}</Label>\n\t\t\t\t\t\t\t<Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setEditingEmployee(null)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleEditEmployee}>\n\t\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\n\t\t\t<Dialog open={!!deleteConfirm} onOpenChange={(open) => !open && setDeleteConfirm(null)}>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.deleteEmployee}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<p>{t.confirmDelete}</p>\n\t\t\t\t\t<p className=\"font-semibold\">{deleteConfirm?.name}</p>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setDeleteConfirm(null)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button variant=\"destructive\" onClick={() => deleteConfirm && handleDeleteEmployee(deleteConfirm)}>\n\t\t\t\t\t\t\t{t.delete}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\t\t</div>\n\t);\n}\n\nfunction ManualEntryDialog({\n\topen,\n\tonClose,\n\tuserId,\n\tonSave,\n\tlanguage,\n\tusers\n}: {\n\topen: boolean;\n\tonClose: () => void;\n\tuserId: string;\n\tonSave: () => void;\n\tlanguage: Language;\n\tusers?: UserModel[];\n}) {\n\tconst [selectedUser, setSelectedUser] = useState(userId);\n\tconst [clockIn, setClockIn] = useState(\"\");\n\tconst [clockOut, setClockOut] = useState(\"\");\n\tconst [location, setLocation] = useState(\"\");\n\tconst [workDescription, setWorkDescription] = useState(\"\");\n\tconst [lunchStart, setLunchStart] = useState(\"\");\n\tconst [lunchEnd, setLunchEnd] = useState(\"\");\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tif (open) {\n\t\t\tsetSelectedUser(userId);\n\t\t\t// Set default to today\n\t\t\tconst now = new Date();\n\t\t\tconst today = now.toISOString().slice(0, 10);\n\t\t\tsetClockIn(`${today}T09:00`);\n\t\t\tsetClockOut(`${today}T17:00`);\n\t\t\tsetLocation(\"\");\n\t\t\tsetWorkDescription(\"\");\n\t\t\tsetLunchStart(`${today}T12:00`);\n\t\t\tsetLunchEnd(`${today}T13:00`);\n\t\t}\n\t}, [open, userId]);\n\n\tconst handleSave = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\n\t\tconst clockInTimestamp = Math.floor(new Date(clockIn).getTime() / 1000).toString();\n\t\tconst clockOutTimestamp = clockOut ? Math.floor(new Date(clockOut).getTime() / 1000).toString() : null;\n\t\tconst lunchStartTimestamp = lunchStart ? Math.floor(new Date(lunchStart).getTime() / 1000).toString() : null;\n\t\tconst lunchEndTimestamp = lunchEnd ? Math.floor(new Date(lunchEnd).getTime() / 1000).toString() : null;\n\n\t\tlet totalHours = null;\n\t\tlet lunchDurationMinutes = null;\n\n\t\t// Calculate lunch duration\n\t\tif (lunchStartTimestamp && lunchEndTimestamp) {\n\t\t\tconst lunchStartTime = parseInt(lunchStartTimestamp);\n\t\t\tconst lunchEndTime = parseInt(lunchEndTimestamp);\n\t\t\tlunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;\n\t\t}\n\n\t\t// Calculate total hours\n\t\tif (clockOutTimestamp) {\n\t\t\tconst clockInTime = parseInt(clockInTimestamp);\n\t\t\tconst clockOutTime = parseInt(clockOutTimestamp);\n\t\t\ttotalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t\t// Deduct lunch time\n\t\t\tif (lunchDurationMinutes) {\n\t\t\t\ttotalHours -= lunchDurationMinutes / 60;\n\t\t\t}\n\t\t}\n\n\t\tawait timeCardORM.insertTimeCardEntry([{\n\t\t\tuser_id: selectedUser,\n\t\t\tclock_in_timestamp: clockInTimestamp,\n\t\t\tclock_out_timestamp: clockOutTimestamp,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: location || null,\n\t\t\twork_description: workDescription || null,\n\t\t\tlunch_start_timestamp: lunchStartTimestamp,\n\t\t\tlunch_end_timestamp: lunchEndTimestamp,\n\t\t\tlunch_duration_minutes: lunchDurationMinutes,\n\t\t} as TimeCardEntryModel]);\n\n\t\tonSave();\n\t\tonClose();\n\t};\n\n\treturn (\n\t\t<Dialog open={open} onOpenChange={onClose}>\n\t\t\t<DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n\t\t\t\t<DialogHeader>\n\t\t\t\t\t<DialogTitle>{t.addManualEntry}</DialogTitle>\n\t\t\t\t</DialogHeader>\n\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t{users && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.employeeName}</Label>\n\t\t\t\t\t\t\t<Select value={selectedUser} onValueChange={setSelectedUser}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t{users.filter(u => u.role === UserRole.Employee).map((u) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={u.id} value={u.id}>\n\t\t\t\t\t\t\t\t\t\t\t{u.name}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.clockInTime}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={clockIn}\n\t\t\t\t\t\t\t\tonChange={(e) => setClockIn(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.clockOutTime}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={clockOut}\n\t\t\t\t\t\t\t\tonChange={(e) => setClockOut(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\trows={4}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.lunchStartTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={lunchStart}\n\t\t\t\t\t\t\t\tonChange={(e) => setLunchStart(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.lunchEndTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={lunchEnd}\n\t\t\t\t\t\t\t\tonChange={(e) => setLunchEnd(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<DialogFooter>\n\t\t\t\t\t<Button variant=\"outline\" onClick={onClose}>\n\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button onClick={handleSave} disabled={!selectedUser || !clockIn}>\n\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t</Button>\n\t\t\t\t</DialogFooter>\n\t\t\t</DialogContent>\n\t\t</Dialog>\n\t);\n}\n"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":310,"cache_read_input_tokens":131165,"cache_creation":{"ephemeral_5m_input_tokens":310,"ephemeral_1h_input_tokens":0},"output_tokens":16855},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"aa7ffcb7-1cab-45b5-a248-8ca13f733433"}
{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_vrtx_01Ab3sh8WFLhwHG5tz3WEYp1","type":"tool_result","content":"The file /home/user/vite-template/src/routes/index.tsx has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n     1→import { createFileRoute } from \"@tanstack/react-router\";\n     2→import { useState, useEffect } from \"react\";\n     3→import { Button } from \"@/components/ui/button\";\n     4→import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\n     5→import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n     6→import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\n     7→import { Input } from \"@/components/ui/input\";\n     8→import { Label } from \"@/components/ui/label\";\n     9→import { Textarea } from \"@/components/ui/textarea\";\n    10→import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\n    11→import { Badge } from \"@/components/ui/badge\";\n    12→import { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n    13→import { Clock, Users, CalendarDays, Timer, Languages, Coffee, UserPlus, FileText, AlertCircle, Plus } from \"lucide-react\";\n    14→import { UserORM, type UserModel, UserRole } from \"@/sdk/database/orm/orm_user\";\n    15→import { TimeCardEntryORM, type TimeCardEntryModel } from \"@/sdk/database/orm/orm_time_card_entry\";\n    16→\n    17→export const Route = createFileRoute(\"/\")({\n    18→\tcomponent: App,\n    19→});\n    20→\n    21→type Language = 'en' | 'es';\n    22→\n    23→const translations = {\n    24→\ten: {\n    25→\t\tappTitle: \"Employee Time Tracking\",\n    26→\t\tselectAccount: \"Select your account to continue\",\n    27→\t\tselectUser: \"Select User\",\n    28→\t\tchooseAccount: \"Choose your account\",\n    29→\t\tmanager: \"Manager\",\n    30→\t\temployee: \"Employee\",\n    31→\t\tswitchUser: \"Switch User\",\n    32→\t\ttimeTrackingSystem: \"Time Tracking System\",\n    33→\t\twelcome: \"Welcome\",\n    34→\t\tclockInOut: \"Clock In/Out\",\n    35→\t\tcurrentlyClocked: \"Currently Clocked In\",\n    36→\t\tsince: \"Since\",\n    37→\t\telapsedTime: \"Elapsed Time\",\n    38→\t\tclockOut: \"Clock Out\",\n    39→\t\tnotClocked: \"Not currently clocked in\",\n    40→\t\tclockIn: \"Clock In\",\n    41→\t\ttimeCardHistory: \"Time Card History\",\n    42→\t\trecentRecords: \"Your recent clock in/out records\",\n    43→\t\tnoTimeCards: \"No time cards yet\",\n    44→\t\tclockInTime: \"Clock In\",\n    45→\t\tclockOutTime: \"Clock Out\",\n    46→\t\thours: \"Hours\",\n    47→\t\tstatus: \"Status\",\n    48→\t\tcompleted: \"Completed\",\n    49→\t\tactive: \"Active\",\n    50→\t\ttotalEmployees: \"Total Employees\",\n    51→\t\thoursToday: \"Hours Today\",\n    52→\t\thoursThisWeek: \"Hours This Week\",\n    53→\t\tallEmployeeTimeCards: \"All Employee Time Cards\",\n    54→\t\tviewManageRecords: \"View and manage all employee time records\",\n    55→\t\tfilterByEmployee: \"Filter by Employee\",\n    56→\t\tallEmployees: \"All Employees\",\n    57→\t\tfilterByDate: \"Filter by Date\",\n    58→\t\tclearFilters: \"Clear Filters\",\n    59→\t\tnoTimeCardsFound: \"No time cards found\",\n    60→\t\temployeeName: \"Employee\",\n    61→\t\tactions: \"Actions\",\n    62→\t\tedit: \"Edit\",\n    63→\t\teditTimeCard: \"Edit Time Card\",\n    64→\t\tcancel: \"Cancel\",\n    65→\t\tsaveChanges: \"Save Changes\",\n    66→\t\tlocation: \"Location\",\n    67→\t\twhereWorked: \"Where did you work?\",\n    68→\t\tworkDescription: \"Work Description\",\n    69→\t\twhatDid: \"What did you do today?\",\n    70→\t\tlocationPlaceholder: \"e.g., Office, Remote, Client Site\",\n    71→\t\tdescriptionPlaceholder: \"Describe your work activities...\",\n    72→\t\tstartLunch: \"Start Lunch Break\",\n    73→\t\tendLunch: \"End Lunch Break\",\n    74→\t\tonLunchBreak: \"On Lunch Break\",\n    75→\t\tlunchBreak: \"Lunch Break\",\n    76→\t\tlunchDuration: \"Lunch\",\n    77→\t\tlunchStartTime: \"Lunch Start\",\n    78→\t\tlunchEndTime: \"Lunch End\",\n    79→\t\ttimeCards: \"Time Cards\",\n    80→\t\treports: \"Reports\",\n    81→\t\temployees: \"Employees\",\n    82→\t\taddEmployee: \"Add Employee\",\n    83→\t\teditEmployee: \"Edit Employee\",\n    84→\t\tdeleteEmployee: \"Delete Employee\",\n    85→\t\tname: \"Name\",\n    86→\t\temail: \"Email\",\n    87→\t\trole: \"Role\",\n    88→\t\tdelete: \"Delete\",\n    89→\t\tweeklyReport: \"Weekly Report\",\n    90→\t\tselectWeek: \"Select Week\",\n    91→\t\tregularHours: \"Regular\",\n    92→\t\tovertimeHours: \"Overtime\",\n    93→\t\ttotalHours: \"Total\",\n    94→\t\tnoReportData: \"No data for selected week\",\n    95→\t\taddTimeCard: \"Add Time Card\",\n    96→\t\tmanualEntry: \"Manual Entry\",\n    97→\t\taddManualEntry: \"Add Manual Time Card\",\n    98→\t\tconfirmDelete: \"Are you sure you want to delete this employee?\",\n    99→\t\tovertimeAlert: \"Overtime Alert\",\n   100→\t},\n   101→\tes: {\n   102→\t\tappTitle: \"Registro de Tiempo de Empleados\",\n   103→\t\tselectAccount: \"Selecciona tu cuenta para continuar\",\n   104→\t\tselectUser: \"Seleccionar Usuario\",\n   105→\t\tchooseAccount: \"Elige tu cuenta\",\n   106→\t\tmanager: \"Gerente\",\n   107→\t\temployee: \"Empleado\",\n   108→\t\tswitchUser: \"Cambiar Usuario\",\n   109→\t\ttimeTrackingSystem: \"Sistema de Registro de Tiempo\",\n   110→\t\twelcome: \"Bienvenido\",\n   111→\t\tclockInOut: \"Entrada/Salida\",\n   112→\t\tcurrentlyClocked: \"Actualmente Registrado\",\n   113→\t\tsince: \"Desde\",\n   114→\t\telapsedTime: \"Tiempo Transcurrido\",\n   115→\t\tclockOut: \"Registrar Salida\",\n   116→\t\tnotClocked: \"No está registrado actualmente\",\n   117→\t\tclockIn: \"Registrar Entrada\",\n   118→\t\ttimeCardHistory: \"Historial de Tarjetas de Tiempo\",\n   119→\t\trecentRecords: \"Tus registros recientes de entrada/salida\",\n   120→\t\tnoTimeCards: \"No hay tarjetas de tiempo todavía\",\n   121→\t\tclockInTime: \"Entrada\",\n   122→\t\tclockOutTime: \"Salida\",\n   123→\t\thours: \"Horas\",\n   124→\t\tstatus: \"Estado\",\n   125→\t\tcompleted: \"Completado\",\n   126→\t\tactive: \"Activo\",\n   127→\t\ttotalEmployees: \"Total de Empleados\",\n   128→\t\thoursToday: \"Horas Hoy\",\n   129→\t\thoursThisWeek: \"Horas Esta Semana\",\n   130→\t\tallEmployeeTimeCards: \"Todas las Tarjetas de Tiempo\",\n   131→\t\tviewManageRecords: \"Ver y gestionar todos los registros de empleados\",\n   132→\t\tfilterByEmployee: \"Filtrar por Empleado\",\n   133→\t\tallEmployees: \"Todos los Empleados\",\n   134→\t\tfilterByDate: \"Filtrar por Fecha\",\n   135→\t\tclearFilters: \"Limpiar Filtros\",\n   136→\t\tnoTimeCardsFound: \"No se encontraron tarjetas de tiempo\",\n   137→\t\temployeeName: \"Empleado\",\n   138→\t\tactions: \"Acciones\",\n   139→\t\tedit: \"Editar\",\n   140→\t\teditTimeCard: \"Editar Tarjeta de Tiempo\",\n   141→\t\tcancel: \"Cancelar\",\n   142→\t\tsaveChanges: \"Guardar Cambios\",\n   143→\t\tlocation: \"Ubicación\",\n   144→\t\twhereWorked: \"¿Dónde trabajaste?\",\n   145→\t\tworkDescription: \"Descripción del Trabajo\",\n   146→\t\twhatDid: \"¿Qué hiciste hoy?\",\n   147→\t\tlocationPlaceholder: \"ej., Oficina, Remoto, Sitio del Cliente\",\n   148→\t\tdescriptionPlaceholder: \"Describe tus actividades laborales...\",\n   149→\t\tstartLunch: \"Iniciar Almuerzo\",\n   150→\t\tendLunch: \"Terminar Almuerzo\",\n   151→\t\tonLunchBreak: \"En Almuerzo\",\n   152→\t\tlunchBreak: \"Almuerzo\",\n   153→\t\tlunchDuration: \"Almuerzo\",\n   154→\t\tlunchStartTime: \"Inicio Almuerzo\",\n   155→\t\tlunchEndTime: \"Fin Almuerzo\",\n   156→\t\ttimeCards: \"Tarjetas de Tiempo\",\n   157→\t\treports: \"Informes\",\n   158→\t\temployees: \"Empleados\",\n   159→\t\taddEmployee: \"Agregar Empleado\",\n   160→\t\teditEmployee: \"Editar Empleado\",\n   161→\t\tdeleteEmployee: \"Eliminar Empleado\",\n   162→\t\tname: \"Nombre\",\n   163→\t\temail: \"Correo\",\n   164→\t\trole: \"Rol\",\n   165→\t\tdelete: \"Eliminar\",\n   166→\t\tweeklyReport: \"Informe Semanal\",\n   167→\t\tselectWeek: \"Seleccionar Semana\",\n   168→\t\tregularHours: \"Regular\",\n   169→\t\tovertimeHours: \"Tiempo Extra\",\n   170→\t\ttotalHours: \"Total\",\n   171→\t\tnoReportData: \"No hay datos para la semana seleccionada\",\n   172→\t\taddTimeCard: \"Agregar Tarjeta\",\n   173→\t\tmanualEntry: \"Entrada Manual\",\n   174→\t\taddManualEntry: \"Agregar Tarjeta Manual\",\n   175→\t\tconfirmDelete: \"¿Está seguro de eliminar este empleado?\",\n   176→\t\tovertimeAlert: \"Alerta de Tiempo Extra\",\n   177→\t}\n   178→};\n   179→\n   180→function App() {\n   181→\tconst [currentUser, setCurrentUser] = useState<UserModel | null>(null);\n   182→\tconst [users, setUsers] = useState<UserModel[]>([]);\n   183→\tconst [showUserSelect, setShowUserSelect] = useState(true);\n   184→\tconst [language, setLanguage] = useState<Language>('en');\n   185→\n   186→\tconst t = translations[language];\n   187→\n   188→\tuseEffect(() => {\n   189→\t\tloadUsers();\n   190→\t}, []);\n   191→\n   192→\tconst loadUsers = async () => {\n   193→\t\tconst userORM = UserORM.getInstance();\n   194→\t\tconst allUsers = await userORM.getAllUser();\n   195→\n   196→\t\t// If no users exist, create demo users\n   197→\t\tif (allUsers.length === 0) {\n   198→\t\t\tconst demoUsers = await userORM.insertUser([\n   199→\t\t\t\t{\n   200→\t\t\t\t\tname: \"John Smith\",\n   201→\t\t\t\t\temail: \"john@example.com\",\n   202→\t\t\t\t\trole: UserRole.Employee,\n   203→\t\t\t\t} as UserModel,\n   204→\t\t\t\t{\n   205→\t\t\t\t\tname: \"Sarah Johnson\",\n   206→\t\t\t\t\temail: \"sarah@example.com\",\n   207→\t\t\t\t\trole: UserRole.Employee,\n   208→\t\t\t\t} as UserModel,\n   209→\t\t\t\t{\n   210→\t\t\t\t\tname: \"Mike Manager\",\n   211→\t\t\t\t\temail: \"mike@example.com\",\n   212→\t\t\t\t\trole: UserRole.Manager,\n   213→\t\t\t\t} as UserModel,\n   214→\t\t\t]);\n   215→\t\t\tsetUsers(demoUsers);\n   216→\t\t} else {\n   217→\t\t\tsetUsers(allUsers);\n   218→\t\t}\n   219→\t};\n   220→\n   221→\tconst handleUserSelect = (userId: string) => {\n   222→\t\tconst user = users.find(u => u.id === userId);\n   223→\t\tif (user) {\n   224→\t\t\tsetCurrentUser(user);\n   225→\t\t\tsetShowUserSelect(false);\n   226→\t\t}\n   227→\t};\n   228→\n   229→\tconst handleLogout = () => {\n   230→\t\tsetCurrentUser(null);\n   231→\t\tsetShowUserSelect(true);\n   232→\t};\n   233→\n   234→\tconst toggleLanguage = () => {\n   235→\t\tsetLanguage(prev => prev === 'en' ? 'es' : 'en');\n   236→\t};\n   237→\n   238→\tif (showUserSelect || !currentUser) {\n   239→\t\treturn (\n   240→\t\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4\">\n   241→\t\t\t\t<div className=\"absolute top-4 right-4\">\n   242→\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n   243→\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n   244→\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n   245→\t\t\t\t\t</Button>\n   246→\t\t\t\t</div>\n   247→\t\t\t\t<Card className=\"w-full max-w-md\">\n   248→\t\t\t\t\t<CardHeader>\n   249→\t\t\t\t\t\t<CardTitle className=\"text-2xl\">{t.appTitle}</CardTitle>\n   250→\t\t\t\t\t\t<CardDescription>{t.selectAccount}</CardDescription>\n   251→\t\t\t\t\t</CardHeader>\n   252→\t\t\t\t\t<CardContent className=\"space-y-4\">\n   253→\t\t\t\t\t\t<div className=\"space-y-2\">\n   254→\t\t\t\t\t\t\t<Label>{t.selectUser}</Label>\n   255→\t\t\t\t\t\t\t<Select onValueChange={handleUserSelect}>\n   256→\t\t\t\t\t\t\t\t<SelectTrigger className=\"w-full\">\n   257→\t\t\t\t\t\t\t\t\t<SelectValue placeholder={t.chooseAccount} />\n   258→\t\t\t\t\t\t\t\t</SelectTrigger>\n   259→\t\t\t\t\t\t\t\t<SelectContent>\n   260→\t\t\t\t\t\t\t\t\t{users.map((user) => (\n   261→\t\t\t\t\t\t\t\t\t\t<SelectItem key={user.id} value={user.id}>\n   262→\t\t\t\t\t\t\t\t\t\t\t{user.name} - {user.role === UserRole.Manager ? t.manager : t.employee}\n   263→\t\t\t\t\t\t\t\t\t\t</SelectItem>\n   264→\t\t\t\t\t\t\t\t\t))}\n   265→\t\t\t\t\t\t\t\t</SelectContent>\n   266→\t\t\t\t\t\t\t</Select>\n   267→\t\t\t\t\t\t</div>\n   268→\t\t\t\t\t</CardContent>\n   269→\t\t\t\t</Card>\n   270→\t\t\t</div>\n   271→\t\t);\n   272→\t}\n   273→\n   274→\treturn (\n   275→\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800\">\n   276→\t\t\t<div className=\"container mx-auto p-6 space-y-6\">\n   277→\t\t\t\t<div className=\"flex justify-between items-center\">\n   278→\t\t\t\t\t<div>\n   279→\t\t\t\t\t\t<h1 className=\"text-3xl font-bold\">{t.timeTrackingSystem}</h1>\n   280→\t\t\t\t\t\t<p className=\"text-muted-foreground\">\n   281→\t\t\t\t\t\t\t{t.welcome}, {currentUser.name} ({currentUser.role === UserRole.Manager ? t.manager : t.employee})\n   282→\t\t\t\t\t\t</p>\n   283→\t\t\t\t\t</div>\n   284→\t\t\t\t\t<div className=\"flex gap-2\">\n   285→\t\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n   286→\t\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n   287→\t\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n   288→\t\t\t\t\t\t</Button>\n   289→\t\t\t\t\t\t<Button onClick={handleLogout} variant=\"outline\">\n   290→\t\t\t\t\t\t\t{t.switchUser}\n   291→\t\t\t\t\t\t</Button>\n   292→\t\t\t\t\t</div>\n   293→\t\t\t\t</div>\n   294→\n   295→\t\t\t\t{currentUser.role === UserRole.Employee ? (\n   296→\t\t\t\t\t<EmployeeView user={currentUser} language={language} />\n   297→\t\t\t\t) : (\n   298→\t\t\t\t\t<ManagerView user={currentUser} users={users} language={language} onUsersChange={loadUsers} />\n   299→\t\t\t\t)}\n   300→\t\t\t</div>\n   301→\t\t</div>\n   302→\t);\n   303→}\n   304→\n   305→function EmployeeView({ user, language }: { user: UserModel; language: Language }) {\n   306→\tconst [activeShift, setActiveShift] = useState<TimeCardEntryModel | null>(null);\n   307→\tconst [timeCards, setTimeCards] = useState<TimeCardEntryModel[]>([]);\n   308→\tconst [elapsedTime, setElapsedTime] = useState(0);\n   309→\tconst [location, setLocation] = useState(\"\");\n   310→\tconst [workDescription, setWorkDescription] = useState(\"\");\n   311→\tconst [isOnLunch, setIsOnLunch] = useState(false);\n   312→\tconst [showManualEntry, setShowManualEntry] = useState(false);\n   313→\n   314→\tconst t = translations[language];\n   315→\n   316→\tuseEffect(() => {\n   317→\t\tloadTimeCards();\n   318→\t}, [user.id]);\n   319→\n   320→\tuseEffect(() => {\n   321→\t\tlet interval: NodeJS.Timeout;\n   322→\t\tif (activeShift && !isOnLunch) {\n   323→\t\t\tinterval = setInterval(() => {\n   324→\t\t\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp) * 1000;\n   325→\t\t\t\tconst elapsed = Date.now() - clockInTime;\n   326→\t\t\t\tsetElapsedTime(elapsed);\n   327→\t\t\t}, 1000);\n   328→\t\t}\n   329→\t\treturn () => clearInterval(interval);\n   330→\t}, [activeShift, isOnLunch]);\n   331→\n   332→\tconst loadTimeCards = async () => {\n   333→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n   334→\t\tconst userTimeCards = await timeCardORM.getTimeCardEntryByUserId(user.id);\n   335→\n   336→\t\t// Sort by clock in time (newest first)\n   337→\t\tconst sorted = userTimeCards.sort((a, b) =>\n   338→\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n   339→\t\t);\n   340→\n   341→\t\tsetTimeCards(sorted);\n   342→\n   343→\t\t// Find active shift (no clock out time)\n   344→\t\tconst active = sorted.find(tc => !tc.clock_out_timestamp);\n   345→\t\tsetActiveShift(active || null);\n   346→\t\tif (active) {\n   347→\t\t\tsetLocation(active.location || \"\");\n   348→\t\t\tsetWorkDescription(active.work_description || \"\");\n   349→\t\t\t// Check if on lunch break\n   350→\t\t\tsetIsOnLunch(!!(active.lunch_start_timestamp && !active.lunch_end_timestamp));\n   351→\t\t} else {\n   352→\t\t\tsetIsOnLunch(false);\n   353→\t\t}\n   354→\t};\n   355→\n   356→\tconst handleClockIn = async () => {\n   357→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n   358→\t\tconst now = Math.floor(Date.now() / 1000).toString();\n   359→\n   360→\t\tawait timeCardORM.insertTimeCardEntry([{\n   361→\t\t\tuser_id: user.id,\n   362→\t\t\tclock_in_timestamp: now,\n   363→\t\t\tlocation: location || null,\n   364→\t\t\twork_description: workDescription || null,\n   365→\t\t} as TimeCardEntryModel]);\n   366→\n   367→\t\tsetLocation(\"\");\n   368→\t\tsetWorkDescription(\"\");\n   369→\t\tawait loadTimeCards();\n   370→\t};\n   371→\n   372→\tconst handleClockOut = async () => {\n   373→\t\tif (!activeShift) return;\n   374→\n   375→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n   376→\t\tconst now = Math.floor(Date.now() / 1000).toString();\n   377→\n   378→\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp);\n   379→\t\tconst clockOutTime = parseInt(now);\n   380→\t\tlet totalHours = (clockOutTime - clockInTime) / 3600;\n   381→\n   382→\t\t// Deduct lunch time if lunch was taken\n   383→\t\tif (activeShift.lunch_duration_minutes) {\n   384→\t\t\ttotalHours -= activeShift.lunch_duration_minutes / 60;\n   385→\t\t}\n   386→\n   387→\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n   388→\t\t\t...activeShift,\n   389→\t\t\tclock_out_timestamp: now,\n   390→\t\t\ttotal_hours: totalHours,\n   391→\t\t\tlocation: location || activeShift.location,\n   392→\t\t\twork_description: workDescription || activeShift.work_description,\n   393→\t\t});\n   394→\n   395→\t\tsetLocation(\"\");\n   396→\t\tsetWorkDescription(\"\");\n   397→\t\tawait loadTimeCards();\n   398→\t};\n   399→\n   400→\tconst handleStartLunch = async () => {\n   401→\t\tif (!activeShift) return;\n   402→\n   403→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n   404→\t\tconst now = Math.floor(Date.now() / 1000).toString();\n   405→\n   406→\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n   407→\t\t\t...activeShift,\n   408→\t\t\tlunch_start_timestamp: now,\n   409→\t\t\tlocation: location || activeShift.location,\n   410→\t\t\twork_description: workDescription || activeShift.work_description,\n   411→\t\t});\n   412→\n   413→\t\tawait loadTimeCards();\n   414→\t};\n   415→\n   416→\tconst handleEndLunch = async () => {\n   417→\t\tif (!activeShift || !activeShift.lunch_start_timestamp) return;\n   418→\n   419→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n   420→\t\tconst now = Math.floor(Date.now() / 1000).toString();\n   421→\n   422→\t\tconst lunchStartTime = parseInt(activeShift.lunch_start_timestamp);\n   423→\t\tconst lunchEndTime = parseInt(now);\n   424→\t\tconst lunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;\n   425→\n   426→\t\t// Add to existing lunch duration if there was already one\n   427→\t\tconst totalLunchMinutes = (activeShift.lunch_duration_minutes || 0) + lunchDurationMinutes;\n   428→\n   429→\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n   430→\t\t\t...activeShift,\n   431→\t\t\tlunch_end_timestamp: now,\n   432→\t\t\tlunch_duration_minutes: totalLunchMinutes,\n   433→\t\t});\n   434→\n   435→\t\tawait loadTimeCards();\n   436→\t};\n   437→\n   438→\tconst formatTime = (ms: number) => {\n   439→\t\tconst seconds = Math.floor(ms / 1000);\n   440→\t\tconst hours = Math.floor(seconds / 3600);\n   441→\t\tconst minutes = Math.floor((seconds % 3600) / 60);\n   442→\t\tconst secs = seconds % 60;\n   443→\t\treturn `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n   444→\t};\n   445→\n   446→\tconst formatDate = (timestamp: string) => {\n   447→\t\tconst date = new Date(parseInt(timestamp) * 1000);\n   448→\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n   449→\t};\n   450→\n   451→\tconst formatHours = (hours: number | null | undefined) => {\n   452→\t\tif (hours === null || hours === undefined) return \"—\";\n   453→\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n   454→\t};\n   455→\n   456→\tconst formatMinutes = (minutes: number | null | undefined) => {\n   457→\t\tif (minutes === null || minutes === undefined) return \"—\";\n   458→\t\treturn `${Math.round(minutes)} min`;\n   459→\t};\n   460→\n   461→\treturn (\n   462→\t\t<div className=\"space-y-6\">\n   463→\t\t\t<Card>\n   464→\t\t\t\t<CardHeader>\n   465→\t\t\t\t\t<div className=\"flex justify-between items-center\">\n   466→\t\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n   467→\t\t\t\t\t\t\t<Clock className=\"w-5 h-5\" />\n   468→\t\t\t\t\t\t\t{t.clockInOut}\n   469→\t\t\t\t\t\t</CardTitle>\n   470→\t\t\t\t\t\t<Button onClick={() => setShowManualEntry(true)} variant=\"outline\" size=\"sm\">\n   471→\t\t\t\t\t\t\t<Plus className=\"w-4 h-4 mr-2\" />\n   472→\t\t\t\t\t\t\t{t.addTimeCard}\n   473→\t\t\t\t\t\t</Button>\n   474→\t\t\t\t\t</div>\n   475→\t\t\t\t</CardHeader>\n   476→\t\t\t\t<CardContent className=\"space-y-4\">\n   477→\t\t\t\t\t{activeShift ? (\n   478→\t\t\t\t\t\t<div className=\"space-y-4\">\n   479→\t\t\t\t\t\t\t{isOnLunch ? (\n   480→\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800\">\n   481→\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n   482→\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\n   483→\t\t\t\t\t\t\t\t\t\t<div>\n   484→\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-orange-800 dark:text-orange-200\">{t.onLunchBreak}</p>\n   485→\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-orange-600 dark:text-orange-300\">\n   486→\t\t\t\t\t\t\t\t\t\t\t\t{t.since} {activeShift.lunch_start_timestamp && formatDate(activeShift.lunch_start_timestamp)}\n   487→\t\t\t\t\t\t\t\t\t\t\t</p>\n   488→\t\t\t\t\t\t\t\t\t\t</div>\n   489→\t\t\t\t\t\t\t\t\t</div>\n   490→\t\t\t\t\t\t\t\t</div>\n   491→\t\t\t\t\t\t\t) : (\n   492→\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n   493→\t\t\t\t\t\t\t\t\t<div>\n   494→\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-green-800 dark:text-green-200\">{t.currentlyClocked}</p>\n   495→\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300\">\n   496→\t\t\t\t\t\t\t\t\t\t\t{t.since} {formatDate(activeShift.clock_in_timestamp)}\n   497→\t\t\t\t\t\t\t\t\t\t</p>\n   498→\t\t\t\t\t\t\t\t\t\t{activeShift.location && (\n   499→\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n   500→\t\t\t\t\t\t\t\t\t\t\t\t{t.location}: {activeShift.location}\n   501→\t\t\t\t\t\t\t\t\t\t\t</p>\n   502→\t\t\t\t\t\t\t\t\t\t)}\n   503→\t\t\t\t\t\t\t\t\t\t{activeShift.lunch_duration_minutes && activeShift.lunch_duration_minutes > 0 && (\n   504→\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n   505→\t\t\t\t\t\t\t\t\t\t\t\t{t.lunchBreak}: {formatMinutes(activeShift.lunch_duration_minutes)}\n   506→\t\t\t\t\t\t\t\t\t\t\t</p>\n   507→\t\t\t\t\t\t\t\t\t\t)}\n   508→\t\t\t\t\t\t\t\t\t</div>\n   509→\t\t\t\t\t\t\t\t\t<div className=\"text-right\">\n   510→\t\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-mono font-bold text-green-800 dark:text-green-200\">\n   511→\t\t\t\t\t\t\t\t\t\t\t{formatTime(elapsedTime)}\n   512→\t\t\t\t\t\t\t\t\t\t</p>\n   513→\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-green-600 dark:text-green-300\">{t.elapsedTime}</p>\n   514→\t\t\t\t\t\t\t\t\t</div>\n   515→\t\t\t\t\t\t\t\t</div>\n   516→\t\t\t\t\t\t\t)}\n   517→\n   518→\t\t\t\t\t\t\t{!isOnLunch && (\n   519→\t\t\t\t\t\t\t\t<>\n   520→\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n   521→\t\t\t\t\t\t\t\t\t\t<Label>{t.location}</Label>\n   522→\t\t\t\t\t\t\t\t\t\t<Input\n   523→\t\t\t\t\t\t\t\t\t\t\tvalue={location}\n   524→\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n   525→\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n   526→\t\t\t\t\t\t\t\t\t\t/>\n   527→\t\t\t\t\t\t\t\t\t</div>\n   528→\n   529→\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n   530→\t\t\t\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n   531→\t\t\t\t\t\t\t\t\t\t<Textarea\n   532→\t\t\t\t\t\t\t\t\t\t\tvalue={workDescription}\n   533→\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n   534→\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n   535→\t\t\t\t\t\t\t\t\t\t\trows={3}\n   536→\t\t\t\t\t\t\t\t\t\t/>\n   537→\t\t\t\t\t\t\t\t\t</div>\n   538→\t\t\t\t\t\t\t\t</>\n   539→\t\t\t\t\t\t\t)}\n   540→\n   541→\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-2\">\n   542→\t\t\t\t\t\t\t\t{isOnLunch ? (\n   543→\t\t\t\t\t\t\t\t\t<Button onClick={handleEndLunch} variant=\"default\" className=\"col-span-2\">\n   544→\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n   545→\t\t\t\t\t\t\t\t\t\t{t.endLunch}\n   546→\t\t\t\t\t\t\t\t\t</Button>\n   547→\t\t\t\t\t\t\t\t) : (\n   548→\t\t\t\t\t\t\t\t\t<>\n   549→\t\t\t\t\t\t\t\t\t\t<Button onClick={handleStartLunch} variant=\"outline\">\n   550→\t\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n   551→\t\t\t\t\t\t\t\t\t\t\t{t.startLunch}\n   552→\t\t\t\t\t\t\t\t\t\t</Button>\n   553→\t\t\t\t\t\t\t\t\t\t<Button onClick={handleClockOut} variant=\"destructive\">\n   554→\t\t\t\t\t\t\t\t\t\t\t{t.clockOut}\n   555→\t\t\t\t\t\t\t\t\t\t</Button>\n   556→\t\t\t\t\t\t\t\t\t</>\n   557→\t\t\t\t\t\t\t\t)}\n   558→\t\t\t\t\t\t\t</div>\n   559→\t\t\t\t\t\t</div>\n   560→\t\t\t\t\t) : (\n   561→\t\t\t\t\t\t<div className=\"space-y-4\">\n   562→\t\t\t\t\t\t\t<div className=\"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center\">\n   563→\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground\">{t.notClocked}</p>\n   564→\t\t\t\t\t\t\t</div>\n   565→\n   566→\t\t\t\t\t\t\t<div className=\"space-y-2\">\n   567→\t\t\t\t\t\t\t\t<Label>{t.whereWorked}</Label>\n   568→\t\t\t\t\t\t\t\t<Input\n   569→\t\t\t\t\t\t\t\t\tvalue={location}\n   570→\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n   571→\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n   572→\t\t\t\t\t\t\t\t/>\n   573→\t\t\t\t\t\t\t</div>\n   574→\n   575→\t\t\t\t\t\t\t<div className=\"space-y-2\">\n   576→\t\t\t\t\t\t\t\t<Label>{t.whatDid}</Label>\n   577→\t\t\t\t\t\t\t\t<Textarea\n   578→\t\t\t\t\t\t\t\t\tvalue={workDescription}\n   579→\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n   580→\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n   581→\t\t\t\t\t\t\t\t\trows={3}\n   582→\t\t\t\t\t\t\t\t/>\n   583→\t\t\t\t\t\t\t</div>\n   584→\n   585→\t\t\t\t\t\t\t<Button onClick={handleClockIn} className=\"w-full\">\n   586→\t\t\t\t\t\t\t\t{t.clockIn}\n   587→\t\t\t\t\t\t\t</Button>\n   588→\t\t\t\t\t\t</div>\n   589→\t\t\t\t\t)}\n   590→\t\t\t\t</CardContent>\n   591→\t\t\t</Card>\n   592→\n   593→\t\t\t<Card>\n   594→\t\t\t\t<CardHeader>\n   595→\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n   596→\t\t\t\t\t\t<CalendarDays className=\"w-5 h-5\" />\n   597→\t\t\t\t\t\t{t.timeCardHistory}\n   598→\t\t\t\t\t</CardTitle>\n   599→\t\t\t\t\t<CardDescription>{t.recentRecords}</CardDescription>\n   600→\t\t\t\t</CardHeader>\n   601→\t\t\t\t<CardContent>\n   602→\t\t\t\t\t{timeCards.length === 0 ? (\n   603→\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCards}</p>\n   604→\t\t\t\t\t) : (\n   605→\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n   606→\t\t\t\t\t\t\t<Table>\n   607→\t\t\t\t\t\t\t\t<TableHeader>\n   608→\t\t\t\t\t\t\t\t\t<TableRow>\n   609→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n   610→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n   611→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n   612→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n   613→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n   614→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n   615→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n   616→\t\t\t\t\t\t\t\t\t</TableRow>\n   617→\t\t\t\t\t\t\t\t</TableHeader>\n   618→\t\t\t\t\t\t\t\t<TableBody>\n   619→\t\t\t\t\t\t\t\t\t{timeCards.map((tc) => (\n   620→\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n   621→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n   622→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n   623→\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n   624→\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n   625→\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n   626→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n   627→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n   628→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n   629→\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n   630→\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n   631→\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n   632→\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n   633→\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n   634→\t\t\t\t\t\t\t\t\t\t\t\t) : (\n   635→\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n   636→\t\t\t\t\t\t\t\t\t\t\t\t)}\n   637→\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n   638→\t\t\t\t\t\t\t\t\t\t</TableRow>\n   639→\t\t\t\t\t\t\t\t\t))}\n   640→\t\t\t\t\t\t\t\t</TableBody>\n   641→\t\t\t\t\t\t\t</Table>\n   642→\t\t\t\t\t\t</div>\n   643→\t\t\t\t\t)}\n   644→\t\t\t\t</CardContent>\n   645→\t\t\t</Card>\n   646→\n   647→\t\t\t<ManualEntryDialog\n   648→\t\t\t\topen={showManualEntry}\n   649→\t\t\t\tonClose={() => setShowManualEntry(false)}\n   650→\t\t\t\tuserId={user.id}\n   651→\t\t\t\tonSave={loadTimeCards}\n   652→\t\t\t\tlanguage={language}\n   653→\t\t\t/>\n   654→\t\t</div>\n   655→\t);\n   656→}\n   657→\n   658→function ManagerView({ user, users, language, onUsersChange }: { user: UserModel; users: UserModel[]; language: Language; onUsersChange: () => void }) {\n   659→\tconst [activeTab, setActiveTab] = useState(\"timecards\");\n   660→\n   661→\tconst t = translations[language];\n   662→\n   663→\treturn (\n   664→\t\t<Tabs value={activeTab} onValueChange={setActiveTab}>\n   665→\t\t\t<TabsList className=\"grid w-full grid-cols-3\">\n   666→\t\t\t\t<TabsTrigger value=\"timecards\">\n   667→\t\t\t\t\t<Clock className=\"w-4 h-4 mr-2\" />\n   668→\t\t\t\t\t{t.timeCards}\n   669→\t\t\t\t</TabsTrigger>\n   670→\t\t\t\t<TabsTrigger value=\"reports\">\n   671→\t\t\t\t\t<FileText className=\"w-4 h-4 mr-2\" />\n   672→\t\t\t\t\t{t.reports}\n   673→\t\t\t\t</TabsTrigger>\n   674→\t\t\t\t<TabsTrigger value=\"employees\">\n   675→\t\t\t\t\t<Users className=\"w-4 h-4 mr-2\" />\n   676→\t\t\t\t\t{t.employees}\n   677→\t\t\t\t</TabsTrigger>\n   678→\t\t\t</TabsList>\n   679→\n   680→\t\t\t<TabsContent value=\"timecards\" className=\"space-y-4\">\n   681→\t\t\t\t<TimeCardsTab users={users} language={language} />\n   682→\t\t\t</TabsContent>\n   683→\n   684→\t\t\t<TabsContent value=\"reports\" className=\"space-y-4\">\n   685→\t\t\t\t<ReportsTab users={users} language={language} />\n   686→\t\t\t</TabsContent>\n   687→\n   688→\t\t\t<TabsContent value=\"employees\" className=\"space-y-4\">\n   689→\t\t\t\t<EmployeesTab users={users} language={language} onUsersChange={onUsersChange} />\n   690→\t\t\t</TabsContent>\n   691→\t\t</Tabs>\n   692→\t);\n   693→}\n   694→\n   695→function TimeCardsTab({ users, language }: { users: UserModel[]; language: Language }) {\n   696→\tconst [allTimeCards, setAllTimeCards] = useState<TimeCardEntryModel[]>([]);\n   697→\tconst [filteredCards, setFilteredCards] = useState<TimeCardEntryModel[]>([]);\n   698→\tconst [selectedEmployee, setSelectedEmployee] = useState<string>(\"all\");\n   699→\tconst [dateFilter, setDateFilter] = useState<string>(\"\");\n   700→\tconst [editingCard, setEditingCard] = useState<TimeCardEntryModel | null>(null);\n   701→\tconst [editClockIn, setEditClockIn] = useState(\"\");\n   702→\tconst [editClockOut, setEditClockOut] = useState(\"\");\n   703→\tconst [editLocation, setEditLocation] = useState(\"\");\n   704→\tconst [editWorkDescription, setEditWorkDescription] = useState(\"\");\n   705→\tconst [editLunchStart, setEditLunchStart] = useState(\"\");\n   706→\tconst [editLunchEnd, setEditLunchEnd] = useState(\"\");\n   707→\tconst [showManualEntry, setShowManualEntry] = useState(false);\n   708→\tconst [manualEntryUserId, setManualEntryUserId] = useState<string>(\"\");\n   709→\n   710→\tconst t = translations[language];\n   711→\n   712→\tuseEffect(() => {\n   713→\t\tloadAllTimeCards();\n   714→\t}, []);\n   715→\n   716→\tuseEffect(() => {\n   717→\t\tapplyFilters();\n   718→\t}, [allTimeCards, selectedEmployee, dateFilter]);\n   719→\n   720→\tconst loadAllTimeCards = async () => {\n   721→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n   722→\t\tconst allCards = await timeCardORM.getAllTimeCardEntry();\n   723→\n   724→\t\t// Sort by clock in time (newest first)\n   725→\t\tconst sorted = allCards.sort((a, b) =>\n   726→\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n   727→\t\t);\n   728→\n   729→\t\tsetAllTimeCards(sorted);\n   730→\t};\n   731→\n   732→\tconst applyFilters = () => {\n   733→\t\tlet filtered = [...allTimeCards];\n   734→\n   735→\t\t// Filter by employee\n   736→\t\tif (selectedEmployee !== \"all\") {\n   737→\t\t\tfiltered = filtered.filter(tc => tc.user_id === selectedEmployee);\n   738→\t\t}\n   739→\n   740→\t\t// Filter by date\n   741→\t\tif (dateFilter) {\n   742→\t\t\tconst filterDate = new Date(dateFilter);\n   743→\t\t\tconst filterTimestamp = Math.floor(filterDate.getTime() / 1000);\n   744→\t\t\tconst nextDayTimestamp = filterTimestamp + 86400; // +24 hours\n   745→\n   746→\t\t\tfiltered = filtered.filter(tc => {\n   747→\t\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n   748→\t\t\t\treturn clockIn >= filterTimestamp && clockIn < nextDayTimestamp;\n   749→\t\t\t});\n   750→\t\t}\n   751→\n   752→\t\tsetFilteredCards(filtered);\n   753→\t};\n   754→\n   755→\tconst getUserName = (userId: string) => {\n   756→\t\tconst user = users.find(u => u.id === userId);\n   757→\t\treturn user?.name || \"Unknown\";\n   758→\t};\n   759→\n   760→\tconst formatDate = (timestamp: string) => {\n   761→\t\tconst date = new Date(parseInt(timestamp) * 1000);\n   762→\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n   763→\t};\n   764→\n   765→\tconst formatHours = (hours: number | null | undefined) => {\n   766→\t\tif (hours === null || hours === undefined) return \"—\";\n   767→\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n   768→\t};\n   769→\n   770→\tconst formatMinutes = (minutes: number | null | undefined) => {\n   771→\t\tif (minutes === null || minutes === undefined) return \"—\";\n   772→\t\treturn `${Math.round(minutes)} min`;\n   773→\t};\n   774→\n   775→\tconst calculateTotalHours = (period: 'day' | 'week') => {\n   776→\t\tconst now = Date.now() / 1000;\n   777→\t\tconst periodSeconds = period === 'day' ? 86400 : 604800; // 1 day or 7 days\n   778→\t\tconst startTime = now - periodSeconds;\n   779→\n   780→\t\tconst relevantCards = allTimeCards.filter(tc => {\n   781→\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n   782→\t\t\treturn clockIn >= startTime && tc.total_hours;\n   783→\t\t});\n   784→\n   785→\t\treturn relevantCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);\n   786→\t};\n   787→\n   788→\tconst handleEditCard = (card: TimeCardEntryModel) => {\n   789→\t\tsetEditingCard(card);\n   790→\t\tsetEditClockIn(new Date(parseInt(card.clock_in_timestamp) * 1000).toISOString().slice(0, 16));\n   791→\t\tsetEditClockOut(\n   792→\t\t\tcard.clock_out_timestamp\n   793→\t\t\t\t? new Date(parseInt(card.clock_out_timestamp) * 1000).toISOString().slice(0, 16)\n   794→\t\t\t\t: \"\"\n   795→\t\t);\n   796→\t\tsetEditLocation(card.location || \"\");\n   797→\t\tsetEditWorkDescription(card.work_description || \"\");\n   798→\t\tsetEditLunchStart(\n   799→\t\t\tcard.lunch_start_timestamp\n   800→\t\t\t\t? new Date(parseInt(card.lunch_start_timestamp) * 1000).toISOString().slice(0, 16)\n   801→\t\t\t\t: \"\"\n   802→\t\t);\n   803→\t\tsetEditLunchEnd(\n   804→\t\t\tcard.lunch_end_timestamp\n   805→\t\t\t\t? new Date(parseInt(card.lunch_end_timestamp) * 1000).toISOString().slice(0, 16)\n   806→\t\t\t\t: \"\"\n   807→\t\t);\n   808→\t};\n   809→\n   810→\tconst handleSaveEdit = async () => {\n   811→\t\tif (!editingCard) return;\n   812→\n   813→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n   814→\t\tconst clockInTimestamp = Math.floor(new Date(editClockIn).getTime() / 1000).toString();\n   815→\t\tconst clockOutTimestamp = editClockOut\n   816→\t\t\t? Math.floor(new Date(editClockOut).getTime() / 1000).toString()\n   817→\t\t\t: null;\n   818→\t\tconst lunchStartTimestamp = editLunchStart\n   819→\t\t\t? Math.floor(new Date(editLunchStart).getTime() / 1000).toString()\n   820→\t\t\t: null;\n   821→\t\tconst lunchEndTimestamp = editLunchEnd\n   822→\t\t\t? Math.floor(new Date(editLunchEnd).getTime() / 1000).toString()\n   823→\t\t\t: null;\n   824→\n   825→\t\tlet totalHours = null;\n   826→\t\tlet lunchDurationMinutes = null;\n   827→\n   828→\t\t// Calculate lunch duration\n   829→\t\tif (lunchStartTimestamp && lunchEndTimestamp) {\n   830→\t\t\tconst lunchStart = parseInt(lunchStartTimestamp);\n   831→\t\t\tconst lunchEnd = parseInt(lunchEndTimestamp);\n   832→\t\t\tlunchDurationMinutes = (lunchEnd - lunchStart) / 60;\n   833→\t\t}\n   834→\n   835→\t\t// Calculate total hours\n   836→\t\tif (clockOutTimestamp) {\n   837→\t\t\tconst clockInTime = parseInt(clockInTimestamp);\n   838→\t\t\tconst clockOutTime = parseInt(clockOutTimestamp);\n   839→\t\t\ttotalHours = (clockOutTime - clockInTime) / 3600;\n   840→\n   841→\t\t\t// Deduct lunch time\n   842→\t\t\tif (lunchDurationMinutes) {\n   843→\t\t\t\ttotalHours -= lunchDurationMinutes / 60;\n   844→\t\t\t}\n   845→\t\t}\n   846→\n   847→\t\tawait timeCardORM.setTimeCardEntryById(editingCard.id, {\n   848→\t\t\t...editingCard,\n   849→\t\t\tclock_in_timestamp: clockInTimestamp,\n   850→\t\t\tclock_out_timestamp: clockOutTimestamp,\n   851→\t\t\ttotal_hours: totalHours,\n   852→\t\t\tlocation: editLocation || null,\n   853→\t\t\twork_description: editWorkDescription || null,\n   854→\t\t\tlunch_start_timestamp: lunchStartTimestamp,\n   855→\t\t\tlunch_end_timestamp: lunchEndTimestamp,\n   856→\t\t\tlunch_duration_minutes: lunchDurationMinutes,\n   857→\t\t});\n   858→\n   859→\t\tsetEditingCard(null);\n   860→\t\tawait loadAllTimeCards();\n   861→\t};\n   862→\n   863→\tconst handleAddManualEntry = (userId: string) => {\n   864→\t\tsetManualEntryUserId(userId);\n   865→\t\tsetShowManualEntry(true);\n   866→\t};\n   867→\n   868→\treturn (\n   869→\t\t<>\n   870→\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n   871→\t\t\t\t<Card>\n   872→\t\t\t\t\t<CardHeader className=\"pb-3\">\n   873→\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n   874→\t\t\t\t\t\t\t<Users className=\"w-4 h-4\" />\n   875→\t\t\t\t\t\t\t{t.totalEmployees}\n   876→\t\t\t\t\t\t</CardTitle>\n   877→\t\t\t\t\t</CardHeader>\n   878→\t\t\t\t\t<CardContent>\n   879→\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{users.filter(u => u.role === UserRole.Employee).length}</div>\n   880→\t\t\t\t\t</CardContent>\n   881→\t\t\t\t</Card>\n   882→\n   883→\t\t\t\t<Card>\n   884→\t\t\t\t\t<CardHeader className=\"pb-3\">\n   885→\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n   886→\t\t\t\t\t\t\t<Timer className=\"w-4 h-4\" />\n   887→\t\t\t\t\t\t\t{t.hoursToday}\n   888→\t\t\t\t\t\t</CardTitle>\n   889→\t\t\t\t\t</CardHeader>\n   890→\t\t\t\t\t<CardContent>\n   891→\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('day').toFixed(2)}</div>\n   892→\t\t\t\t\t</CardContent>\n   893→\t\t\t\t</Card>\n   894→\n   895→\t\t\t\t<Card>\n   896→\t\t\t\t\t<CardHeader className=\"pb-3\">\n   897→\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n   898→\t\t\t\t\t\t\t<CalendarDays className=\"w-4 h-4\" />\n   899→\t\t\t\t\t\t\t{t.hoursThisWeek}\n   900→\t\t\t\t\t\t</CardTitle>\n   901→\t\t\t\t\t</CardHeader>\n   902→\t\t\t\t\t<CardContent>\n   903→\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('week').toFixed(2)}</div>\n   904→\t\t\t\t\t</CardContent>\n   905→\t\t\t\t</Card>\n   906→\t\t\t</div>\n   907→\n   908→\t\t\t<Card>\n   909→\t\t\t\t<CardHeader>\n   910→\t\t\t\t\t<div className=\"flex justify-between items-center\">\n   911→\t\t\t\t\t\t<div>\n   912→\t\t\t\t\t\t\t<CardTitle>{t.allEmployeeTimeCards}</CardTitle>\n   913→\t\t\t\t\t\t\t<CardDescription>{t.viewManageRecords}</CardDescription>\n   914→\t\t\t\t\t\t</div>\n   915→\t\t\t\t\t\t<Button onClick={() => handleAddManualEntry(\"\")} variant=\"outline\" size=\"sm\">\n   916→\t\t\t\t\t\t\t<Plus className=\"w-4 h-4 mr-2\" />\n   917→\t\t\t\t\t\t\t{t.addTimeCard}\n   918→\t\t\t\t\t\t</Button>\n   919→\t\t\t\t\t</div>\n   920→\t\t\t\t</CardHeader>\n   921→\t\t\t\t<CardContent className=\"space-y-4\">\n   922→\t\t\t\t\t<div className=\"flex gap-4 flex-wrap\">\n   923→\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n   924→\t\t\t\t\t\t\t<Label>{t.filterByEmployee}</Label>\n   925→\t\t\t\t\t\t\t<Select value={selectedEmployee} onValueChange={setSelectedEmployee}>\n   926→\t\t\t\t\t\t\t\t<SelectTrigger>\n   927→\t\t\t\t\t\t\t\t\t<SelectValue />\n   928→\t\t\t\t\t\t\t\t</SelectTrigger>\n   929→\t\t\t\t\t\t\t\t<SelectContent>\n   930→\t\t\t\t\t\t\t\t\t<SelectItem value=\"all\">{t.allEmployees}</SelectItem>\n   931→\t\t\t\t\t\t\t\t\t{users.filter(u => u.role === UserRole.Employee).map((u) => (\n   932→\t\t\t\t\t\t\t\t\t\t<SelectItem key={u.id} value={u.id}>\n   933→\t\t\t\t\t\t\t\t\t\t\t{u.name}\n   934→\t\t\t\t\t\t\t\t\t\t</SelectItem>\n   935→\t\t\t\t\t\t\t\t\t))}\n   936→\t\t\t\t\t\t\t\t</SelectContent>\n   937→\t\t\t\t\t\t\t</Select>\n   938→\t\t\t\t\t\t</div>\n   939→\n   940→\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n   941→\t\t\t\t\t\t\t<Label>{t.filterByDate}</Label>\n   942→\t\t\t\t\t\t\t<Input\n   943→\t\t\t\t\t\t\t\ttype=\"date\"\n   944→\t\t\t\t\t\t\t\tvalue={dateFilter}\n   945→\t\t\t\t\t\t\t\tonChange={(e) => setDateFilter(e.target.value)}\n   946→\t\t\t\t\t\t\t/>\n   947→\t\t\t\t\t\t</div>\n   948→\n   949→\t\t\t\t\t\t{(selectedEmployee !== \"all\" || dateFilter) && (\n   950→\t\t\t\t\t\t\t<div className=\"flex items-end\">\n   951→\t\t\t\t\t\t\t\t<Button\n   952→\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n   953→\t\t\t\t\t\t\t\t\tonClick={() => {\n   954→\t\t\t\t\t\t\t\t\t\tsetSelectedEmployee(\"all\");\n   955→\t\t\t\t\t\t\t\t\t\tsetDateFilter(\"\");\n   956→\t\t\t\t\t\t\t\t\t}}\n   957→\t\t\t\t\t\t\t\t>\n   958→\t\t\t\t\t\t\t\t\t{t.clearFilters}\n   959→\t\t\t\t\t\t\t\t</Button>\n   960→\t\t\t\t\t\t\t</div>\n   961→\t\t\t\t\t\t)}\n   962→\t\t\t\t\t</div>\n   963→\n   964→\t\t\t\t\t{filteredCards.length === 0 ? (\n   965→\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCardsFound}</p>\n   966→\t\t\t\t\t) : (\n   967→\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n   968→\t\t\t\t\t\t\t<Table>\n   969→\t\t\t\t\t\t\t\t<TableHeader>\n   970→\t\t\t\t\t\t\t\t\t<TableRow>\n   971→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.employeeName}</TableHead>\n   972→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n   973→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n   974→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n   975→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n   976→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n   977→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n   978→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n   979→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.actions}</TableHead>\n   980→\t\t\t\t\t\t\t\t\t</TableRow>\n   981→\t\t\t\t\t\t\t\t</TableHeader>\n   982→\t\t\t\t\t\t\t\t<TableBody>\n   983→\t\t\t\t\t\t\t\t\t{filteredCards.map((tc) => (\n   984→\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n   985→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium whitespace-nowrap\">{getUserName(tc.user_id)}</TableCell>\n   986→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n   987→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n   988→\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n   989→\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n   990→\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n   991→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n   992→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n   993→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n   994→\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n   995→\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n   996→\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n   997→\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n   998→\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n   999→\t\t\t\t\t\t\t\t\t\t\t\t) : (\n  1000→\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n  1001→\t\t\t\t\t\t\t\t\t\t\t\t)}\n  1002→\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n  1003→\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n  1004→\t\t\t\t\t\t\t\t\t\t\t\t<Button\n  1005→\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n  1006→\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n  1007→\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleEditCard(tc)}\n  1008→\t\t\t\t\t\t\t\t\t\t\t\t>\n  1009→\t\t\t\t\t\t\t\t\t\t\t\t\t{t.edit}\n  1010→\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n  1011→\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n  1012→\t\t\t\t\t\t\t\t\t\t</TableRow>\n  1013→\t\t\t\t\t\t\t\t\t))}\n  1014→\t\t\t\t\t\t\t\t</TableBody>\n  1015→\t\t\t\t\t\t\t</Table>\n  1016→\t\t\t\t\t\t</div>\n  1017→\t\t\t\t\t)}\n  1018→\t\t\t\t</CardContent>\n  1019→\t\t\t</Card>\n  1020→\n  1021→\t\t\t<Dialog open={!!editingCard} onOpenChange={(open) => !open && setEditingCard(null)}>\n  1022→\t\t\t\t<DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n  1023→\t\t\t\t\t<DialogHeader>\n  1024→\t\t\t\t\t\t<DialogTitle>{t.editTimeCard}</DialogTitle>\n  1025→\t\t\t\t\t</DialogHeader>\n  1026→\t\t\t\t\t<div className=\"space-y-4\">\n  1027→\t\t\t\t\t\t<div>\n  1028→\t\t\t\t\t\t\t<Label>{t.employeeName}</Label>\n  1029→\t\t\t\t\t\t\t<Input value={editingCard ? getUserName(editingCard.user_id) : \"\"} disabled />\n  1030→\t\t\t\t\t\t</div>\n  1031→\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n  1032→\t\t\t\t\t\t\t<div>\n  1033→\t\t\t\t\t\t\t\t<Label>{t.clockInTime}</Label>\n  1034→\t\t\t\t\t\t\t\t<Input\n  1035→\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1036→\t\t\t\t\t\t\t\t\tvalue={editClockIn}\n  1037→\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockIn(e.target.value)}\n  1038→\t\t\t\t\t\t\t\t/>\n  1039→\t\t\t\t\t\t\t</div>\n  1040→\t\t\t\t\t\t\t<div>\n  1041→\t\t\t\t\t\t\t\t<Label>{t.clockOutTime}</Label>\n  1042→\t\t\t\t\t\t\t\t<Input\n  1043→\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1044→\t\t\t\t\t\t\t\t\tvalue={editClockOut}\n  1045→\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockOut(e.target.value)}\n  1046→\t\t\t\t\t\t\t\t/>\n  1047→\t\t\t\t\t\t\t</div>\n  1048→\t\t\t\t\t\t</div>\n  1049→\t\t\t\t\t\t<div>\n  1050→\t\t\t\t\t\t\t<Label>{t.location}</Label>\n  1051→\t\t\t\t\t\t\t<Input\n  1052→\t\t\t\t\t\t\t\tvalue={editLocation}\n  1053→\t\t\t\t\t\t\t\tonChange={(e) => setEditLocation(e.target.value)}\n  1054→\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n  1055→\t\t\t\t\t\t\t/>\n  1056→\t\t\t\t\t\t</div>\n  1057→\t\t\t\t\t\t<div>\n  1058→\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n  1059→\t\t\t\t\t\t\t<Textarea\n  1060→\t\t\t\t\t\t\t\tvalue={editWorkDescription}\n  1061→\t\t\t\t\t\t\t\tonChange={(e) => setEditWorkDescription(e.target.value)}\n  1062→\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n  1063→\t\t\t\t\t\t\t\trows={4}\n  1064→\t\t\t\t\t\t\t/>\n  1065→\t\t\t\t\t\t</div>\n  1066→\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n  1067→\t\t\t\t\t\t\t<div>\n  1068→\t\t\t\t\t\t\t\t<Label>{t.lunchStartTime}</Label>\n  1069→\t\t\t\t\t\t\t\t<Input\n  1070→\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1071→\t\t\t\t\t\t\t\t\tvalue={editLunchStart}\n  1072→\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchStart(e.target.value)}\n  1073→\t\t\t\t\t\t\t\t/>\n  1074→\t\t\t\t\t\t\t</div>\n  1075→\t\t\t\t\t\t\t<div>\n  1076→\t\t\t\t\t\t\t\t<Label>{t.lunchEndTime}</Label>\n  1077→\t\t\t\t\t\t\t\t<Input\n  1078→\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1079→\t\t\t\t\t\t\t\t\tvalue={editLunchEnd}\n  1080→\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchEnd(e.target.value)}\n  1081→\t\t\t\t\t\t\t\t/>\n  1082→\t\t\t\t\t\t\t</div>\n  1083→\t\t\t\t\t\t</div>\n  1084→\t\t\t\t\t</div>\n  1085→\t\t\t\t\t<DialogFooter>\n  1086→\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setEditingCard(null)}>\n  1087→\t\t\t\t\t\t\t{t.cancel}\n  1088→\t\t\t\t\t\t</Button>\n  1089→\t\t\t\t\t\t<Button onClick={handleSaveEdit}>\n  1090→\t\t\t\t\t\t\t{t.saveChanges}\n  1091→\t\t\t\t\t\t</Button>\n  1092→\t\t\t\t\t</DialogFooter>\n  1093→\t\t\t\t</DialogContent>\n  1094→\t\t\t</Dialog>\n  1095→\n  1096→\t\t\t<ManualEntryDialog\n  1097→\t\t\t\topen={showManualEntry}\n  1098→\t\t\t\tonClose={() => setShowManualEntry(false)}\n  1099→\t\t\t\tuserId={manualEntryUserId}\n  1100→\t\t\t\tonSave={loadAllTimeCards}\n  1101→\t\t\t\tlanguage={language}\n  1102→\t\t\t\tusers={users}\n  1103→\t\t\t/>\n  1104→\t\t</>\n  1105→\t);\n  1106→}\n  1107→\n  1108→function ReportsTab({ users, language }: { users: UserModel[]; language: Language }) {\n  1109→\tconst [weekStart, setWeekStart] = useState(\"\");\n  1110→\tconst [reportData, setReportData] = useState<{ user: UserModel; regularHours: number; overtimeHours: number; totalHours: number }[]>([]);\n  1111→\n  1112→\tconst t = translations[language];\n  1113→\n  1114→\tuseEffect(() => {\n  1115→\t\t// Set default to current week\n  1116→\t\tconst today = new Date();\n  1117→\t\tconst monday = new Date(today);\n  1118→\t\tmonday.setDate(today.getDate() - today.getDay() + 1);\n  1119→\t\tsetWeekStart(monday.toISOString().slice(0, 10));\n  1120→\t}, []);\n  1121→\n  1122→\tuseEffect(() => {\n  1123→\t\tif (weekStart) {\n  1124→\t\t\tloadWeeklyReport();\n  1125→\t\t}\n  1126→\t}, [weekStart, users]);\n  1127→\n  1128→\tconst loadWeeklyReport = async () => {\n  1129→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n  1130→\t\tconst allCards = await timeCardORM.getAllTimeCardEntry();\n  1131→\n  1132→\t\tconst weekStartDate = new Date(weekStart);\n  1133→\t\tconst weekStartTimestamp = Math.floor(weekStartDate.getTime() / 1000);\n  1134→\t\tconst weekEndTimestamp = weekStartTimestamp + 604800; // 7 days\n  1135→\n  1136→\t\tconst weekCards = allCards.filter(tc => {\n  1137→\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n  1138→\t\t\treturn clockIn >= weekStartTimestamp && clockIn < weekEndTimestamp && tc.total_hours;\n  1139→\t\t});\n  1140→\n  1141→\t\tconst employeeHours = users\n  1142→\t\t\t.filter(u => u.role === UserRole.Employee)\n  1143→\t\t\t.map(user => {\n  1144→\t\t\t\tconst userCards = weekCards.filter(tc => tc.user_id === user.id);\n  1145→\t\t\t\tconst totalHours = userCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);\n  1146→\t\t\t\tconst regularHours = Math.min(totalHours, 40);\n  1147→\t\t\t\tconst overtimeHours = Math.max(totalHours - 40, 0);\n  1148→\n  1149→\t\t\t\treturn {\n  1150→\t\t\t\t\tuser,\n  1151→\t\t\t\t\tregularHours,\n  1152→\t\t\t\t\tovertimeHours,\n  1153→\t\t\t\t\ttotalHours,\n  1154→\t\t\t\t};\n  1155→\t\t\t});\n  1156→\n  1157→\t\tsetReportData(employeeHours);\n  1158→\t};\n  1159→\n  1160→\tconst formatHours = (hours: number) => {\n  1161→\t\treturn `${hours.toFixed(2)} hrs`;\n  1162→\t};\n  1163→\n  1164→\treturn (\n  1165→\t\t<div className=\"space-y-4\">\n  1166→\t\t\t<Card>\n  1167→\t\t\t\t<CardHeader>\n  1168→\t\t\t\t\t<CardTitle>{t.weeklyReport}</CardTitle>\n  1169→\t\t\t\t\t<CardDescription>Overtime calculated for hours worked beyond 40 hours/week</CardDescription>\n  1170→\t\t\t\t</CardHeader>\n  1171→\t\t\t\t<CardContent className=\"space-y-4\">\n  1172→\t\t\t\t\t<div className=\"max-w-xs\">\n  1173→\t\t\t\t\t\t<Label>{t.selectWeek}</Label>\n  1174→\t\t\t\t\t\t<Input\n  1175→\t\t\t\t\t\t\ttype=\"date\"\n  1176→\t\t\t\t\t\t\tvalue={weekStart}\n  1177→\t\t\t\t\t\t\tonChange={(e) => setWeekStart(e.target.value)}\n  1178→\t\t\t\t\t\t/>\n  1179→\t\t\t\t\t</div>\n  1180→\n  1181→\t\t\t\t\t{reportData.length === 0 ? (\n  1182→\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noReportData}</p>\n  1183→\t\t\t\t\t) : (\n  1184→\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n  1185→\t\t\t\t\t\t\t<Table>\n  1186→\t\t\t\t\t\t\t\t<TableHeader>\n  1187→\t\t\t\t\t\t\t\t\t<TableRow>\n  1188→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.employeeName}</TableHead>\n  1189→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.regularHours}</TableHead>\n  1190→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.overtimeHours}</TableHead>\n  1191→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.totalHours}</TableHead>\n  1192→\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n  1193→\t\t\t\t\t\t\t\t\t</TableRow>\n  1194→\t\t\t\t\t\t\t\t</TableHeader>\n  1195→\t\t\t\t\t\t\t\t<TableBody>\n  1196→\t\t\t\t\t\t\t\t\t{reportData.map(({ user, regularHours, overtimeHours, totalHours }) => (\n  1197→\t\t\t\t\t\t\t\t\t\t<TableRow key={user.id}>\n  1198→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">{user.name}</TableCell>\n  1199→\t\t\t\t\t\t\t\t\t\t\t<TableCell>{formatHours(regularHours)}</TableCell>\n  1200→\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n  1201→\t\t\t\t\t\t\t\t\t\t\t\t{overtimeHours > 0 ? (\n  1202→\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-orange-600 font-semibold\">{formatHours(overtimeHours)}</span>\n  1203→\t\t\t\t\t\t\t\t\t\t\t\t) : (\n  1204→\t\t\t\t\t\t\t\t\t\t\t\t\tformatHours(0)\n  1205→\t\t\t\t\t\t\t\t\t\t\t\t)}\n  1206→\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n  1207→\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-semibold\">{formatHours(totalHours)}</TableCell>\n  1208→\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n  1209→\t\t\t\t\t\t\t\t\t\t\t\t{overtimeHours > 0 && (\n  1210→\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">\n  1211→\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertCircle className=\"w-3 h-3 mr-1\" />\n  1212→\t\t\t\t\t\t\t\t\t\t\t\t\t\t{t.overtimeAlert}\n  1213→\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n  1214→\t\t\t\t\t\t\t\t\t\t\t\t)}\n  1215→\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n  1216→\t\t\t\t\t\t\t\t\t\t</TableRow>\n  1217→\t\t\t\t\t\t\t\t\t))}\n  1218→\t\t\t\t\t\t\t\t</TableBody>\n  1219→\t\t\t\t\t\t\t</Table>\n  1220→\t\t\t\t\t\t</div>\n  1221→\t\t\t\t\t)}\n  1222→\t\t\t\t</CardContent>\n  1223→\t\t\t</Card>\n  1224→\t\t</div>\n  1225→\t);\n  1226→}\n  1227→\n  1228→function EmployeesTab({ users, language, onUsersChange }: { users: UserModel[]; language: Language; onUsersChange: () => void }) {\n  1229→\tconst [showAddEmployee, setShowAddEmployee] = useState(false);\n  1230→\tconst [editingEmployee, setEditingEmployee] = useState<UserModel | null>(null);\n  1231→\tconst [employeeName, setEmployeeName] = useState(\"\");\n  1232→\tconst [employeeEmail, setEmployeeEmail] = useState(\"\");\n  1233→\tconst [employeeRole, setEmployeeRole] = useState<UserRole>(UserRole.Employee);\n  1234→\tconst [deleteConfirm, setDeleteConfirm] = useState<UserModel | null>(null);\n  1235→\n  1236→\tconst t = translations[language];\n  1237→\n  1238→\tconst handleAddEmployee = async () => {\n  1239→\t\tconst userORM = UserORM.getInstance();\n  1240→\t\tawait userORM.insertUser([{\n  1241→\t\t\tname: employeeName,\n  1242→\t\t\temail: employeeEmail,\n  1243→\t\t\trole: employeeRole,\n  1244→\t\t} as UserModel]);\n  1245→\n  1246→\t\tsetShowAddEmployee(false);\n  1247→\t\tsetEmployeeName(\"\");\n  1248→\t\tsetEmployeeEmail(\"\");\n  1249→\t\tsetEmployeeRole(UserRole.Employee);\n  1250→\t\tonUsersChange();\n  1251→\t};\n  1252→\n  1253→\tconst handleEditEmployee = async () => {\n  1254→\t\tif (!editingEmployee) return;\n  1255→\n  1256→\t\tconst userORM = UserORM.getInstance();\n  1257→\t\tawait userORM.setUserById(editingEmployee.id, {\n  1258→\t\t\t...editingEmployee,\n  1259→\t\t\tname: employeeName,\n  1260→\t\t\temail: employeeEmail,\n  1261→\t\t\trole: employeeRole,\n  1262→\t\t});\n  1263→\n  1264→\t\tsetEditingEmployee(null);\n  1265→\t\tsetEmployeeName(\"\");\n  1266→\t\tsetEmployeeEmail(\"\");\n  1267→\t\tsetEmployeeRole(UserRole.Employee);\n  1268→\t\tonUsersChange();\n  1269→\t};\n  1270→\n  1271→\tconst handleDeleteEmployee = async (user: UserModel) => {\n  1272→\t\tconst userORM = UserORM.getInstance();\n  1273→\t\tawait userORM.deleteUserById(user.id);\n  1274→\t\tsetDeleteConfirm(null);\n  1275→\t\tonUsersChange();\n  1276→\t};\n  1277→\n  1278→\tconst openEditDialog = (user: UserModel) => {\n  1279→\t\tsetEditingEmployee(user);\n  1280→\t\tsetEmployeeName(user.name);\n  1281→\t\tsetEmployeeEmail(user.email);\n  1282→\t\tsetEmployeeRole(user.role);\n  1283→\t};\n  1284→\n  1285→\treturn (\n  1286→\t\t<div className=\"space-y-4\">\n  1287→\t\t\t<Card>\n  1288→\t\t\t\t<CardHeader>\n  1289→\t\t\t\t\t<div className=\"flex justify-between items-center\">\n  1290→\t\t\t\t\t\t<div>\n  1291→\t\t\t\t\t\t\t<CardTitle>{t.employees}</CardTitle>\n  1292→\t\t\t\t\t\t\t<CardDescription>Manage employee accounts</CardDescription>\n  1293→\t\t\t\t\t\t</div>\n  1294→\t\t\t\t\t\t<Button onClick={() => setShowAddEmployee(true)}>\n  1295→\t\t\t\t\t\t\t<UserPlus className=\"w-4 h-4 mr-2\" />\n  1296→\t\t\t\t\t\t\t{t.addEmployee}\n  1297→\t\t\t\t\t\t</Button>\n  1298→\t\t\t\t\t</div>\n  1299→\t\t\t\t</CardHeader>\n  1300→\t\t\t\t<CardContent>\n  1301→\t\t\t\t\t<div className=\"overflow-x-auto\">\n  1302→\t\t\t\t\t\t<Table>\n  1303→\t\t\t\t\t\t\t<TableHeader>\n  1304→\t\t\t\t\t\t\t\t<TableRow>\n  1305→\t\t\t\t\t\t\t\t\t<TableHead>{t.name}</TableHead>\n  1306→\t\t\t\t\t\t\t\t\t<TableHead>{t.email}</TableHead>\n  1307→\t\t\t\t\t\t\t\t\t<TableHead>{t.role}</TableHead>\n  1308→\t\t\t\t\t\t\t\t\t<TableHead>{t.actions}</TableHead>\n  1309→\t\t\t\t\t\t\t\t</TableRow>\n  1310→\t\t\t\t\t\t\t</TableHeader>\n  1311→\t\t\t\t\t\t\t<TableBody>\n  1312→\t\t\t\t\t\t\t\t{users.map((user) => (\n  1313→\t\t\t\t\t\t\t\t\t<TableRow key={user.id}>\n  1314→\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">{user.name}</TableCell>\n  1315→\t\t\t\t\t\t\t\t\t\t<TableCell>{user.email}</TableCell>\n  1316→\t\t\t\t\t\t\t\t\t\t<TableCell>\n  1317→\t\t\t\t\t\t\t\t\t\t\t<Badge variant={user.role === UserRole.Manager ? \"default\" : \"secondary\"}>\n  1318→\t\t\t\t\t\t\t\t\t\t\t\t{user.role === UserRole.Manager ? t.manager : t.employee}\n  1319→\t\t\t\t\t\t\t\t\t\t\t</Badge>\n  1320→\t\t\t\t\t\t\t\t\t\t</TableCell>\n  1321→\t\t\t\t\t\t\t\t\t\t<TableCell>\n  1322→\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex gap-2\">\n  1323→\t\t\t\t\t\t\t\t\t\t\t\t<Button\n  1324→\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n  1325→\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n  1326→\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openEditDialog(user)}\n  1327→\t\t\t\t\t\t\t\t\t\t\t\t>\n  1328→\t\t\t\t\t\t\t\t\t\t\t\t\t{t.edit}\n  1329→\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n  1330→\t\t\t\t\t\t\t\t\t\t\t\t<Button\n  1331→\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"destructive\"\n  1332→\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n  1333→\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setDeleteConfirm(user)}\n  1334→\t\t\t\t\t\t\t\t\t\t\t\t>\n  1335→\t\t\t\t\t\t\t\t\t\t\t\t\t{t.delete}\n  1336→\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n  1337→\t\t\t\t\t\t\t\t\t\t\t</div>\n  1338→\t\t\t\t\t\t\t\t\t\t</TableCell>\n  1339→\t\t\t\t\t\t\t\t\t</TableRow>\n  1340→\t\t\t\t\t\t\t\t))}\n  1341→\t\t\t\t\t\t\t</TableBody>\n  1342→\t\t\t\t\t\t</Table>\n  1343→\t\t\t\t\t</div>\n  1344→\t\t\t\t</CardContent>\n  1345→\t\t\t</Card>\n  1346→\n  1347→\t\t\t<Dialog open={showAddEmployee} onOpenChange={setShowAddEmployee}>\n  1348→\t\t\t\t<DialogContent>\n  1349→\t\t\t\t\t<DialogHeader>\n  1350→\t\t\t\t\t\t<DialogTitle>{t.addEmployee}</DialogTitle>\n  1351→\t\t\t\t\t</DialogHeader>\n  1352→\t\t\t\t\t<div className=\"space-y-4\">\n  1353→\t\t\t\t\t\t<div>\n  1354→\t\t\t\t\t\t\t<Label>{t.name}</Label>\n  1355→\t\t\t\t\t\t\t<Input\n  1356→\t\t\t\t\t\t\t\tvalue={employeeName}\n  1357→\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeName(e.target.value)}\n  1358→\t\t\t\t\t\t\t\tplaceholder=\"John Doe\"\n  1359→\t\t\t\t\t\t\t/>\n  1360→\t\t\t\t\t\t</div>\n  1361→\t\t\t\t\t\t<div>\n  1362→\t\t\t\t\t\t\t<Label>{t.email}</Label>\n  1363→\t\t\t\t\t\t\t<Input\n  1364→\t\t\t\t\t\t\t\ttype=\"email\"\n  1365→\t\t\t\t\t\t\t\tvalue={employeeEmail}\n  1366→\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeEmail(e.target.value)}\n  1367→\t\t\t\t\t\t\t\tplaceholder=\"john@example.com\"\n  1368→\t\t\t\t\t\t\t/>\n  1369→\t\t\t\t\t\t</div>\n  1370→\t\t\t\t\t\t<div>\n  1371→\t\t\t\t\t\t\t<Label>{t.role}</Label>\n  1372→\t\t\t\t\t\t\t<Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>\n  1373→\t\t\t\t\t\t\t\t<SelectTrigger>\n  1374→\t\t\t\t\t\t\t\t\t<SelectValue />\n  1375→\t\t\t\t\t\t\t\t</SelectTrigger>\n  1376→\t\t\t\t\t\t\t\t<SelectContent>\n  1377→\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>\n  1378→\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>\n  1379→\t\t\t\t\t\t\t\t</SelectContent>\n  1380→\t\t\t\t\t\t\t</Select>\n  1381→\t\t\t\t\t\t</div>\n  1382→\t\t\t\t\t</div>\n  1383→\t\t\t\t\t<DialogFooter>\n  1384→\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setShowAddEmployee(false)}>\n  1385→\t\t\t\t\t\t\t{t.cancel}\n  1386→\t\t\t\t\t\t</Button>\n  1387→\t\t\t\t\t\t<Button onClick={handleAddEmployee} disabled={!employeeName || !employeeEmail}>\n  1388→\t\t\t\t\t\t\t{t.saveChanges}\n  1389→\t\t\t\t\t\t</Button>\n  1390→\t\t\t\t\t</DialogFooter>\n  1391→\t\t\t\t</DialogContent>\n  1392→\t\t\t</Dialog>\n  1393→\n  1394→\t\t\t<Dialog open={!!editingEmployee} onOpenChange={(open) => !open && setEditingEmployee(null)}>\n  1395→\t\t\t\t<DialogContent>\n  1396→\t\t\t\t\t<DialogHeader>\n  1397→\t\t\t\t\t\t<DialogTitle>{t.editEmployee}</DialogTitle>\n  1398→\t\t\t\t\t</DialogHeader>\n  1399→\t\t\t\t\t<div className=\"space-y-4\">\n  1400→\t\t\t\t\t\t<div>\n  1401→\t\t\t\t\t\t\t<Label>{t.name}</Label>\n  1402→\t\t\t\t\t\t\t<Input\n  1403→\t\t\t\t\t\t\t\tvalue={employeeName}\n  1404→\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeName(e.target.value)}\n  1405→\t\t\t\t\t\t\t/>\n  1406→\t\t\t\t\t\t</div>\n  1407→\t\t\t\t\t\t<div>\n  1408→\t\t\t\t\t\t\t<Label>{t.email}</Label>\n  1409→\t\t\t\t\t\t\t<Input\n  1410→\t\t\t\t\t\t\t\ttype=\"email\"\n  1411→\t\t\t\t\t\t\t\tvalue={employeeEmail}\n  1412→\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeEmail(e.target.value)}\n  1413→\t\t\t\t\t\t\t/>\n  1414→\t\t\t\t\t\t</div>\n  1415→\t\t\t\t\t\t<div>\n  1416→\t\t\t\t\t\t\t<Label>{t.role}</Label>\n  1417→\t\t\t\t\t\t\t<Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>\n  1418→\t\t\t\t\t\t\t\t<SelectTrigger>\n  1419→\t\t\t\t\t\t\t\t\t<SelectValue />\n  1420→\t\t\t\t\t\t\t\t</SelectTrigger>\n  1421→\t\t\t\t\t\t\t\t<SelectContent>\n  1422→\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>\n  1423→\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>\n  1424→\t\t\t\t\t\t\t\t</SelectContent>\n  1425→\t\t\t\t\t\t\t</Select>\n  1426→\t\t\t\t\t\t</div>\n  1427→\t\t\t\t\t</div>\n  1428→\t\t\t\t\t<DialogFooter>\n  1429→\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setEditingEmployee(null)}>\n  1430→\t\t\t\t\t\t\t{t.cancel}\n  1431→\t\t\t\t\t\t</Button>\n  1432→\t\t\t\t\t\t<Button onClick={handleEditEmployee}>\n  1433→\t\t\t\t\t\t\t{t.saveChanges}\n  1434→\t\t\t\t\t\t</Button>\n  1435→\t\t\t\t\t</DialogFooter>\n  1436→\t\t\t\t</DialogContent>\n  1437→\t\t\t</Dialog>\n  1438→\n  1439→\t\t\t<Dialog open={!!deleteConfirm} onOpenChange={(open) => !open && setDeleteConfirm(null)}>\n  1440→\t\t\t\t<DialogContent>\n  1441→\t\t\t\t\t<DialogHeader>\n  1442→\t\t\t\t\t\t<DialogTitle>{t.deleteEmployee}</DialogTitle>\n  1443→\t\t\t\t\t</DialogHeader>\n  1444→\t\t\t\t\t<p>{t.confirmDelete}</p>\n  1445→\t\t\t\t\t<p className=\"font-semibold\">{deleteConfirm?.name}</p>\n  1446→\t\t\t\t\t<DialogFooter>\n  1447→\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setDeleteConfirm(null)}>\n  1448→\t\t\t\t\t\t\t{t.cancel}\n  1449→\t\t\t\t\t\t</Button>\n  1450→\t\t\t\t\t\t<Button variant=\"destructive\" onClick={() => deleteConfirm && handleDeleteEmployee(deleteConfirm)}>\n  1451→\t\t\t\t\t\t\t{t.delete}\n  1452→\t\t\t\t\t\t</Button>\n  1453→\t\t\t\t\t</DialogFooter>\n  1454→\t\t\t\t</DialogContent>\n  1455→\t\t\t</Dialog>\n  1456→\t\t</div>\n  1457→\t);\n  1458→}\n  1459→\n  1460→function ManualEntryDialog({\n  1461→\topen,\n  1462→\tonClose,\n  1463→\tuserId,\n  1464→\tonSave,\n  1465→\tlanguage,\n  1466→\tusers\n  1467→}: {\n  1468→\topen: boolean;\n  1469→\tonClose: () => void;\n  1470→\tuserId: string;\n  1471→\tonSave: () => void;\n  1472→\tlanguage: Language;\n  1473→\tusers?: UserModel[];\n  1474→}) {\n  1475→\tconst [selectedUser, setSelectedUser] = useState(userId);\n  1476→\tconst [clockIn, setClockIn] = useState(\"\");\n  1477→\tconst [clockOut, setClockOut] = useState(\"\");\n  1478→\tconst [location, setLocation] = useState(\"\");\n  1479→\tconst [workDescription, setWorkDescription] = useState(\"\");\n  1480→\tconst [lunchStart, setLunchStart] = useState(\"\");\n  1481→\tconst [lunchEnd, setLunchEnd] = useState(\"\");\n  1482→\n  1483→\tconst t = translations[language];\n  1484→\n  1485→\tuseEffect(() => {\n  1486→\t\tif (open) {\n  1487→\t\t\tsetSelectedUser(userId);\n  1488→\t\t\t// Set default to today\n  1489→\t\t\tconst now = new Date();\n  1490→\t\t\tconst today = now.toISOString().slice(0, 10);\n  1491→\t\t\tsetClockIn(`${today}T09:00`);\n  1492→\t\t\tsetClockOut(`${today}T17:00`);\n  1493→\t\t\tsetLocation(\"\");\n  1494→\t\t\tsetWorkDescription(\"\");\n  1495→\t\t\tsetLunchStart(`${today}T12:00`);\n  1496→\t\t\tsetLunchEnd(`${today}T13:00`);\n  1497→\t\t}\n  1498→\t}, [open, userId]);\n  1499→\n  1500→\tconst handleSave = async () => {\n  1501→\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n  1502→\n  1503→\t\tconst clockInTimestamp = Math.floor(new Date(clockIn).getTime() / 1000).toString();\n  1504→\t\tconst clockOutTimestamp = clockOut ? Math.floor(new Date(clockOut).getTime() / 1000).toString() : null;\n  1505→\t\tconst lunchStartTimestamp = lunchStart ? Math.floor(new Date(lunchStart).getTime() / 1000).toString() : null;\n  1506→\t\tconst lunchEndTimestamp = lunchEnd ? Math.floor(new Date(lunchEnd).getTime() / 1000).toString() : null;\n  1507→\n  1508→\t\tlet totalHours = null;\n  1509→\t\tlet lunchDurationMinutes = null;\n  1510→\n  1511→\t\t// Calculate lunch duration\n  1512→\t\tif (lunchStartTimestamp && lunchEndTimestamp) {\n  1513→\t\t\tconst lunchStartTime = parseInt(lunchStartTimestamp);\n  1514→\t\t\tconst lunchEndTime = parseInt(lunchEndTimestamp);\n  1515→\t\t\tlunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;\n  1516→\t\t}\n  1517→\n  1518→\t\t// Calculate total hours\n  1519→\t\tif (clockOutTimestamp) {\n  1520→\t\t\tconst clockInTime = parseInt(clockInTimestamp);\n  1521→\t\t\tconst clockOutTime = parseInt(clockOutTimestamp);\n  1522→\t\t\ttotalHours = (clockOutTime - clockInTime) / 3600;\n  1523→\n  1524→\t\t\t// Deduct lunch time\n  1525→\t\t\tif (lunchDurationMinutes) {\n  1526→\t\t\t\ttotalHours -= lunchDurationMinutes / 60;\n  1527→\t\t\t}\n  1528→\t\t}\n  1529→\n  1530→\t\tawait timeCardORM.insertTimeCardEntry([{\n  1531→\t\t\tuser_id: selectedUser,\n  1532→\t\t\tclock_in_timestamp: clockInTimestamp,\n  1533→\t\t\tclock_out_timestamp: clockOutTimestamp,\n  1534→\t\t\ttotal_hours: totalHours,\n  1535→\t\t\tlocation: location || null,\n  1536→\t\t\twork_description: workDescription || null,\n  1537→\t\t\tlunch_start_timestamp: lunchStartTimestamp,\n  1538→\t\t\tlunch_end_timestamp: lunchEndTimestamp,\n  1539→\t\t\tlunch_duration_minutes: lunchDurationMinutes,\n  1540→\t\t} as TimeCardEntryModel]);\n  1541→\n  1542→\t\tonSave();\n  1543→\t\tonClose();\n  1544→\t};\n  1545→\n  1546→\treturn (\n  1547→\t\t<Dialog open={open} onOpenChange={onClose}>\n  1548→\t\t\t<DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n  1549→\t\t\t\t<DialogHeader>\n  1550→\t\t\t\t\t<DialogTitle>{t.addManualEntry}</DialogTitle>\n  1551→\t\t\t\t</DialogHeader>\n  1552→\t\t\t\t<div className=\"space-y-4\">\n  1553→\t\t\t\t\t{users && (\n  1554→\t\t\t\t\t\t<div>\n  1555→\t\t\t\t\t\t\t<Label>{t.employeeName}</Label>\n  1556→\t\t\t\t\t\t\t<Select value={selectedUser} onValueChange={setSelectedUser}>\n  1557→\t\t\t\t\t\t\t\t<SelectTrigger>\n  1558→\t\t\t\t\t\t\t\t\t<SelectValue />\n  1559→\t\t\t\t\t\t\t\t</SelectTrigger>\n  1560→\t\t\t\t\t\t\t\t<SelectContent>\n  1561→\t\t\t\t\t\t\t\t\t{users.filter(u => u.role === UserRole.Employee).map((u) => (\n  1562→\t\t\t\t\t\t\t\t\t\t<SelectItem key={u.id} value={u.id}>\n  1563→\t\t\t\t\t\t\t\t\t\t\t{u.name}\n  1564→\t\t\t\t\t\t\t\t\t\t</SelectItem>\n  1565→\t\t\t\t\t\t\t\t\t))}\n  1566→\t\t\t\t\t\t\t\t</SelectContent>\n  1567→\t\t\t\t\t\t\t</Select>\n  1568→\t\t\t\t\t\t</div>\n  1569→\t\t\t\t\t)}\n  1570→\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n  1571→\t\t\t\t\t\t<div>\n  1572→\t\t\t\t\t\t\t<Label>{t.clockInTime}</Label>\n  1573→\t\t\t\t\t\t\t<Input\n  1574→\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1575→\t\t\t\t\t\t\t\tvalue={clockIn}\n  1576→\t\t\t\t\t\t\t\tonChange={(e) => setClockIn(e.target.value)}\n  1577→\t\t\t\t\t\t\t/>\n  1578→\t\t\t\t\t\t</div>\n  1579→\t\t\t\t\t\t<div>\n  1580→\t\t\t\t\t\t\t<Label>{t.clockOutTime}</Label>\n  1581→\t\t\t\t\t\t\t<Input\n  1582→\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1583→\t\t\t\t\t\t\t\tvalue={clockOut}\n  1584→\t\t\t\t\t\t\t\tonChange={(e) => setClockOut(e.target.value)}\n  1585→\t\t\t\t\t\t\t/>\n  1586→\t\t\t\t\t\t</div>\n  1587→\t\t\t\t\t</div>\n  1588→\t\t\t\t\t<div>\n  1589→\t\t\t\t\t\t<Label>{t.location}</Label>\n  1590→\t\t\t\t\t\t<Input\n  1591→\t\t\t\t\t\t\tvalue={location}\n  1592→\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n  1593→\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n  1594→\t\t\t\t\t\t/>\n  1595→\t\t\t\t\t</div>\n  1596→\t\t\t\t\t<div>\n  1597→\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n  1598→\t\t\t\t\t\t<Textarea\n  1599→\t\t\t\t\t\t\tvalue={workDescription}\n  1600→\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n  1601→\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n  1602→\t\t\t\t\t\t\trows={4}\n  1603→\t\t\t\t\t\t/>\n  1604→\t\t\t\t\t</div>\n  1605→\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n  1606→\t\t\t\t\t\t<div>\n  1607→\t\t\t\t\t\t\t<Label>{t.lunchStartTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>\n  1608→\t\t\t\t\t\t\t<Input\n  1609→\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1610→\t\t\t\t\t\t\t\tvalue={lunchStart}\n  1611→\t\t\t\t\t\t\t\tonChange={(e) => setLunchStart(e.target.value)}\n  1612→\t\t\t\t\t\t\t/>\n  1613→\t\t\t\t\t\t</div>\n  1614→\t\t\t\t\t\t<div>\n  1615→\t\t\t\t\t\t\t<Label>{t.lunchEndTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>\n  1616→\t\t\t\t\t\t\t<Input\n  1617→\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n  1618→\t\t\t\t\t\t\t\tvalue={lunchEnd}\n  1619→\t\t\t\t\t\t\t\tonChange={(e) => setLunchEnd(e.target.value)}\n  1620→\t\t\t\t\t\t\t/>\n  1621→\t\t\t\t\t\t</div>\n  1622→\t\t\t\t\t</div>\n  1623→\t\t\t\t</div>\n  1624→\t\t\t\t<DialogFooter>\n  1625→\t\t\t\t\t<Button variant=\"outline\" onClick={onClose}>\n  1626→\t\t\t\t\t\t{t.cancel}\n  1627→\t\t\t\t\t</Button>\n  1628→\t\t\t\t\t<Button onClick={handleSave} disabled={!selectedUser || !clockIn}>\n  1629→\t\t\t\t\t\t{t.saveChanges}\n  1630→\t\t\t\t\t</Button>\n  1631→\t\t\t\t</DialogFooter>\n  1632→\t\t\t</DialogContent>\n  1633→\t\t</Dialog>\n  1634→\t);\n  1635→}\n  1636→"}]},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"8d536d54-6064-424f-949f-9b794f042ff6","tool_use_result":{"type":"update","filePath":"/home/user/vite-template/src/routes/index.tsx","content":"import { createFileRoute } from \"@tanstack/react-router\";\nimport { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Clock, Users, CalendarDays, Timer, Languages, Coffee, UserPlus, FileText, AlertCircle, Plus } from \"lucide-react\";\nimport { UserORM, type UserModel, UserRole } from \"@/sdk/database/orm/orm_user\";\nimport { TimeCardEntryORM, type TimeCardEntryModel } from \"@/sdk/database/orm/orm_time_card_entry\";\n\nexport const Route = createFileRoute(\"/\")({\n\tcomponent: App,\n});\n\ntype Language = 'en' | 'es';\n\nconst translations = {\n\ten: {\n\t\tappTitle: \"Employee Time Tracking\",\n\t\tselectAccount: \"Select your account to continue\",\n\t\tselectUser: \"Select User\",\n\t\tchooseAccount: \"Choose your account\",\n\t\tmanager: \"Manager\",\n\t\temployee: \"Employee\",\n\t\tswitchUser: \"Switch User\",\n\t\ttimeTrackingSystem: \"Time Tracking System\",\n\t\twelcome: \"Welcome\",\n\t\tclockInOut: \"Clock In/Out\",\n\t\tcurrentlyClocked: \"Currently Clocked In\",\n\t\tsince: \"Since\",\n\t\telapsedTime: \"Elapsed Time\",\n\t\tclockOut: \"Clock Out\",\n\t\tnotClocked: \"Not currently clocked in\",\n\t\tclockIn: \"Clock In\",\n\t\ttimeCardHistory: \"Time Card History\",\n\t\trecentRecords: \"Your recent clock in/out records\",\n\t\tnoTimeCards: \"No time cards yet\",\n\t\tclockInTime: \"Clock In\",\n\t\tclockOutTime: \"Clock Out\",\n\t\thours: \"Hours\",\n\t\tstatus: \"Status\",\n\t\tcompleted: \"Completed\",\n\t\tactive: \"Active\",\n\t\ttotalEmployees: \"Total Employees\",\n\t\thoursToday: \"Hours Today\",\n\t\thoursThisWeek: \"Hours This Week\",\n\t\tallEmployeeTimeCards: \"All Employee Time Cards\",\n\t\tviewManageRecords: \"View and manage all employee time records\",\n\t\tfilterByEmployee: \"Filter by Employee\",\n\t\tallEmployees: \"All Employees\",\n\t\tfilterByDate: \"Filter by Date\",\n\t\tclearFilters: \"Clear Filters\",\n\t\tnoTimeCardsFound: \"No time cards found\",\n\t\temployeeName: \"Employee\",\n\t\tactions: \"Actions\",\n\t\tedit: \"Edit\",\n\t\teditTimeCard: \"Edit Time Card\",\n\t\tcancel: \"Cancel\",\n\t\tsaveChanges: \"Save Changes\",\n\t\tlocation: \"Location\",\n\t\twhereWorked: \"Where did you work?\",\n\t\tworkDescription: \"Work Description\",\n\t\twhatDid: \"What did you do today?\",\n\t\tlocationPlaceholder: \"e.g., Office, Remote, Client Site\",\n\t\tdescriptionPlaceholder: \"Describe your work activities...\",\n\t\tstartLunch: \"Start Lunch Break\",\n\t\tendLunch: \"End Lunch Break\",\n\t\tonLunchBreak: \"On Lunch Break\",\n\t\tlunchBreak: \"Lunch Break\",\n\t\tlunchDuration: \"Lunch\",\n\t\tlunchStartTime: \"Lunch Start\",\n\t\tlunchEndTime: \"Lunch End\",\n\t\ttimeCards: \"Time Cards\",\n\t\treports: \"Reports\",\n\t\temployees: \"Employees\",\n\t\taddEmployee: \"Add Employee\",\n\t\teditEmployee: \"Edit Employee\",\n\t\tdeleteEmployee: \"Delete Employee\",\n\t\tname: \"Name\",\n\t\temail: \"Email\",\n\t\trole: \"Role\",\n\t\tdelete: \"Delete\",\n\t\tweeklyReport: \"Weekly Report\",\n\t\tselectWeek: \"Select Week\",\n\t\tregularHours: \"Regular\",\n\t\tovertimeHours: \"Overtime\",\n\t\ttotalHours: \"Total\",\n\t\tnoReportData: \"No data for selected week\",\n\t\taddTimeCard: \"Add Time Card\",\n\t\tmanualEntry: \"Manual Entry\",\n\t\taddManualEntry: \"Add Manual Time Card\",\n\t\tconfirmDelete: \"Are you sure you want to delete this employee?\",\n\t\tovertimeAlert: \"Overtime Alert\",\n\t},\n\tes: {\n\t\tappTitle: \"Registro de Tiempo de Empleados\",\n\t\tselectAccount: \"Selecciona tu cuenta para continuar\",\n\t\tselectUser: \"Seleccionar Usuario\",\n\t\tchooseAccount: \"Elige tu cuenta\",\n\t\tmanager: \"Gerente\",\n\t\temployee: \"Empleado\",\n\t\tswitchUser: \"Cambiar Usuario\",\n\t\ttimeTrackingSystem: \"Sistema de Registro de Tiempo\",\n\t\twelcome: \"Bienvenido\",\n\t\tclockInOut: \"Entrada/Salida\",\n\t\tcurrentlyClocked: \"Actualmente Registrado\",\n\t\tsince: \"Desde\",\n\t\telapsedTime: \"Tiempo Transcurrido\",\n\t\tclockOut: \"Registrar Salida\",\n\t\tnotClocked: \"No está registrado actualmente\",\n\t\tclockIn: \"Registrar Entrada\",\n\t\ttimeCardHistory: \"Historial de Tarjetas de Tiempo\",\n\t\trecentRecords: \"Tus registros recientes de entrada/salida\",\n\t\tnoTimeCards: \"No hay tarjetas de tiempo todavía\",\n\t\tclockInTime: \"Entrada\",\n\t\tclockOutTime: \"Salida\",\n\t\thours: \"Horas\",\n\t\tstatus: \"Estado\",\n\t\tcompleted: \"Completado\",\n\t\tactive: \"Activo\",\n\t\ttotalEmployees: \"Total de Empleados\",\n\t\thoursToday: \"Horas Hoy\",\n\t\thoursThisWeek: \"Horas Esta Semana\",\n\t\tallEmployeeTimeCards: \"Todas las Tarjetas de Tiempo\",\n\t\tviewManageRecords: \"Ver y gestionar todos los registros de empleados\",\n\t\tfilterByEmployee: \"Filtrar por Empleado\",\n\t\tallEmployees: \"Todos los Empleados\",\n\t\tfilterByDate: \"Filtrar por Fecha\",\n\t\tclearFilters: \"Limpiar Filtros\",\n\t\tnoTimeCardsFound: \"No se encontraron tarjetas de tiempo\",\n\t\temployeeName: \"Empleado\",\n\t\tactions: \"Acciones\",\n\t\tedit: \"Editar\",\n\t\teditTimeCard: \"Editar Tarjeta de Tiempo\",\n\t\tcancel: \"Cancelar\",\n\t\tsaveChanges: \"Guardar Cambios\",\n\t\tlocation: \"Ubicación\",\n\t\twhereWorked: \"¿Dónde trabajaste?\",\n\t\tworkDescription: \"Descripción del Trabajo\",\n\t\twhatDid: \"¿Qué hiciste hoy?\",\n\t\tlocationPlaceholder: \"ej., Oficina, Remoto, Sitio del Cliente\",\n\t\tdescriptionPlaceholder: \"Describe tus actividades laborales...\",\n\t\tstartLunch: \"Iniciar Almuerzo\",\n\t\tendLunch: \"Terminar Almuerzo\",\n\t\tonLunchBreak: \"En Almuerzo\",\n\t\tlunchBreak: \"Almuerzo\",\n\t\tlunchDuration: \"Almuerzo\",\n\t\tlunchStartTime: \"Inicio Almuerzo\",\n\t\tlunchEndTime: \"Fin Almuerzo\",\n\t\ttimeCards: \"Tarjetas de Tiempo\",\n\t\treports: \"Informes\",\n\t\temployees: \"Empleados\",\n\t\taddEmployee: \"Agregar Empleado\",\n\t\teditEmployee: \"Editar Empleado\",\n\t\tdeleteEmployee: \"Eliminar Empleado\",\n\t\tname: \"Nombre\",\n\t\temail: \"Correo\",\n\t\trole: \"Rol\",\n\t\tdelete: \"Eliminar\",\n\t\tweeklyReport: \"Informe Semanal\",\n\t\tselectWeek: \"Seleccionar Semana\",\n\t\tregularHours: \"Regular\",\n\t\tovertimeHours: \"Tiempo Extra\",\n\t\ttotalHours: \"Total\",\n\t\tnoReportData: \"No hay datos para la semana seleccionada\",\n\t\taddTimeCard: \"Agregar Tarjeta\",\n\t\tmanualEntry: \"Entrada Manual\",\n\t\taddManualEntry: \"Agregar Tarjeta Manual\",\n\t\tconfirmDelete: \"¿Está seguro de eliminar este empleado?\",\n\t\tovertimeAlert: \"Alerta de Tiempo Extra\",\n\t}\n};\n\nfunction App() {\n\tconst [currentUser, setCurrentUser] = useState<UserModel | null>(null);\n\tconst [users, setUsers] = useState<UserModel[]>([]);\n\tconst [showUserSelect, setShowUserSelect] = useState(true);\n\tconst [language, setLanguage] = useState<Language>('en');\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadUsers();\n\t}, []);\n\n\tconst loadUsers = async () => {\n\t\tconst userORM = UserORM.getInstance();\n\t\tconst allUsers = await userORM.getAllUser();\n\n\t\t// If no users exist, create demo users\n\t\tif (allUsers.length === 0) {\n\t\t\tconst demoUsers = await userORM.insertUser([\n\t\t\t\t{\n\t\t\t\t\tname: \"John Smith\",\n\t\t\t\t\temail: \"john@example.com\",\n\t\t\t\t\trole: UserRole.Employee,\n\t\t\t\t} as UserModel,\n\t\t\t\t{\n\t\t\t\t\tname: \"Sarah Johnson\",\n\t\t\t\t\temail: \"sarah@example.com\",\n\t\t\t\t\trole: UserRole.Employee,\n\t\t\t\t} as UserModel,\n\t\t\t\t{\n\t\t\t\t\tname: \"Mike Manager\",\n\t\t\t\t\temail: \"mike@example.com\",\n\t\t\t\t\trole: UserRole.Manager,\n\t\t\t\t} as UserModel,\n\t\t\t]);\n\t\t\tsetUsers(demoUsers);\n\t\t} else {\n\t\t\tsetUsers(allUsers);\n\t\t}\n\t};\n\n\tconst handleUserSelect = (userId: string) => {\n\t\tconst user = users.find(u => u.id === userId);\n\t\tif (user) {\n\t\t\tsetCurrentUser(user);\n\t\t\tsetShowUserSelect(false);\n\t\t}\n\t};\n\n\tconst handleLogout = () => {\n\t\tsetCurrentUser(null);\n\t\tsetShowUserSelect(true);\n\t};\n\n\tconst toggleLanguage = () => {\n\t\tsetLanguage(prev => prev === 'en' ? 'es' : 'en');\n\t};\n\n\tif (showUserSelect || !currentUser) {\n\t\treturn (\n\t\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4\">\n\t\t\t\t<div className=\"absolute top-4 right-4\">\n\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t\t<Card className=\"w-full max-w-md\">\n\t\t\t\t\t<CardHeader>\n\t\t\t\t\t\t<CardTitle className=\"text-2xl\">{t.appTitle}</CardTitle>\n\t\t\t\t\t\t<CardDescription>{t.selectAccount}</CardDescription>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<Label>{t.selectUser}</Label>\n\t\t\t\t\t\t\t<Select onValueChange={handleUserSelect}>\n\t\t\t\t\t\t\t\t<SelectTrigger className=\"w-full\">\n\t\t\t\t\t\t\t\t\t<SelectValue placeholder={t.chooseAccount} />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t{users.map((user) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={user.id} value={user.id}>\n\t\t\t\t\t\t\t\t\t\t\t{user.name} - {user.role === UserRole.Manager ? t.manager : t.employee}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800\">\n\t\t\t<div className=\"container mx-auto p-6 space-y-6\">\n\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h1 className=\"text-3xl font-bold\">{t.timeTrackingSystem}</h1>\n\t\t\t\t\t\t<p className=\"text-muted-foreground\">\n\t\t\t\t\t\t\t{t.welcome}, {currentUser.name} ({currentUser.role === UserRole.Manager ? t.manager : t.employee})\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleLogout} variant=\"outline\">\n\t\t\t\t\t\t\t{t.switchUser}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{currentUser.role === UserRole.Employee ? (\n\t\t\t\t\t<EmployeeView user={currentUser} language={language} />\n\t\t\t\t) : (\n\t\t\t\t\t<ManagerView user={currentUser} users={users} language={language} onUsersChange={loadUsers} />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction EmployeeView({ user, language }: { user: UserModel; language: Language }) {\n\tconst [activeShift, setActiveShift] = useState<TimeCardEntryModel | null>(null);\n\tconst [timeCards, setTimeCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [elapsedTime, setElapsedTime] = useState(0);\n\tconst [location, setLocation] = useState(\"\");\n\tconst [workDescription, setWorkDescription] = useState(\"\");\n\tconst [isOnLunch, setIsOnLunch] = useState(false);\n\tconst [showManualEntry, setShowManualEntry] = useState(false);\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadTimeCards();\n\t}, [user.id]);\n\n\tuseEffect(() => {\n\t\tlet interval: NodeJS.Timeout;\n\t\tif (activeShift && !isOnLunch) {\n\t\t\tinterval = setInterval(() => {\n\t\t\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp) * 1000;\n\t\t\t\tconst elapsed = Date.now() - clockInTime;\n\t\t\t\tsetElapsedTime(elapsed);\n\t\t\t}, 1000);\n\t\t}\n\t\treturn () => clearInterval(interval);\n\t}, [activeShift, isOnLunch]);\n\n\tconst loadTimeCards = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst userTimeCards = await timeCardORM.getTimeCardEntryByUserId(user.id);\n\n\t\t// Sort by clock in time (newest first)\n\t\tconst sorted = userTimeCards.sort((a, b) =>\n\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n\t\t);\n\n\t\tsetTimeCards(sorted);\n\n\t\t// Find active shift (no clock out time)\n\t\tconst active = sorted.find(tc => !tc.clock_out_timestamp);\n\t\tsetActiveShift(active || null);\n\t\tif (active) {\n\t\t\tsetLocation(active.location || \"\");\n\t\t\tsetWorkDescription(active.work_description || \"\");\n\t\t\t// Check if on lunch break\n\t\t\tsetIsOnLunch(!!(active.lunch_start_timestamp && !active.lunch_end_timestamp));\n\t\t} else {\n\t\t\tsetIsOnLunch(false);\n\t\t}\n\t};\n\n\tconst handleClockIn = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tawait timeCardORM.insertTimeCardEntry([{\n\t\t\tuser_id: user.id,\n\t\t\tclock_in_timestamp: now,\n\t\t\tlocation: location || null,\n\t\t\twork_description: workDescription || null,\n\t\t} as TimeCardEntryModel]);\n\n\t\tsetLocation(\"\");\n\t\tsetWorkDescription(\"\");\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleClockOut = async () => {\n\t\tif (!activeShift) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp);\n\t\tconst clockOutTime = parseInt(now);\n\t\tlet totalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t// Deduct lunch time if lunch was taken\n\t\tif (activeShift.lunch_duration_minutes) {\n\t\t\ttotalHours -= activeShift.lunch_duration_minutes / 60;\n\t\t}\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tclock_out_timestamp: now,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: location || activeShift.location,\n\t\t\twork_description: workDescription || activeShift.work_description,\n\t\t});\n\n\t\tsetLocation(\"\");\n\t\tsetWorkDescription(\"\");\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleStartLunch = async () => {\n\t\tif (!activeShift) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tlunch_start_timestamp: now,\n\t\t\tlocation: location || activeShift.location,\n\t\t\twork_description: workDescription || activeShift.work_description,\n\t\t});\n\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleEndLunch = async () => {\n\t\tif (!activeShift || !activeShift.lunch_start_timestamp) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tconst lunchStartTime = parseInt(activeShift.lunch_start_timestamp);\n\t\tconst lunchEndTime = parseInt(now);\n\t\tconst lunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;\n\n\t\t// Add to existing lunch duration if there was already one\n\t\tconst totalLunchMinutes = (activeShift.lunch_duration_minutes || 0) + lunchDurationMinutes;\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tlunch_end_timestamp: now,\n\t\t\tlunch_duration_minutes: totalLunchMinutes,\n\t\t});\n\n\t\tawait loadTimeCards();\n\t};\n\n\tconst formatTime = (ms: number) => {\n\t\tconst seconds = Math.floor(ms / 1000);\n\t\tconst hours = Math.floor(seconds / 3600);\n\t\tconst minutes = Math.floor((seconds % 3600) / 60);\n\t\tconst secs = seconds % 60;\n\t\treturn `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n\t};\n\n\tconst formatDate = (timestamp: string) => {\n\t\tconst date = new Date(parseInt(timestamp) * 1000);\n\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n\t};\n\n\tconst formatHours = (hours: number | null | undefined) => {\n\t\tif (hours === null || hours === undefined) return \"—\";\n\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n\t};\n\n\tconst formatMinutes = (minutes: number | null | undefined) => {\n\t\tif (minutes === null || minutes === undefined) return \"—\";\n\t\treturn `${Math.round(minutes)} min`;\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t<Clock className=\"w-5 h-5\" />\n\t\t\t\t\t\t\t{t.clockInOut}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t\t<Button onClick={() => setShowManualEntry(true)} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t\t<Plus className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{t.addTimeCard}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t{activeShift ? (\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t{isOnLunch ? (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-orange-800 dark:text-orange-200\">{t.onLunchBreak}</p>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-orange-600 dark:text-orange-300\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.since} {activeShift.lunch_start_timestamp && formatDate(activeShift.lunch_start_timestamp)}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-green-800 dark:text-green-200\">{t.currentlyClocked}</p>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300\">\n\t\t\t\t\t\t\t\t\t\t\t{t.since} {formatDate(activeShift.clock_in_timestamp)}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t{activeShift.location && (\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.location}: {activeShift.location}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t{activeShift.lunch_duration_minutes && activeShift.lunch_duration_minutes > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.lunchBreak}: {formatMinutes(activeShift.lunch_duration_minutes)}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-mono font-bold text-green-800 dark:text-green-200\">\n\t\t\t\t\t\t\t\t\t\t\t{formatTime(elapsedTime)}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-green-600 dark:text-green-300\">{t.elapsedTime}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{!isOnLunch && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-2\">\n\t\t\t\t\t\t\t\t{isOnLunch ? (\n\t\t\t\t\t\t\t\t\t<Button onClick={handleEndLunch} variant=\"default\" className=\"col-span-2\">\n\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t\t\t\t{t.endLunch}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={handleStartLunch} variant=\"outline\">\n\t\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t\t\t\t\t{t.startLunch}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={handleClockOut} variant=\"destructive\">\n\t\t\t\t\t\t\t\t\t\t\t{t.clockOut}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center\">\n\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground\">{t.notClocked}</p>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<Label>{t.whereWorked}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<Label>{t.whatDid}</Label>\n\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Button onClick={handleClockIn} className=\"w-full\">\n\t\t\t\t\t\t\t\t{t.clockIn}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<CalendarDays className=\"w-5 h-5\" />\n\t\t\t\t\t\t{t.timeCardHistory}\n\t\t\t\t\t</CardTitle>\n\t\t\t\t\t<CardDescription>{t.recentRecords}</CardDescription>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent>\n\t\t\t\t\t{timeCards.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCards}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{timeCards.map((tc) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<ManualEntryDialog\n\t\t\t\topen={showManualEntry}\n\t\t\t\tonClose={() => setShowManualEntry(false)}\n\t\t\t\tuserId={user.id}\n\t\t\t\tonSave={loadTimeCards}\n\t\t\t\tlanguage={language}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nfunction ManagerView({ user, users, language, onUsersChange }: { user: UserModel; users: UserModel[]; language: Language; onUsersChange: () => void }) {\n\tconst [activeTab, setActiveTab] = useState(\"timecards\");\n\n\tconst t = translations[language];\n\n\treturn (\n\t\t<Tabs value={activeTab} onValueChange={setActiveTab}>\n\t\t\t<TabsList className=\"grid w-full grid-cols-3\">\n\t\t\t\t<TabsTrigger value=\"timecards\">\n\t\t\t\t\t<Clock className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t{t.timeCards}\n\t\t\t\t</TabsTrigger>\n\t\t\t\t<TabsTrigger value=\"reports\">\n\t\t\t\t\t<FileText className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t{t.reports}\n\t\t\t\t</TabsTrigger>\n\t\t\t\t<TabsTrigger value=\"employees\">\n\t\t\t\t\t<Users className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t{t.employees}\n\t\t\t\t</TabsTrigger>\n\t\t\t</TabsList>\n\n\t\t\t<TabsContent value=\"timecards\" className=\"space-y-4\">\n\t\t\t\t<TimeCardsTab users={users} language={language} />\n\t\t\t</TabsContent>\n\n\t\t\t<TabsContent value=\"reports\" className=\"space-y-4\">\n\t\t\t\t<ReportsTab users={users} language={language} />\n\t\t\t</TabsContent>\n\n\t\t\t<TabsContent value=\"employees\" className=\"space-y-4\">\n\t\t\t\t<EmployeesTab users={users} language={language} onUsersChange={onUsersChange} />\n\t\t\t</TabsContent>\n\t\t</Tabs>\n\t);\n}\n\nfunction TimeCardsTab({ users, language }: { users: UserModel[]; language: Language }) {\n\tconst [allTimeCards, setAllTimeCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [filteredCards, setFilteredCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [selectedEmployee, setSelectedEmployee] = useState<string>(\"all\");\n\tconst [dateFilter, setDateFilter] = useState<string>(\"\");\n\tconst [editingCard, setEditingCard] = useState<TimeCardEntryModel | null>(null);\n\tconst [editClockIn, setEditClockIn] = useState(\"\");\n\tconst [editClockOut, setEditClockOut] = useState(\"\");\n\tconst [editLocation, setEditLocation] = useState(\"\");\n\tconst [editWorkDescription, setEditWorkDescription] = useState(\"\");\n\tconst [editLunchStart, setEditLunchStart] = useState(\"\");\n\tconst [editLunchEnd, setEditLunchEnd] = useState(\"\");\n\tconst [showManualEntry, setShowManualEntry] = useState(false);\n\tconst [manualEntryUserId, setManualEntryUserId] = useState<string>(\"\");\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadAllTimeCards();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tapplyFilters();\n\t}, [allTimeCards, selectedEmployee, dateFilter]);\n\n\tconst loadAllTimeCards = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst allCards = await timeCardORM.getAllTimeCardEntry();\n\n\t\t// Sort by clock in time (newest first)\n\t\tconst sorted = allCards.sort((a, b) =>\n\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n\t\t);\n\n\t\tsetAllTimeCards(sorted);\n\t};\n\n\tconst applyFilters = () => {\n\t\tlet filtered = [...allTimeCards];\n\n\t\t// Filter by employee\n\t\tif (selectedEmployee !== \"all\") {\n\t\t\tfiltered = filtered.filter(tc => tc.user_id === selectedEmployee);\n\t\t}\n\n\t\t// Filter by date\n\t\tif (dateFilter) {\n\t\t\tconst filterDate = new Date(dateFilter);\n\t\t\tconst filterTimestamp = Math.floor(filterDate.getTime() / 1000);\n\t\t\tconst nextDayTimestamp = filterTimestamp + 86400; // +24 hours\n\n\t\t\tfiltered = filtered.filter(tc => {\n\t\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\t\treturn clockIn >= filterTimestamp && clockIn < nextDayTimestamp;\n\t\t\t});\n\t\t}\n\n\t\tsetFilteredCards(filtered);\n\t};\n\n\tconst getUserName = (userId: string) => {\n\t\tconst user = users.find(u => u.id === userId);\n\t\treturn user?.name || \"Unknown\";\n\t};\n\n\tconst formatDate = (timestamp: string) => {\n\t\tconst date = new Date(parseInt(timestamp) * 1000);\n\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n\t};\n\n\tconst formatHours = (hours: number | null | undefined) => {\n\t\tif (hours === null || hours === undefined) return \"—\";\n\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n\t};\n\n\tconst formatMinutes = (minutes: number | null | undefined) => {\n\t\tif (minutes === null || minutes === undefined) return \"—\";\n\t\treturn `${Math.round(minutes)} min`;\n\t};\n\n\tconst calculateTotalHours = (period: 'day' | 'week') => {\n\t\tconst now = Date.now() / 1000;\n\t\tconst periodSeconds = period === 'day' ? 86400 : 604800; // 1 day or 7 days\n\t\tconst startTime = now - periodSeconds;\n\n\t\tconst relevantCards = allTimeCards.filter(tc => {\n\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\treturn clockIn >= startTime && tc.total_hours;\n\t\t});\n\n\t\treturn relevantCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);\n\t};\n\n\tconst handleEditCard = (card: TimeCardEntryModel) => {\n\t\tsetEditingCard(card);\n\t\tsetEditClockIn(new Date(parseInt(card.clock_in_timestamp) * 1000).toISOString().slice(0, 16));\n\t\tsetEditClockOut(\n\t\t\tcard.clock_out_timestamp\n\t\t\t\t? new Date(parseInt(card.clock_out_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t\tsetEditLocation(card.location || \"\");\n\t\tsetEditWorkDescription(card.work_description || \"\");\n\t\tsetEditLunchStart(\n\t\t\tcard.lunch_start_timestamp\n\t\t\t\t? new Date(parseInt(card.lunch_start_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t\tsetEditLunchEnd(\n\t\t\tcard.lunch_end_timestamp\n\t\t\t\t? new Date(parseInt(card.lunch_end_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t};\n\n\tconst handleSaveEdit = async () => {\n\t\tif (!editingCard) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst clockInTimestamp = Math.floor(new Date(editClockIn).getTime() / 1000).toString();\n\t\tconst clockOutTimestamp = editClockOut\n\t\t\t? Math.floor(new Date(editClockOut).getTime() / 1000).toString()\n\t\t\t: null;\n\t\tconst lunchStartTimestamp = editLunchStart\n\t\t\t? Math.floor(new Date(editLunchStart).getTime() / 1000).toString()\n\t\t\t: null;\n\t\tconst lunchEndTimestamp = editLunchEnd\n\t\t\t? Math.floor(new Date(editLunchEnd).getTime() / 1000).toString()\n\t\t\t: null;\n\n\t\tlet totalHours = null;\n\t\tlet lunchDurationMinutes = null;\n\n\t\t// Calculate lunch duration\n\t\tif (lunchStartTimestamp && lunchEndTimestamp) {\n\t\t\tconst lunchStart = parseInt(lunchStartTimestamp);\n\t\t\tconst lunchEnd = parseInt(lunchEndTimestamp);\n\t\t\tlunchDurationMinutes = (lunchEnd - lunchStart) / 60;\n\t\t}\n\n\t\t// Calculate total hours\n\t\tif (clockOutTimestamp) {\n\t\t\tconst clockInTime = parseInt(clockInTimestamp);\n\t\t\tconst clockOutTime = parseInt(clockOutTimestamp);\n\t\t\ttotalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t\t// Deduct lunch time\n\t\t\tif (lunchDurationMinutes) {\n\t\t\t\ttotalHours -= lunchDurationMinutes / 60;\n\t\t\t}\n\t\t}\n\n\t\tawait timeCardORM.setTimeCardEntryById(editingCard.id, {\n\t\t\t...editingCard,\n\t\t\tclock_in_timestamp: clockInTimestamp,\n\t\t\tclock_out_timestamp: clockOutTimestamp,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: editLocation || null,\n\t\t\twork_description: editWorkDescription || null,\n\t\t\tlunch_start_timestamp: lunchStartTimestamp,\n\t\t\tlunch_end_timestamp: lunchEndTimestamp,\n\t\t\tlunch_duration_minutes: lunchDurationMinutes,\n\t\t});\n\n\t\tsetEditingCard(null);\n\t\tawait loadAllTimeCards();\n\t};\n\n\tconst handleAddManualEntry = (userId: string) => {\n\t\tsetManualEntryUserId(userId);\n\t\tsetShowManualEntry(true);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<Users className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.totalEmployees}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{users.filter(u => u.role === UserRole.Employee).length}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<Timer className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.hoursToday}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('day').toFixed(2)}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<CalendarDays className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.hoursThisWeek}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('week').toFixed(2)}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<CardTitle>{t.allEmployeeTimeCards}</CardTitle>\n\t\t\t\t\t\t\t<CardDescription>{t.viewManageRecords}</CardDescription>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button onClick={() => handleAddManualEntry(\"\")} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t\t<Plus className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{t.addTimeCard}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t<div className=\"flex gap-4 flex-wrap\">\n\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n\t\t\t\t\t\t\t<Label>{t.filterByEmployee}</Label>\n\t\t\t\t\t\t\t<Select value={selectedEmployee} onValueChange={setSelectedEmployee}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t<SelectItem value=\"all\">{t.allEmployees}</SelectItem>\n\t\t\t\t\t\t\t\t\t{users.filter(u => u.role === UserRole.Employee).map((u) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={u.id} value={u.id}>\n\t\t\t\t\t\t\t\t\t\t\t{u.name}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n\t\t\t\t\t\t\t<Label>{t.filterByDate}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\t\tvalue={dateFilter}\n\t\t\t\t\t\t\t\tonChange={(e) => setDateFilter(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{(selectedEmployee !== \"all\" || dateFilter) && (\n\t\t\t\t\t\t\t<div className=\"flex items-end\">\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tsetSelectedEmployee(\"all\");\n\t\t\t\t\t\t\t\t\t\tsetDateFilter(\"\");\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{t.clearFilters}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{filteredCards.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCardsFound}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.employeeName}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.actions}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{filteredCards.map((tc) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium whitespace-nowrap\">{getUserName(tc.user_id)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleEditCard(tc)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t.edit}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Dialog open={!!editingCard} onOpenChange={(open) => !open && setEditingCard(null)}>\n\t\t\t\t<DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.editTimeCard}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.employeeName}</Label>\n\t\t\t\t\t\t\t<Input value={editingCard ? getUserName(editingCard.user_id) : \"\"} disabled />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.clockInTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editClockIn}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockIn(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.clockOutTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editClockOut}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockOut(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={editLocation}\n\t\t\t\t\t\t\t\tonChange={(e) => setEditLocation(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\tvalue={editWorkDescription}\n\t\t\t\t\t\t\t\tonChange={(e) => setEditWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\trows={4}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.lunchStartTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editLunchStart}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchStart(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.lunchEndTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editLunchEnd}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchEnd(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setEditingCard(null)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleSaveEdit}>\n\t\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\n\t\t\t<ManualEntryDialog\n\t\t\t\topen={showManualEntry}\n\t\t\t\tonClose={() => setShowManualEntry(false)}\n\t\t\t\tuserId={manualEntryUserId}\n\t\t\t\tonSave={loadAllTimeCards}\n\t\t\t\tlanguage={language}\n\t\t\t\tusers={users}\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nfunction ReportsTab({ users, language }: { users: UserModel[]; language: Language }) {\n\tconst [weekStart, setWeekStart] = useState(\"\");\n\tconst [reportData, setReportData] = useState<{ user: UserModel; regularHours: number; overtimeHours: number; totalHours: number }[]>([]);\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\t// Set default to current week\n\t\tconst today = new Date();\n\t\tconst monday = new Date(today);\n\t\tmonday.setDate(today.getDate() - today.getDay() + 1);\n\t\tsetWeekStart(monday.toISOString().slice(0, 10));\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (weekStart) {\n\t\t\tloadWeeklyReport();\n\t\t}\n\t}, [weekStart, users]);\n\n\tconst loadWeeklyReport = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst allCards = await timeCardORM.getAllTimeCardEntry();\n\n\t\tconst weekStartDate = new Date(weekStart);\n\t\tconst weekStartTimestamp = Math.floor(weekStartDate.getTime() / 1000);\n\t\tconst weekEndTimestamp = weekStartTimestamp + 604800; // 7 days\n\n\t\tconst weekCards = allCards.filter(tc => {\n\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\treturn clockIn >= weekStartTimestamp && clockIn < weekEndTimestamp && tc.total_hours;\n\t\t});\n\n\t\tconst employeeHours = users\n\t\t\t.filter(u => u.role === UserRole.Employee)\n\t\t\t.map(user => {\n\t\t\t\tconst userCards = weekCards.filter(tc => tc.user_id === user.id);\n\t\t\t\tconst totalHours = userCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);\n\t\t\t\tconst regularHours = Math.min(totalHours, 40);\n\t\t\t\tconst overtimeHours = Math.max(totalHours - 40, 0);\n\n\t\t\t\treturn {\n\t\t\t\t\tuser,\n\t\t\t\t\tregularHours,\n\t\t\t\t\tovertimeHours,\n\t\t\t\t\ttotalHours,\n\t\t\t\t};\n\t\t\t});\n\n\t\tsetReportData(employeeHours);\n\t};\n\n\tconst formatHours = (hours: number) => {\n\t\treturn `${hours.toFixed(2)} hrs`;\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-4\">\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<CardTitle>{t.weeklyReport}</CardTitle>\n\t\t\t\t\t<CardDescription>Overtime calculated for hours worked beyond 40 hours/week</CardDescription>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t<div className=\"max-w-xs\">\n\t\t\t\t\t\t<Label>{t.selectWeek}</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\tvalue={weekStart}\n\t\t\t\t\t\t\tonChange={(e) => setWeekStart(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{reportData.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noReportData}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.employeeName}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.regularHours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.overtimeHours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.totalHours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{reportData.map(({ user, regularHours, overtimeHours, totalHours }) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={user.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">{user.name}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{formatHours(regularHours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{overtimeHours > 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-orange-600 font-semibold\">{formatHours(overtimeHours)}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\tformatHours(0)\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-semibold\">{formatHours(totalHours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{overtimeHours > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertCircle className=\"w-3 h-3 mr-1\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{t.overtimeAlert}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\t\t</div>\n\t);\n}\n\nfunction EmployeesTab({ users, language, onUsersChange }: { users: UserModel[]; language: Language; onUsersChange: () => void }) {\n\tconst [showAddEmployee, setShowAddEmployee] = useState(false);\n\tconst [editingEmployee, setEditingEmployee] = useState<UserModel | null>(null);\n\tconst [employeeName, setEmployeeName] = useState(\"\");\n\tconst [employeeEmail, setEmployeeEmail] = useState(\"\");\n\tconst [employeeRole, setEmployeeRole] = useState<UserRole>(UserRole.Employee);\n\tconst [deleteConfirm, setDeleteConfirm] = useState<UserModel | null>(null);\n\n\tconst t = translations[language];\n\n\tconst handleAddEmployee = async () => {\n\t\tconst userORM = UserORM.getInstance();\n\t\tawait userORM.insertUser([{\n\t\t\tname: employeeName,\n\t\t\temail: employeeEmail,\n\t\t\trole: employeeRole,\n\t\t} as UserModel]);\n\n\t\tsetShowAddEmployee(false);\n\t\tsetEmployeeName(\"\");\n\t\tsetEmployeeEmail(\"\");\n\t\tsetEmployeeRole(UserRole.Employee);\n\t\tonUsersChange();\n\t};\n\n\tconst handleEditEmployee = async () => {\n\t\tif (!editingEmployee) return;\n\n\t\tconst userORM = UserORM.getInstance();\n\t\tawait userORM.setUserById(editingEmployee.id, {\n\t\t\t...editingEmployee,\n\t\t\tname: employeeName,\n\t\t\temail: employeeEmail,\n\t\t\trole: employeeRole,\n\t\t});\n\n\t\tsetEditingEmployee(null);\n\t\tsetEmployeeName(\"\");\n\t\tsetEmployeeEmail(\"\");\n\t\tsetEmployeeRole(UserRole.Employee);\n\t\tonUsersChange();\n\t};\n\n\tconst handleDeleteEmployee = async (user: UserModel) => {\n\t\tconst userORM = UserORM.getInstance();\n\t\tawait userORM.deleteUserById(user.id);\n\t\tsetDeleteConfirm(null);\n\t\tonUsersChange();\n\t};\n\n\tconst openEditDialog = (user: UserModel) => {\n\t\tsetEditingEmployee(user);\n\t\tsetEmployeeName(user.name);\n\t\tsetEmployeeEmail(user.email);\n\t\tsetEmployeeRole(user.role);\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-4\">\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<CardTitle>{t.employees}</CardTitle>\n\t\t\t\t\t\t\t<CardDescription>Manage employee accounts</CardDescription>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button onClick={() => setShowAddEmployee(true)}>\n\t\t\t\t\t\t\t<UserPlus className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{t.addEmployee}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent>\n\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.name}</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.email}</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.role}</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead>{t.actions}</TableHead>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t{users.map((user) => (\n\t\t\t\t\t\t\t\t\t<TableRow key={user.id}>\n\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">{user.name}</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell>{user.email}</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<Badge variant={user.role === UserRole.Manager ? \"default\" : \"secondary\"}>\n\t\t\t\t\t\t\t\t\t\t\t\t{user.role === UserRole.Manager ? t.manager : t.employee}\n\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openEditDialog(user)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t.edit}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setDeleteConfirm(user)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t.delete}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t</Table>\n\t\t\t\t\t</div>\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Dialog open={showAddEmployee} onOpenChange={setShowAddEmployee}>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.addEmployee}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.name}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={employeeName}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeName(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder=\"John Doe\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.email}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\t\tvalue={employeeEmail}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeEmail(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder=\"john@example.com\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.role}</Label>\n\t\t\t\t\t\t\t<Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setShowAddEmployee(false)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleAddEmployee} disabled={!employeeName || !employeeEmail}>\n\t\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\n\t\t\t<Dialog open={!!editingEmployee} onOpenChange={(open) => !open && setEditingEmployee(null)}>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.editEmployee}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.name}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={employeeName}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeName(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.email}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\t\tvalue={employeeEmail}\n\t\t\t\t\t\t\t\tonChange={(e) => setEmployeeEmail(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.role}</Label>\n\t\t\t\t\t\t\t<Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>\n\t\t\t\t\t\t\t\t\t<SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setEditingEmployee(null)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleEditEmployee}>\n\t\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\n\t\t\t<Dialog open={!!deleteConfirm} onOpenChange={(open) => !open && setDeleteConfirm(null)}>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.deleteEmployee}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<p>{t.confirmDelete}</p>\n\t\t\t\t\t<p className=\"font-semibold\">{deleteConfirm?.name}</p>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setDeleteConfirm(null)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button variant=\"destructive\" onClick={() => deleteConfirm && handleDeleteEmployee(deleteConfirm)}>\n\t\t\t\t\t\t\t{t.delete}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\t\t</div>\n\t);\n}\n\nfunction ManualEntryDialog({\n\topen,\n\tonClose,\n\tuserId,\n\tonSave,\n\tlanguage,\n\tusers\n}: {\n\topen: boolean;\n\tonClose: () => void;\n\tuserId: string;\n\tonSave: () => void;\n\tlanguage: Language;\n\tusers?: UserModel[];\n}) {\n\tconst [selectedUser, setSelectedUser] = useState(userId);\n\tconst [clockIn, setClockIn] = useState(\"\");\n\tconst [clockOut, setClockOut] = useState(\"\");\n\tconst [location, setLocation] = useState(\"\");\n\tconst [workDescription, setWorkDescription] = useState(\"\");\n\tconst [lunchStart, setLunchStart] = useState(\"\");\n\tconst [lunchEnd, setLunchEnd] = useState(\"\");\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tif (open) {\n\t\t\tsetSelectedUser(userId);\n\t\t\t// Set default to today\n\t\t\tconst now = new Date();\n\t\t\tconst today = now.toISOString().slice(0, 10);\n\t\t\tsetClockIn(`${today}T09:00`);\n\t\t\tsetClockOut(`${today}T17:00`);\n\t\t\tsetLocation(\"\");\n\t\t\tsetWorkDescription(\"\");\n\t\t\tsetLunchStart(`${today}T12:00`);\n\t\t\tsetLunchEnd(`${today}T13:00`);\n\t\t}\n\t}, [open, userId]);\n\n\tconst handleSave = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\n\t\tconst clockInTimestamp = Math.floor(new Date(clockIn).getTime() / 1000).toString();\n\t\tconst clockOutTimestamp = clockOut ? Math.floor(new Date(clockOut).getTime() / 1000).toString() : null;\n\t\tconst lunchStartTimestamp = lunchStart ? Math.floor(new Date(lunchStart).getTime() / 1000).toString() : null;\n\t\tconst lunchEndTimestamp = lunchEnd ? Math.floor(new Date(lunchEnd).getTime() / 1000).toString() : null;\n\n\t\tlet totalHours = null;\n\t\tlet lunchDurationMinutes = null;\n\n\t\t// Calculate lunch duration\n\t\tif (lunchStartTimestamp && lunchEndTimestamp) {\n\t\t\tconst lunchStartTime = parseInt(lunchStartTimestamp);\n\t\t\tconst lunchEndTime = parseInt(lunchEndTimestamp);\n\t\t\tlunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;\n\t\t}\n\n\t\t// Calculate total hours\n\t\tif (clockOutTimestamp) {\n\t\t\tconst clockInTime = parseInt(clockInTimestamp);\n\t\t\tconst clockOutTime = parseInt(clockOutTimestamp);\n\t\t\ttotalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t\t// Deduct lunch time\n\t\t\tif (lunchDurationMinutes) {\n\t\t\t\ttotalHours -= lunchDurationMinutes / 60;\n\t\t\t}\n\t\t}\n\n\t\tawait timeCardORM.insertTimeCardEntry([{\n\t\t\tuser_id: selectedUser,\n\t\t\tclock_in_timestamp: clockInTimestamp,\n\t\t\tclock_out_timestamp: clockOutTimestamp,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: location || null,\n\t\t\twork_description: workDescription || null,\n\t\t\tlunch_start_timestamp: lunchStartTimestamp,\n\t\t\tlunch_end_timestamp: lunchEndTimestamp,\n\t\t\tlunch_duration_minutes: lunchDurationMinutes,\n\t\t} as TimeCardEntryModel]);\n\n\t\tonSave();\n\t\tonClose();\n\t};\n\n\treturn (\n\t\t<Dialog open={open} onOpenChange={onClose}>\n\t\t\t<DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n\t\t\t\t<DialogHeader>\n\t\t\t\t\t<DialogTitle>{t.addManualEntry}</DialogTitle>\n\t\t\t\t</DialogHeader>\n\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t{users && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.employeeName}</Label>\n\t\t\t\t\t\t\t<Select value={selectedUser} onValueChange={setSelectedUser}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t{users.filter(u => u.role === UserRole.Employee).map((u) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={u.id} value={u.id}>\n\t\t\t\t\t\t\t\t\t\t\t{u.name}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.clockInTime}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={clockIn}\n\t\t\t\t\t\t\t\tonChange={(e) => setClockIn(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.clockOutTime}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={clockOut}\n\t\t\t\t\t\t\t\tonChange={(e) => setClockOut(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\trows={4}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.lunchStartTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={lunchStart}\n\t\t\t\t\t\t\t\tonChange={(e) => setLunchStart(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.lunchEndTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\tvalue={lunchEnd}\n\t\t\t\t\t\t\t\tonChange={(e) => setLunchEnd(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<DialogFooter>\n\t\t\t\t\t<Button variant=\"outline\" onClick={onClose}>\n\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button onClick={handleSave} disabled={!selectedUser || !clockIn}>\n\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t</Button>\n\t\t\t\t</DialogFooter>\n\t\t\t</DialogContent>\n\t\t</Dialog>\n\t);\n}\n","structuredPatch":[{"oldStart":9,"oldLines":7,"newStart":9,"newLines":8,"lines":[" import { Textarea } from \"@/components/ui/textarea\";"," import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";"," import { Badge } from \"@/components/ui/badge\";","-import { Clock, Users, CalendarDays, Timer, Languages, Coffee } from \"lucide-react\";","+import { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";","+import { Clock, Users, CalendarDays, Timer, Languages, Coffee, UserPlus, FileText, AlertCircle, Plus } from \"lucide-react\";"," import { UserORM, type UserModel, UserRole } from \"@/sdk/database/orm/orm_user\";"," import { TimeCardEntryORM, type TimeCardEntryModel } from \"@/sdk/database/orm/orm_time_card_entry\";"," "]},{"oldStart":75,"oldLines":6,"newStart":76,"newLines":27,"lines":["     lunchDuration: \"Lunch\",","     lunchStartTime: \"Lunch Start\",","     lunchEndTime: \"Lunch End\",","+    timeCards: \"Time Cards\",","+    reports: \"Reports\",","+    employees: \"Employees\",","+    addEmployee: \"Add Employee\",","+    editEmployee: \"Edit Employee\",","+    deleteEmployee: \"Delete Employee\",","+    name: \"Name\",","+    email: \"Email\",","+    role: \"Role\",","+    delete: \"Delete\",","+    weeklyReport: \"Weekly Report\",","+    selectWeek: \"Select Week\",","+    regularHours: \"Regular\",","+    overtimeHours: \"Overtime\",","+    totalHours: \"Total\",","+    noReportData: \"No data for selected week\",","+    addTimeCard: \"Add Time Card\",","+    manualEntry: \"Manual Entry\",","+    addManualEntry: \"Add Manual Time Card\",","+    confirmDelete: \"Are you sure you want to delete this employee?\",","+    overtimeAlert: \"Overtime Alert\",","   },","   es: {","     appTitle: \"Registro de Tiempo de Empleados\","]},{"oldStart":131,"oldLines":6,"newStart":153,"newLines":27,"lines":["     lunchDuration: \"Almuerzo\",","     lunchStartTime: \"Inicio Almuerzo\",","     lunchEndTime: \"Fin Almuerzo\",","+    timeCards: \"Tarjetas de Tiempo\",","+    reports: \"Informes\",","+    employees: \"Empleados\",","+    addEmployee: \"Agregar Empleado\",","+    editEmployee: \"Editar Empleado\",","+    deleteEmployee: \"Eliminar Empleado\",","+    name: \"Nombre\",","+    email: \"Correo\",","+    role: \"Rol\",","+    delete: \"Eliminar\",","+    weeklyReport: \"Informe Semanal\",","+    selectWeek: \"Seleccionar Semana\",","+    regularHours: \"Regular\",","+    overtimeHours: \"Tiempo Extra\",","+    totalHours: \"Total\",","+    noReportData: \"No hay datos para la semana seleccionada\",","+    addTimeCard: \"Agregar Tarjeta\",","+    manualEntry: \"Entrada Manual\",","+    addManualEntry: \"Agregar Tarjeta Manual\",","+    confirmDelete: \"¿Está seguro de eliminar este empleado?\",","+    overtimeAlert: \"Alerta de Tiempo Extra\",","   }"," };"," "]},{"oldStart":252,"oldLines":7,"newStart":295,"newLines":7,"lines":["         {currentUser.role === UserRole.Employee ? (","           <EmployeeView user={currentUser} language={language} />","         ) : (","-          <ManagerView user={currentUser} users={users} language={language} />","+          <ManagerView user={currentUser} users={users} language={language} onUsersChange={loadUsers} />","         )}","       </div>","     </div>"]},{"oldStart":266,"oldLines":6,"newStart":309,"newLines":7,"lines":["   const [location, setLocation] = useState(\"\");","   const [workDescription, setWorkDescription] = useState(\"\");","   const [isOnLunch, setIsOnLunch] = useState(false);","+  const [showManualEntry, setShowManualEntry] = useState(false);"," ","   const t = translations[language];"," "]},{"oldStart":418,"oldLines":10,"newStart":462,"newLines":16,"lines":["     <div className=\"space-y-6\">","       <Card>","         <CardHeader>","-          <CardTitle className=\"flex items-center gap-2\">","-            <Clock className=\"w-5 h-5\" />","-            {t.clockInOut}","-          </CardTitle>","+          <div className=\"flex justify-between items-center\">","+            <CardTitle className=\"flex items-center gap-2\">","+              <Clock className=\"w-5 h-5\" />","+              {t.clockInOut}","+            </CardTitle>","+            <Button onClick={() => setShowManualEntry(true)} variant=\"outline\" size=\"sm\">","+              <Plus className=\"w-4 h-4 mr-2\" />","+              {t.addTimeCard}","+            </Button>","+          </div>","         </CardHeader>","         <CardContent className=\"space-y-4\">","           {activeShift ? ("]},{"oldStart":593,"oldLines":11,"newStart":643,"newLines":56,"lines":["           )}","         </CardContent>","       </Card>","+","+      <ManualEntryDialog","+        open={showManualEntry}","+        onClose={() => setShowManualEntry(false)}","+        userId={user.id}","+        onSave={loadTimeCards}","+        language={language}","+      />","     </div>","   );"," }"," ","-function ManagerView({ user, users, language }: { user: UserModel; users: UserModel[]; language: Language }) {","+function ManagerView({ user, users, language, onUsersChange }: { user: UserModel; users: UserModel[]; language: Language; onUsersChange: () => void }) {","+  const [activeTab, setActiveTab] = useState(\"timecards\");","+","+  const t = translations[language];","+","+  return (","+    <Tabs value={activeTab} onValueChange={setActiveTab}>","+      <TabsList className=\"grid w-full grid-cols-3\">","+        <TabsTrigger value=\"timecards\">","+          <Clock className=\"w-4 h-4 mr-2\" />","+          {t.timeCards}","+        </TabsTrigger>","+        <TabsTrigger value=\"reports\">","+          <FileText className=\"w-4 h-4 mr-2\" />","+          {t.reports}","+        </TabsTrigger>","+        <TabsTrigger value=\"employees\">","+          <Users className=\"w-4 h-4 mr-2\" />","+          {t.employees}","+        </TabsTrigger>","+      </TabsList>","+","+      <TabsContent value=\"timecards\" className=\"space-y-4\">","+        <TimeCardsTab users={users} language={language} />","+      </TabsContent>","+","+      <TabsContent value=\"reports\" className=\"space-y-4\">","+        <ReportsTab users={users} language={language} />","+      </TabsContent>","+","+      <TabsContent value=\"employees\" className=\"space-y-4\">","+        <EmployeesTab users={users} language={language} onUsersChange={onUsersChange} />","+      </TabsContent>","+    </Tabs>","+  );","+}","+","+function TimeCardsTab({ users, language }: { users: UserModel[]; language: Language }) {","   const [allTimeCards, setAllTimeCards] = useState<TimeCardEntryModel[]>([]);","   const [filteredCards, setFilteredCards] = useState<TimeCardEntryModel[]>([]);","   const [selectedEmployee, setSelectedEmployee] = useState<string>(\"all\");"]},{"oldStart":609,"oldLines":6,"newStart":704,"newLines":8,"lines":["   const [editWorkDescription, setEditWorkDescription] = useState(\"\");","   const [editLunchStart, setEditLunchStart] = useState(\"\");","   const [editLunchEnd, setEditLunchEnd] = useState(\"\");","+  const [showManualEntry, setShowManualEntry] = useState(false);","+  const [manualEntryUserId, setManualEntryUserId] = useState<string>(\"\");"," ","   const t = translations[language];"," "]},{"oldStart":763,"oldLines":8,"newStart":860,"newLines":13,"lines":["     await loadAllTimeCards();","   };"," ","+  const handleAddManualEntry = (userId: string) => {","+    setManualEntryUserId(userId);","+    setShowManualEntry(true);","+  };","+","   return (","-    <div className=\"space-y-6\">","+    <>","       <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">","         <Card>","           <CardHeader className=\"pb-3\">"]},{"oldStart":805,"oldLines":8,"newStart":907,"newLines":16,"lines":[" ","       <Card>","         <CardHeader>","-          <CardTitle>{t.allEmployeeTimeCards}</CardTitle>","-          <CardDescription>{t.viewManageRecords}</CardDescription>","+          <div className=\"flex justify-between items-center\">","+            <div>","+              <CardTitle>{t.allEmployeeTimeCards}</CardTitle>","+              <CardDescription>{t.viewManageRecords}</CardDescription>","+            </div>","+            <Button onClick={() => handleAddManualEntry(\"\")} variant=\"outline\" size=\"sm\">","+              <Plus className=\"w-4 h-4 mr-2\" />","+              {t.addTimeCard}","+            </Button>","+          </div>","         </CardHeader>","         <CardContent className=\"space-y-4\">","           <div className=\"flex gap-4 flex-wrap\">"]},{"oldStart":982,"oldLines":6,"newStart":1092,"newLines":544,"lines":["           </DialogFooter>","         </DialogContent>","       </Dialog>","+","+      <ManualEntryDialog","+        open={showManualEntry}","+        onClose={() => setShowManualEntry(false)}","+        userId={manualEntryUserId}","+        onSave={loadAllTimeCards}","+        language={language}","+        users={users}","+      />","+    </>","+  );","+}","+","+function ReportsTab({ users, language }: { users: UserModel[]; language: Language }) {","+  const [weekStart, setWeekStart] = useState(\"\");","+  const [reportData, setReportData] = useState<{ user: UserModel; regularHours: number; overtimeHours: number; totalHours: number }[]>([]);","+","+  const t = translations[language];","+","+  useEffect(() => {","+    // Set default to current week","+    const today = new Date();","+    const monday = new Date(today);","+    monday.setDate(today.getDate() - today.getDay() + 1);","+    setWeekStart(monday.toISOString().slice(0, 10));","+  }, []);","+","+  useEffect(() => {","+    if (weekStart) {","+      loadWeeklyReport();","+    }","+  }, [weekStart, users]);","+","+  const loadWeeklyReport = async () => {","+    const timeCardORM = TimeCardEntryORM.getInstance();","+    const allCards = await timeCardORM.getAllTimeCardEntry();","+","+    const weekStartDate = new Date(weekStart);","+    const weekStartTimestamp = Math.floor(weekStartDate.getTime() / 1000);","+    const weekEndTimestamp = weekStartTimestamp + 604800; // 7 days","+","+    const weekCards = allCards.filter(tc => {","+      const clockIn = parseInt(tc.clock_in_timestamp);","+      return clockIn >= weekStartTimestamp && clockIn < weekEndTimestamp && tc.total_hours;","+    });","+","+    const employeeHours = users","+      .filter(u => u.role === UserRole.Employee)","+      .map(user => {","+        const userCards = weekCards.filter(tc => tc.user_id === user.id);","+        const totalHours = userCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);","+        const regularHours = Math.min(totalHours, 40);","+        const overtimeHours = Math.max(totalHours - 40, 0);","+","+        return {","+          user,","+          regularHours,","+          overtimeHours,","+          totalHours,","+        };","+      });","+","+    setReportData(employeeHours);","+  };","+","+  const formatHours = (hours: number) => {","+    return `${hours.toFixed(2)} hrs`;","+  };","+","+  return (","+    <div className=\"space-y-4\">","+      <Card>","+        <CardHeader>","+          <CardTitle>{t.weeklyReport}</CardTitle>","+          <CardDescription>Overtime calculated for hours worked beyond 40 hours/week</CardDescription>","+        </CardHeader>","+        <CardContent className=\"space-y-4\">","+          <div className=\"max-w-xs\">","+            <Label>{t.selectWeek}</Label>","+            <Input","+              type=\"date\"","+              value={weekStart}","+              onChange={(e) => setWeekStart(e.target.value)}","+            />","+          </div>","+","+          {reportData.length === 0 ? (","+            <p className=\"text-center text-muted-foreground py-8\">{t.noReportData}</p>","+          ) : (","+            <div className=\"overflow-x-auto\">","+              <Table>","+                <TableHeader>","+                  <TableRow>","+                    <TableHead>{t.employeeName}</TableHead>","+                    <TableHead>{t.regularHours}</TableHead>","+                    <TableHead>{t.overtimeHours}</TableHead>","+                    <TableHead>{t.totalHours}</TableHead>","+                    <TableHead>{t.status}</TableHead>","+                  </TableRow>","+                </TableHeader>","+                <TableBody>","+                  {reportData.map(({ user, regularHours, overtimeHours, totalHours }) => (","+                    <TableRow key={user.id}>","+                      <TableCell className=\"font-medium\">{user.name}</TableCell>","+                      <TableCell>{formatHours(regularHours)}</TableCell>","+                      <TableCell>","+                        {overtimeHours > 0 ? (","+                          <span className=\"text-orange-600 font-semibold\">{formatHours(overtimeHours)}</span>","+                        ) : (","+                          formatHours(0)","+                        )}","+                      </TableCell>","+                      <TableCell className=\"font-semibold\">{formatHours(totalHours)}</TableCell>","+                      <TableCell>","+                        {overtimeHours > 0 && (","+                          <Badge className=\"bg-orange-500\">","+                            <AlertCircle className=\"w-3 h-3 mr-1\" />","+                            {t.overtimeAlert}","+                          </Badge>","+                        )}","+                      </TableCell>","+                    </TableRow>","+                  ))}","+                </TableBody>","+              </Table>","+            </div>","+          )}","+        </CardContent>","+      </Card>","     </div>","   );"," }","+","+function EmployeesTab({ users, language, onUsersChange }: { users: UserModel[]; language: Language; onUsersChange: () => void }) {","+  const [showAddEmployee, setShowAddEmployee] = useState(false);","+  const [editingEmployee, setEditingEmployee] = useState<UserModel | null>(null);","+  const [employeeName, setEmployeeName] = useState(\"\");","+  const [employeeEmail, setEmployeeEmail] = useState(\"\");","+  const [employeeRole, setEmployeeRole] = useState<UserRole>(UserRole.Employee);","+  const [deleteConfirm, setDeleteConfirm] = useState<UserModel | null>(null);","+","+  const t = translations[language];","+","+  const handleAddEmployee = async () => {","+    const userORM = UserORM.getInstance();","+    await userORM.insertUser([{","+      name: employeeName,","+      email: employeeEmail,","+      role: employeeRole,","+    } as UserModel]);","+","+    setShowAddEmployee(false);","+    setEmployeeName(\"\");","+    setEmployeeEmail(\"\");","+    setEmployeeRole(UserRole.Employee);","+    onUsersChange();","+  };","+","+  const handleEditEmployee = async () => {","+    if (!editingEmployee) return;","+","+    const userORM = UserORM.getInstance();","+    await userORM.setUserById(editingEmployee.id, {","+      ...editingEmployee,","+      name: employeeName,","+      email: employeeEmail,","+      role: employeeRole,","+    });","+","+    setEditingEmployee(null);","+    setEmployeeName(\"\");","+    setEmployeeEmail(\"\");","+    setEmployeeRole(UserRole.Employee);","+    onUsersChange();","+  };","+","+  const handleDeleteEmployee = async (user: UserModel) => {","+    const userORM = UserORM.getInstance();","+    await userORM.deleteUserById(user.id);","+    setDeleteConfirm(null);","+    onUsersChange();","+  };","+","+  const openEditDialog = (user: UserModel) => {","+    setEditingEmployee(user);","+    setEmployeeName(user.name);","+    setEmployeeEmail(user.email);","+    setEmployeeRole(user.role);","+  };","+","+  return (","+    <div className=\"space-y-4\">","+      <Card>","+        <CardHeader>","+          <div className=\"flex justify-between items-center\">","+            <div>","+              <CardTitle>{t.employees}</CardTitle>","+              <CardDescription>Manage employee accounts</CardDescription>","+            </div>","+            <Button onClick={() => setShowAddEmployee(true)}>","+              <UserPlus className=\"w-4 h-4 mr-2\" />","+              {t.addEmployee}","+            </Button>","+          </div>","+        </CardHeader>","+        <CardContent>","+          <div className=\"overflow-x-auto\">","+            <Table>","+              <TableHeader>","+                <TableRow>","+                  <TableHead>{t.name}</TableHead>","+                  <TableHead>{t.email}</TableHead>","+                  <TableHead>{t.role}</TableHead>","+                  <TableHead>{t.actions}</TableHead>","+                </TableRow>","+              </TableHeader>","+              <TableBody>","+                {users.map((user) => (","+                  <TableRow key={user.id}>","+                    <TableCell className=\"font-medium\">{user.name}</TableCell>","+                    <TableCell>{user.email}</TableCell>","+                    <TableCell>","+                      <Badge variant={user.role === UserRole.Manager ? \"default\" : \"secondary\"}>","+                        {user.role === UserRole.Manager ? t.manager : t.employee}","+                      </Badge>","+                    </TableCell>","+                    <TableCell>","+                      <div className=\"flex gap-2\">","+                        <Button","+                          variant=\"outline\"","+                          size=\"sm\"","+                          onClick={() => openEditDialog(user)}","+                        >","+                          {t.edit}","+                        </Button>","+                        <Button","+                          variant=\"destructive\"","+                          size=\"sm\"","+                          onClick={() => setDeleteConfirm(user)}","+                        >","+                          {t.delete}","+                        </Button>","+                      </div>","+                    </TableCell>","+                  </TableRow>","+                ))}","+              </TableBody>","+            </Table>","+          </div>","+        </CardContent>","+      </Card>","+","+      <Dialog open={showAddEmployee} onOpenChange={setShowAddEmployee}>","+        <DialogContent>","+          <DialogHeader>","+            <DialogTitle>{t.addEmployee}</DialogTitle>","+          </DialogHeader>","+          <div className=\"space-y-4\">","+            <div>","+              <Label>{t.name}</Label>","+              <Input","+                value={employeeName}","+                onChange={(e) => setEmployeeName(e.target.value)}","+                placeholder=\"John Doe\"","+              />","+            </div>","+            <div>","+              <Label>{t.email}</Label>","+              <Input","+                type=\"email\"","+                value={employeeEmail}","+                onChange={(e) => setEmployeeEmail(e.target.value)}","+                placeholder=\"john@example.com\"","+              />","+            </div>","+            <div>","+              <Label>{t.role}</Label>","+              <Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>","+                <SelectTrigger>","+                  <SelectValue />","+                </SelectTrigger>","+                <SelectContent>","+                  <SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>","+                  <SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>","+                </SelectContent>","+              </Select>","+            </div>","+          </div>","+          <DialogFooter>","+            <Button variant=\"outline\" onClick={() => setShowAddEmployee(false)}>","+              {t.cancel}","+            </Button>","+            <Button onClick={handleAddEmployee} disabled={!employeeName || !employeeEmail}>","+              {t.saveChanges}","+            </Button>","+          </DialogFooter>","+        </DialogContent>","+      </Dialog>","+","+      <Dialog open={!!editingEmployee} onOpenChange={(open) => !open && setEditingEmployee(null)}>","+        <DialogContent>","+          <DialogHeader>","+            <DialogTitle>{t.editEmployee}</DialogTitle>","+          </DialogHeader>","+          <div className=\"space-y-4\">","+            <div>","+              <Label>{t.name}</Label>","+              <Input","+                value={employeeName}","+                onChange={(e) => setEmployeeName(e.target.value)}","+              />","+            </div>","+            <div>","+              <Label>{t.email}</Label>","+              <Input","+                type=\"email\"","+                value={employeeEmail}","+                onChange={(e) => setEmployeeEmail(e.target.value)}","+              />","+            </div>","+            <div>","+              <Label>{t.role}</Label>","+              <Select value={employeeRole.toString()} onValueChange={(v) => setEmployeeRole(parseInt(v))}>","+                <SelectTrigger>","+                  <SelectValue />","+                </SelectTrigger>","+                <SelectContent>","+                  <SelectItem value={UserRole.Employee.toString()}>{t.employee}</SelectItem>","+                  <SelectItem value={UserRole.Manager.toString()}>{t.manager}</SelectItem>","+                </SelectContent>","+              </Select>","+            </div>","+          </div>","+          <DialogFooter>","+            <Button variant=\"outline\" onClick={() => setEditingEmployee(null)}>","+              {t.cancel}","+            </Button>","+            <Button onClick={handleEditEmployee}>","+              {t.saveChanges}","+            </Button>","+          </DialogFooter>","+        </DialogContent>","+      </Dialog>","+","+      <Dialog open={!!deleteConfirm} onOpenChange={(open) => !open && setDeleteConfirm(null)}>","+        <DialogContent>","+          <DialogHeader>","+            <DialogTitle>{t.deleteEmployee}</DialogTitle>","+          </DialogHeader>","+          <p>{t.confirmDelete}</p>","+          <p className=\"font-semibold\">{deleteConfirm?.name}</p>","+          <DialogFooter>","+            <Button variant=\"outline\" onClick={() => setDeleteConfirm(null)}>","+              {t.cancel}","+            </Button>","+            <Button variant=\"destructive\" onClick={() => deleteConfirm && handleDeleteEmployee(deleteConfirm)}>","+              {t.delete}","+            </Button>","+          </DialogFooter>","+        </DialogContent>","+      </Dialog>","+    </div>","+  );","+}","+","+function ManualEntryDialog({","+  open,","+  onClose,","+  userId,","+  onSave,","+  language,","+  users","+}: {","+  open: boolean;","+  onClose: () => void;","+  userId: string;","+  onSave: () => void;","+  language: Language;","+  users?: UserModel[];","+}) {","+  const [selectedUser, setSelectedUser] = useState(userId);","+  const [clockIn, setClockIn] = useState(\"\");","+  const [clockOut, setClockOut] = useState(\"\");","+  const [location, setLocation] = useState(\"\");","+  const [workDescription, setWorkDescription] = useState(\"\");","+  const [lunchStart, setLunchStart] = useState(\"\");","+  const [lunchEnd, setLunchEnd] = useState(\"\");","+","+  const t = translations[language];","+","+  useEffect(() => {","+    if (open) {","+      setSelectedUser(userId);","+      // Set default to today","+      const now = new Date();","+      const today = now.toISOString().slice(0, 10);","+      setClockIn(`${today}T09:00`);","+      setClockOut(`${today}T17:00`);","+      setLocation(\"\");","+      setWorkDescription(\"\");","+      setLunchStart(`${today}T12:00`);","+      setLunchEnd(`${today}T13:00`);","+    }","+  }, [open, userId]);","+","+  const handleSave = async () => {","+    const timeCardORM = TimeCardEntryORM.getInstance();","+","+    const clockInTimestamp = Math.floor(new Date(clockIn).getTime() / 1000).toString();","+    const clockOutTimestamp = clockOut ? Math.floor(new Date(clockOut).getTime() / 1000).toString() : null;","+    const lunchStartTimestamp = lunchStart ? Math.floor(new Date(lunchStart).getTime() / 1000).toString() : null;","+    const lunchEndTimestamp = lunchEnd ? Math.floor(new Date(lunchEnd).getTime() / 1000).toString() : null;","+","+    let totalHours = null;","+    let lunchDurationMinutes = null;","+","+    // Calculate lunch duration","+    if (lunchStartTimestamp && lunchEndTimestamp) {","+      const lunchStartTime = parseInt(lunchStartTimestamp);","+      const lunchEndTime = parseInt(lunchEndTimestamp);","+      lunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;","+    }","+","+    // Calculate total hours","+    if (clockOutTimestamp) {","+      const clockInTime = parseInt(clockInTimestamp);","+      const clockOutTime = parseInt(clockOutTimestamp);","+      totalHours = (clockOutTime - clockInTime) / 3600;","+","+      // Deduct lunch time","+      if (lunchDurationMinutes) {","+        totalHours -= lunchDurationMinutes / 60;","+      }","+    }","+","+    await timeCardORM.insertTimeCardEntry([{","+      user_id: selectedUser,","+      clock_in_timestamp: clockInTimestamp,","+      clock_out_timestamp: clockOutTimestamp,","+      total_hours: totalHours,","+      location: location || null,","+      work_description: workDescription || null,","+      lunch_start_timestamp: lunchStartTimestamp,","+      lunch_end_timestamp: lunchEndTimestamp,","+      lunch_duration_minutes: lunchDurationMinutes,","+    } as TimeCardEntryModel]);","+","+    onSave();","+    onClose();","+  };","+","+  return (","+    <Dialog open={open} onOpenChange={onClose}>","+      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">","+        <DialogHeader>","+          <DialogTitle>{t.addManualEntry}</DialogTitle>","+        </DialogHeader>","+        <div className=\"space-y-4\">","+          {users && (","+            <div>","+              <Label>{t.employeeName}</Label>","+              <Select value={selectedUser} onValueChange={setSelectedUser}>","+                <SelectTrigger>","+                  <SelectValue />","+                </SelectTrigger>","+                <SelectContent>","+                  {users.filter(u => u.role === UserRole.Employee).map((u) => (","+                    <SelectItem key={u.id} value={u.id}>","+                      {u.name}","+                    </SelectItem>","+                  ))}","+                </SelectContent>","+              </Select>","+            </div>","+          )}","+          <div className=\"grid grid-cols-2 gap-4\">","+            <div>","+              <Label>{t.clockInTime}</Label>","+              <Input","+                type=\"datetime-local\"","+                value={clockIn}","+                onChange={(e) => setClockIn(e.target.value)}","+              />","+            </div>","+            <div>","+              <Label>{t.clockOutTime}</Label>","+              <Input","+                type=\"datetime-local\"","+                value={clockOut}","+                onChange={(e) => setClockOut(e.target.value)}","+              />","+            </div>","+          </div>","+          <div>","+            <Label>{t.location}</Label>","+            <Input","+              value={location}","+              onChange={(e) => setLocation(e.target.value)}","+              placeholder={t.locationPlaceholder}","+            />","+          </div>","+          <div>","+            <Label>{t.workDescription}</Label>","+            <Textarea","+              value={workDescription}","+              onChange={(e) => setWorkDescription(e.target.value)}","+              placeholder={t.descriptionPlaceholder}","+              rows={4}","+            />","+          </div>","+          <div className=\"grid grid-cols-2 gap-4\">","+            <div>","+              <Label>{t.lunchStartTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>","+              <Input","+                type=\"datetime-local\"","+                value={lunchStart}","+                onChange={(e) => setLunchStart(e.target.value)}","+              />","+            </div>","+            <div>","+              <Label>{t.lunchEndTime} ({language === 'en' ? 'Optional' : 'Opcional'})</Label>","+              <Input","+                type=\"datetime-local\"","+                value={lunchEnd}","+                onChange={(e) => setLunchEnd(e.target.value)}","+              />","+            </div>","+          </div>","+        </div>","+        <DialogFooter>","+          <Button variant=\"outline\" onClick={onClose}>","+            {t.cancel}","+          </Button>","+          <Button onClick={handleSave} disabled={!selectedUser || !clockIn}>","+            {t.saveChanges}","+          </Button>","+        </DialogFooter>","+      </DialogContent>","+    </Dialog>","+  );","+}"]}],"originalFile":"import { createFileRoute } from \"@tanstack/react-router\";\nimport { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Clock, Users, CalendarDays, Timer, Languages, Coffee } from \"lucide-react\";\nimport { UserORM, type UserModel, UserRole } from \"@/sdk/database/orm/orm_user\";\nimport { TimeCardEntryORM, type TimeCardEntryModel } from \"@/sdk/database/orm/orm_time_card_entry\";\n\nexport const Route = createFileRoute(\"/\")({\n\tcomponent: App,\n});\n\ntype Language = 'en' | 'es';\n\nconst translations = {\n\ten: {\n\t\tappTitle: \"Employee Time Tracking\",\n\t\tselectAccount: \"Select your account to continue\",\n\t\tselectUser: \"Select User\",\n\t\tchooseAccount: \"Choose your account\",\n\t\tmanager: \"Manager\",\n\t\temployee: \"Employee\",\n\t\tswitchUser: \"Switch User\",\n\t\ttimeTrackingSystem: \"Time Tracking System\",\n\t\twelcome: \"Welcome\",\n\t\tclockInOut: \"Clock In/Out\",\n\t\tcurrentlyClocked: \"Currently Clocked In\",\n\t\tsince: \"Since\",\n\t\telapsedTime: \"Elapsed Time\",\n\t\tclockOut: \"Clock Out\",\n\t\tnotClocked: \"Not currently clocked in\",\n\t\tclockIn: \"Clock In\",\n\t\ttimeCardHistory: \"Time Card History\",\n\t\trecentRecords: \"Your recent clock in/out records\",\n\t\tnoTimeCards: \"No time cards yet\",\n\t\tclockInTime: \"Clock In\",\n\t\tclockOutTime: \"Clock Out\",\n\t\thours: \"Hours\",\n\t\tstatus: \"Status\",\n\t\tcompleted: \"Completed\",\n\t\tactive: \"Active\",\n\t\ttotalEmployees: \"Total Employees\",\n\t\thoursToday: \"Hours Today\",\n\t\thoursThisWeek: \"Hours This Week\",\n\t\tallEmployeeTimeCards: \"All Employee Time Cards\",\n\t\tviewManageRecords: \"View and manage all employee time records\",\n\t\tfilterByEmployee: \"Filter by Employee\",\n\t\tallEmployees: \"All Employees\",\n\t\tfilterByDate: \"Filter by Date\",\n\t\tclearFilters: \"Clear Filters\",\n\t\tnoTimeCardsFound: \"No time cards found\",\n\t\temployeeName: \"Employee\",\n\t\tactions: \"Actions\",\n\t\tedit: \"Edit\",\n\t\teditTimeCard: \"Edit Time Card\",\n\t\tcancel: \"Cancel\",\n\t\tsaveChanges: \"Save Changes\",\n\t\tlocation: \"Location\",\n\t\twhereWorked: \"Where did you work?\",\n\t\tworkDescription: \"Work Description\",\n\t\twhatDid: \"What did you do today?\",\n\t\tlocationPlaceholder: \"e.g., Office, Remote, Client Site\",\n\t\tdescriptionPlaceholder: \"Describe your work activities...\",\n\t\tstartLunch: \"Start Lunch Break\",\n\t\tendLunch: \"End Lunch Break\",\n\t\tonLunchBreak: \"On Lunch Break\",\n\t\tlunchBreak: \"Lunch Break\",\n\t\tlunchDuration: \"Lunch\",\n\t\tlunchStartTime: \"Lunch Start\",\n\t\tlunchEndTime: \"Lunch End\",\n\t},\n\tes: {\n\t\tappTitle: \"Registro de Tiempo de Empleados\",\n\t\tselectAccount: \"Selecciona tu cuenta para continuar\",\n\t\tselectUser: \"Seleccionar Usuario\",\n\t\tchooseAccount: \"Elige tu cuenta\",\n\t\tmanager: \"Gerente\",\n\t\temployee: \"Empleado\",\n\t\tswitchUser: \"Cambiar Usuario\",\n\t\ttimeTrackingSystem: \"Sistema de Registro de Tiempo\",\n\t\twelcome: \"Bienvenido\",\n\t\tclockInOut: \"Entrada/Salida\",\n\t\tcurrentlyClocked: \"Actualmente Registrado\",\n\t\tsince: \"Desde\",\n\t\telapsedTime: \"Tiempo Transcurrido\",\n\t\tclockOut: \"Registrar Salida\",\n\t\tnotClocked: \"No está registrado actualmente\",\n\t\tclockIn: \"Registrar Entrada\",\n\t\ttimeCardHistory: \"Historial de Tarjetas de Tiempo\",\n\t\trecentRecords: \"Tus registros recientes de entrada/salida\",\n\t\tnoTimeCards: \"No hay tarjetas de tiempo todavía\",\n\t\tclockInTime: \"Entrada\",\n\t\tclockOutTime: \"Salida\",\n\t\thours: \"Horas\",\n\t\tstatus: \"Estado\",\n\t\tcompleted: \"Completado\",\n\t\tactive: \"Activo\",\n\t\ttotalEmployees: \"Total de Empleados\",\n\t\thoursToday: \"Horas Hoy\",\n\t\thoursThisWeek: \"Horas Esta Semana\",\n\t\tallEmployeeTimeCards: \"Todas las Tarjetas de Tiempo\",\n\t\tviewManageRecords: \"Ver y gestionar todos los registros de empleados\",\n\t\tfilterByEmployee: \"Filtrar por Empleado\",\n\t\tallEmployees: \"Todos los Empleados\",\n\t\tfilterByDate: \"Filtrar por Fecha\",\n\t\tclearFilters: \"Limpiar Filtros\",\n\t\tnoTimeCardsFound: \"No se encontraron tarjetas de tiempo\",\n\t\temployeeName: \"Empleado\",\n\t\tactions: \"Acciones\",\n\t\tedit: \"Editar\",\n\t\teditTimeCard: \"Editar Tarjeta de Tiempo\",\n\t\tcancel: \"Cancelar\",\n\t\tsaveChanges: \"Guardar Cambios\",\n\t\tlocation: \"Ubicación\",\n\t\twhereWorked: \"¿Dónde trabajaste?\",\n\t\tworkDescription: \"Descripción del Trabajo\",\n\t\twhatDid: \"¿Qué hiciste hoy?\",\n\t\tlocationPlaceholder: \"ej., Oficina, Remoto, Sitio del Cliente\",\n\t\tdescriptionPlaceholder: \"Describe tus actividades laborales...\",\n\t\tstartLunch: \"Iniciar Almuerzo\",\n\t\tendLunch: \"Terminar Almuerzo\",\n\t\tonLunchBreak: \"En Almuerzo\",\n\t\tlunchBreak: \"Almuerzo\",\n\t\tlunchDuration: \"Almuerzo\",\n\t\tlunchStartTime: \"Inicio Almuerzo\",\n\t\tlunchEndTime: \"Fin Almuerzo\",\n\t}\n};\n\nfunction App() {\n\tconst [currentUser, setCurrentUser] = useState<UserModel | null>(null);\n\tconst [users, setUsers] = useState<UserModel[]>([]);\n\tconst [showUserSelect, setShowUserSelect] = useState(true);\n\tconst [language, setLanguage] = useState<Language>('en');\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadUsers();\n\t}, []);\n\n\tconst loadUsers = async () => {\n\t\tconst userORM = UserORM.getInstance();\n\t\tconst allUsers = await userORM.getAllUser();\n\n\t\t// If no users exist, create demo users\n\t\tif (allUsers.length === 0) {\n\t\t\tconst demoUsers = await userORM.insertUser([\n\t\t\t\t{\n\t\t\t\t\tname: \"John Smith\",\n\t\t\t\t\temail: \"john@example.com\",\n\t\t\t\t\trole: UserRole.Employee,\n\t\t\t\t} as UserModel,\n\t\t\t\t{\n\t\t\t\t\tname: \"Sarah Johnson\",\n\t\t\t\t\temail: \"sarah@example.com\",\n\t\t\t\t\trole: UserRole.Employee,\n\t\t\t\t} as UserModel,\n\t\t\t\t{\n\t\t\t\t\tname: \"Mike Manager\",\n\t\t\t\t\temail: \"mike@example.com\",\n\t\t\t\t\trole: UserRole.Manager,\n\t\t\t\t} as UserModel,\n\t\t\t]);\n\t\t\tsetUsers(demoUsers);\n\t\t} else {\n\t\t\tsetUsers(allUsers);\n\t\t}\n\t};\n\n\tconst handleUserSelect = (userId: string) => {\n\t\tconst user = users.find(u => u.id === userId);\n\t\tif (user) {\n\t\t\tsetCurrentUser(user);\n\t\t\tsetShowUserSelect(false);\n\t\t}\n\t};\n\n\tconst handleLogout = () => {\n\t\tsetCurrentUser(null);\n\t\tsetShowUserSelect(true);\n\t};\n\n\tconst toggleLanguage = () => {\n\t\tsetLanguage(prev => prev === 'en' ? 'es' : 'en');\n\t};\n\n\tif (showUserSelect || !currentUser) {\n\t\treturn (\n\t\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4\">\n\t\t\t\t<div className=\"absolute top-4 right-4\">\n\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t\t<Card className=\"w-full max-w-md\">\n\t\t\t\t\t<CardHeader>\n\t\t\t\t\t\t<CardTitle className=\"text-2xl\">{t.appTitle}</CardTitle>\n\t\t\t\t\t\t<CardDescription>{t.selectAccount}</CardDescription>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<Label>{t.selectUser}</Label>\n\t\t\t\t\t\t\t<Select onValueChange={handleUserSelect}>\n\t\t\t\t\t\t\t\t<SelectTrigger className=\"w-full\">\n\t\t\t\t\t\t\t\t\t<SelectValue placeholder={t.chooseAccount} />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t{users.map((user) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={user.id} value={user.id}>\n\t\t\t\t\t\t\t\t\t\t\t{user.name} - {user.role === UserRole.Manager ? t.manager : t.employee}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800\">\n\t\t\t<div className=\"container mx-auto p-6 space-y-6\">\n\t\t\t\t<div className=\"flex justify-between items-center\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h1 className=\"text-3xl font-bold\">{t.timeTrackingSystem}</h1>\n\t\t\t\t\t\t<p className=\"text-muted-foreground\">\n\t\t\t\t\t\t\t{t.welcome}, {currentUser.name} ({currentUser.role === UserRole.Manager ? t.manager : t.employee})\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button onClick={toggleLanguage} variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\t\t<Languages className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t{language === 'en' ? 'Español' : 'English'}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleLogout} variant=\"outline\">\n\t\t\t\t\t\t\t{t.switchUser}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{currentUser.role === UserRole.Employee ? (\n\t\t\t\t\t<EmployeeView user={currentUser} language={language} />\n\t\t\t\t) : (\n\t\t\t\t\t<ManagerView user={currentUser} users={users} language={language} />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction EmployeeView({ user, language }: { user: UserModel; language: Language }) {\n\tconst [activeShift, setActiveShift] = useState<TimeCardEntryModel | null>(null);\n\tconst [timeCards, setTimeCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [elapsedTime, setElapsedTime] = useState(0);\n\tconst [location, setLocation] = useState(\"\");\n\tconst [workDescription, setWorkDescription] = useState(\"\");\n\tconst [isOnLunch, setIsOnLunch] = useState(false);\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadTimeCards();\n\t}, [user.id]);\n\n\tuseEffect(() => {\n\t\tlet interval: NodeJS.Timeout;\n\t\tif (activeShift && !isOnLunch) {\n\t\t\tinterval = setInterval(() => {\n\t\t\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp) * 1000;\n\t\t\t\tconst elapsed = Date.now() - clockInTime;\n\t\t\t\tsetElapsedTime(elapsed);\n\t\t\t}, 1000);\n\t\t}\n\t\treturn () => clearInterval(interval);\n\t}, [activeShift, isOnLunch]);\n\n\tconst loadTimeCards = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst userTimeCards = await timeCardORM.getTimeCardEntryByUserId(user.id);\n\n\t\t// Sort by clock in time (newest first)\n\t\tconst sorted = userTimeCards.sort((a, b) =>\n\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n\t\t);\n\n\t\tsetTimeCards(sorted);\n\n\t\t// Find active shift (no clock out time)\n\t\tconst active = sorted.find(tc => !tc.clock_out_timestamp);\n\t\tsetActiveShift(active || null);\n\t\tif (active) {\n\t\t\tsetLocation(active.location || \"\");\n\t\t\tsetWorkDescription(active.work_description || \"\");\n\t\t\t// Check if on lunch break\n\t\t\tsetIsOnLunch(!!(active.lunch_start_timestamp && !active.lunch_end_timestamp));\n\t\t} else {\n\t\t\tsetIsOnLunch(false);\n\t\t}\n\t};\n\n\tconst handleClockIn = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tawait timeCardORM.insertTimeCardEntry([{\n\t\t\tuser_id: user.id,\n\t\t\tclock_in_timestamp: now,\n\t\t\tlocation: location || null,\n\t\t\twork_description: workDescription || null,\n\t\t} as TimeCardEntryModel]);\n\n\t\tsetLocation(\"\");\n\t\tsetWorkDescription(\"\");\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleClockOut = async () => {\n\t\tif (!activeShift) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tconst clockInTime = parseInt(activeShift.clock_in_timestamp);\n\t\tconst clockOutTime = parseInt(now);\n\t\tlet totalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t// Deduct lunch time if lunch was taken\n\t\tif (activeShift.lunch_duration_minutes) {\n\t\t\ttotalHours -= activeShift.lunch_duration_minutes / 60;\n\t\t}\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tclock_out_timestamp: now,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: location || activeShift.location,\n\t\t\twork_description: workDescription || activeShift.work_description,\n\t\t});\n\n\t\tsetLocation(\"\");\n\t\tsetWorkDescription(\"\");\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleStartLunch = async () => {\n\t\tif (!activeShift) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tlunch_start_timestamp: now,\n\t\t\tlocation: location || activeShift.location,\n\t\t\twork_description: workDescription || activeShift.work_description,\n\t\t});\n\n\t\tawait loadTimeCards();\n\t};\n\n\tconst handleEndLunch = async () => {\n\t\tif (!activeShift || !activeShift.lunch_start_timestamp) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst now = Math.floor(Date.now() / 1000).toString();\n\n\t\tconst lunchStartTime = parseInt(activeShift.lunch_start_timestamp);\n\t\tconst lunchEndTime = parseInt(now);\n\t\tconst lunchDurationMinutes = (lunchEndTime - lunchStartTime) / 60;\n\n\t\t// Add to existing lunch duration if there was already one\n\t\tconst totalLunchMinutes = (activeShift.lunch_duration_minutes || 0) + lunchDurationMinutes;\n\n\t\tawait timeCardORM.setTimeCardEntryById(activeShift.id, {\n\t\t\t...activeShift,\n\t\t\tlunch_end_timestamp: now,\n\t\t\tlunch_duration_minutes: totalLunchMinutes,\n\t\t});\n\n\t\tawait loadTimeCards();\n\t};\n\n\tconst formatTime = (ms: number) => {\n\t\tconst seconds = Math.floor(ms / 1000);\n\t\tconst hours = Math.floor(seconds / 3600);\n\t\tconst minutes = Math.floor((seconds % 3600) / 60);\n\t\tconst secs = seconds % 60;\n\t\treturn `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n\t};\n\n\tconst formatDate = (timestamp: string) => {\n\t\tconst date = new Date(parseInt(timestamp) * 1000);\n\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n\t};\n\n\tconst formatHours = (hours: number | null | undefined) => {\n\t\tif (hours === null || hours === undefined) return \"—\";\n\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n\t};\n\n\tconst formatMinutes = (minutes: number | null | undefined) => {\n\t\tif (minutes === null || minutes === undefined) return \"—\";\n\t\treturn `${Math.round(minutes)} min`;\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<Clock className=\"w-5 h-5\" />\n\t\t\t\t\t\t{t.clockInOut}\n\t\t\t\t\t</CardTitle>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t{activeShift ? (\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t{isOnLunch ? (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-orange-800 dark:text-orange-200\">{t.onLunchBreak}</p>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-orange-600 dark:text-orange-300\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.since} {activeShift.lunch_start_timestamp && formatDate(activeShift.lunch_start_timestamp)}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-green-800 dark:text-green-200\">{t.currentlyClocked}</p>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300\">\n\t\t\t\t\t\t\t\t\t\t\t{t.since} {formatDate(activeShift.clock_in_timestamp)}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t{activeShift.location && (\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.location}: {activeShift.location}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t{activeShift.lunch_duration_minutes && activeShift.lunch_duration_minutes > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 dark:text-green-300 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.lunchBreak}: {formatMinutes(activeShift.lunch_duration_minutes)}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-mono font-bold text-green-800 dark:text-green-200\">\n\t\t\t\t\t\t\t\t\t\t\t{formatTime(elapsedTime)}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-green-600 dark:text-green-300\">{t.elapsedTime}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{!isOnLunch && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-2\">\n\t\t\t\t\t\t\t\t{isOnLunch ? (\n\t\t\t\t\t\t\t\t\t<Button onClick={handleEndLunch} variant=\"default\" className=\"col-span-2\">\n\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t\t\t\t{t.endLunch}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={handleStartLunch} variant=\"outline\">\n\t\t\t\t\t\t\t\t\t\t\t<Coffee className=\"w-4 h-4 mr-2\" />\n\t\t\t\t\t\t\t\t\t\t\t{t.startLunch}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={handleClockOut} variant=\"destructive\">\n\t\t\t\t\t\t\t\t\t\t\t{t.clockOut}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center\">\n\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground\">{t.notClocked}</p>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<Label>{t.whereWorked}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\tvalue={location}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setLocation(e.target.value)}\n\t\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<Label>{t.whatDid}</Label>\n\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\tvalue={workDescription}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Button onClick={handleClockIn} className=\"w-full\">\n\t\t\t\t\t\t\t\t{t.clockIn}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<CalendarDays className=\"w-5 h-5\" />\n\t\t\t\t\t\t{t.timeCardHistory}\n\t\t\t\t\t</CardTitle>\n\t\t\t\t\t<CardDescription>{t.recentRecords}</CardDescription>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent>\n\t\t\t\t\t{timeCards.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCards}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{timeCards.map((tc) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\t\t</div>\n\t);\n}\n\nfunction ManagerView({ user, users, language }: { user: UserModel; users: UserModel[]; language: Language }) {\n\tconst [allTimeCards, setAllTimeCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [filteredCards, setFilteredCards] = useState<TimeCardEntryModel[]>([]);\n\tconst [selectedEmployee, setSelectedEmployee] = useState<string>(\"all\");\n\tconst [dateFilter, setDateFilter] = useState<string>(\"\");\n\tconst [editingCard, setEditingCard] = useState<TimeCardEntryModel | null>(null);\n\tconst [editClockIn, setEditClockIn] = useState(\"\");\n\tconst [editClockOut, setEditClockOut] = useState(\"\");\n\tconst [editLocation, setEditLocation] = useState(\"\");\n\tconst [editWorkDescription, setEditWorkDescription] = useState(\"\");\n\tconst [editLunchStart, setEditLunchStart] = useState(\"\");\n\tconst [editLunchEnd, setEditLunchEnd] = useState(\"\");\n\n\tconst t = translations[language];\n\n\tuseEffect(() => {\n\t\tloadAllTimeCards();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tapplyFilters();\n\t}, [allTimeCards, selectedEmployee, dateFilter]);\n\n\tconst loadAllTimeCards = async () => {\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst allCards = await timeCardORM.getAllTimeCardEntry();\n\n\t\t// Sort by clock in time (newest first)\n\t\tconst sorted = allCards.sort((a, b) =>\n\t\t\tparseInt(b.clock_in_timestamp) - parseInt(a.clock_in_timestamp)\n\t\t);\n\n\t\tsetAllTimeCards(sorted);\n\t};\n\n\tconst applyFilters = () => {\n\t\tlet filtered = [...allTimeCards];\n\n\t\t// Filter by employee\n\t\tif (selectedEmployee !== \"all\") {\n\t\t\tfiltered = filtered.filter(tc => tc.user_id === selectedEmployee);\n\t\t}\n\n\t\t// Filter by date\n\t\tif (dateFilter) {\n\t\t\tconst filterDate = new Date(dateFilter);\n\t\t\tconst filterTimestamp = Math.floor(filterDate.getTime() / 1000);\n\t\t\tconst nextDayTimestamp = filterTimestamp + 86400; // +24 hours\n\n\t\t\tfiltered = filtered.filter(tc => {\n\t\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\t\treturn clockIn >= filterTimestamp && clockIn < nextDayTimestamp;\n\t\t\t});\n\t\t}\n\n\t\tsetFilteredCards(filtered);\n\t};\n\n\tconst getUserName = (userId: string) => {\n\t\tconst user = users.find(u => u.id === userId);\n\t\treturn user?.name || \"Unknown\";\n\t};\n\n\tconst formatDate = (timestamp: string) => {\n\t\tconst date = new Date(parseInt(timestamp) * 1000);\n\t\treturn date.toLocaleString(language === 'es' ? 'es-ES' : 'en-US');\n\t};\n\n\tconst formatHours = (hours: number | null | undefined) => {\n\t\tif (hours === null || hours === undefined) return \"—\";\n\t\treturn `${hours.toFixed(2)} ${language === 'es' ? 'hrs' : 'hrs'}`;\n\t};\n\n\tconst formatMinutes = (minutes: number | null | undefined) => {\n\t\tif (minutes === null || minutes === undefined) return \"—\";\n\t\treturn `${Math.round(minutes)} min`;\n\t};\n\n\tconst calculateTotalHours = (period: 'day' | 'week') => {\n\t\tconst now = Date.now() / 1000;\n\t\tconst periodSeconds = period === 'day' ? 86400 : 604800; // 1 day or 7 days\n\t\tconst startTime = now - periodSeconds;\n\n\t\tconst relevantCards = allTimeCards.filter(tc => {\n\t\t\tconst clockIn = parseInt(tc.clock_in_timestamp);\n\t\t\treturn clockIn >= startTime && tc.total_hours;\n\t\t});\n\n\t\treturn relevantCards.reduce((sum, tc) => sum + (tc.total_hours || 0), 0);\n\t};\n\n\tconst handleEditCard = (card: TimeCardEntryModel) => {\n\t\tsetEditingCard(card);\n\t\tsetEditClockIn(new Date(parseInt(card.clock_in_timestamp) * 1000).toISOString().slice(0, 16));\n\t\tsetEditClockOut(\n\t\t\tcard.clock_out_timestamp\n\t\t\t\t? new Date(parseInt(card.clock_out_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t\tsetEditLocation(card.location || \"\");\n\t\tsetEditWorkDescription(card.work_description || \"\");\n\t\tsetEditLunchStart(\n\t\t\tcard.lunch_start_timestamp\n\t\t\t\t? new Date(parseInt(card.lunch_start_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t\tsetEditLunchEnd(\n\t\t\tcard.lunch_end_timestamp\n\t\t\t\t? new Date(parseInt(card.lunch_end_timestamp) * 1000).toISOString().slice(0, 16)\n\t\t\t\t: \"\"\n\t\t);\n\t};\n\n\tconst handleSaveEdit = async () => {\n\t\tif (!editingCard) return;\n\n\t\tconst timeCardORM = TimeCardEntryORM.getInstance();\n\t\tconst clockInTimestamp = Math.floor(new Date(editClockIn).getTime() / 1000).toString();\n\t\tconst clockOutTimestamp = editClockOut\n\t\t\t? Math.floor(new Date(editClockOut).getTime() / 1000).toString()\n\t\t\t: null;\n\t\tconst lunchStartTimestamp = editLunchStart\n\t\t\t? Math.floor(new Date(editLunchStart).getTime() / 1000).toString()\n\t\t\t: null;\n\t\tconst lunchEndTimestamp = editLunchEnd\n\t\t\t? Math.floor(new Date(editLunchEnd).getTime() / 1000).toString()\n\t\t\t: null;\n\n\t\tlet totalHours = null;\n\t\tlet lunchDurationMinutes = null;\n\n\t\t// Calculate lunch duration\n\t\tif (lunchStartTimestamp && lunchEndTimestamp) {\n\t\t\tconst lunchStart = parseInt(lunchStartTimestamp);\n\t\t\tconst lunchEnd = parseInt(lunchEndTimestamp);\n\t\t\tlunchDurationMinutes = (lunchEnd - lunchStart) / 60;\n\t\t}\n\n\t\t// Calculate total hours\n\t\tif (clockOutTimestamp) {\n\t\t\tconst clockInTime = parseInt(clockInTimestamp);\n\t\t\tconst clockOutTime = parseInt(clockOutTimestamp);\n\t\t\ttotalHours = (clockOutTime - clockInTime) / 3600;\n\n\t\t\t// Deduct lunch time\n\t\t\tif (lunchDurationMinutes) {\n\t\t\t\ttotalHours -= lunchDurationMinutes / 60;\n\t\t\t}\n\t\t}\n\n\t\tawait timeCardORM.setTimeCardEntryById(editingCard.id, {\n\t\t\t...editingCard,\n\t\t\tclock_in_timestamp: clockInTimestamp,\n\t\t\tclock_out_timestamp: clockOutTimestamp,\n\t\t\ttotal_hours: totalHours,\n\t\t\tlocation: editLocation || null,\n\t\t\twork_description: editWorkDescription || null,\n\t\t\tlunch_start_timestamp: lunchStartTimestamp,\n\t\t\tlunch_end_timestamp: lunchEndTimestamp,\n\t\t\tlunch_duration_minutes: lunchDurationMinutes,\n\t\t});\n\n\t\tsetEditingCard(null);\n\t\tawait loadAllTimeCards();\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<Users className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.totalEmployees}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{users.filter(u => u.role === UserRole.Employee).length}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<Timer className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.hoursToday}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('day').toFixed(2)}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-3\">\n\t\t\t\t\t\t<CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t<CalendarDays className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t{t.hoursThisWeek}\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"text-2xl font-bold\">{calculateTotalHours('week').toFixed(2)}</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t<Card>\n\t\t\t\t<CardHeader>\n\t\t\t\t\t<CardTitle>{t.allEmployeeTimeCards}</CardTitle>\n\t\t\t\t\t<CardDescription>{t.viewManageRecords}</CardDescription>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent className=\"space-y-4\">\n\t\t\t\t\t<div className=\"flex gap-4 flex-wrap\">\n\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n\t\t\t\t\t\t\t<Label>{t.filterByEmployee}</Label>\n\t\t\t\t\t\t\t<Select value={selectedEmployee} onValueChange={setSelectedEmployee}>\n\t\t\t\t\t\t\t\t<SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t<SelectItem value=\"all\">{t.allEmployees}</SelectItem>\n\t\t\t\t\t\t\t\t\t{users.filter(u => u.role === UserRole.Employee).map((u) => (\n\t\t\t\t\t\t\t\t\t\t<SelectItem key={u.id} value={u.id}>\n\t\t\t\t\t\t\t\t\t\t\t{u.name}\n\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"flex-1 min-w-[200px]\">\n\t\t\t\t\t\t\t<Label>{t.filterByDate}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\t\tvalue={dateFilter}\n\t\t\t\t\t\t\t\tonChange={(e) => setDateFilter(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{(selectedEmployee !== \"all\" || dateFilter) && (\n\t\t\t\t\t\t\t<div className=\"flex items-end\">\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tsetSelectedEmployee(\"all\");\n\t\t\t\t\t\t\t\t\t\tsetDateFilter(\"\");\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{t.clearFilters}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{filteredCards.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-center text-muted-foreground py-8\">{t.noTimeCardsFound}</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.employeeName}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockInTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.clockOutTime}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.location}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.workDescription}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.lunchDuration}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.hours}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.status}</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead>{t.actions}</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{filteredCards.map((tc) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={tc.id}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium whitespace-nowrap\">{getUserName(tc.user_id)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatDate(tc.clock_in_timestamp)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? formatDate(tc.clock_out_timestamp) : \"—\"}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>{tc.location || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"max-w-xs truncate\">{tc.work_description || \"—\"}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatMinutes(tc.lunch_duration_minutes)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap\">{formatHours(tc.total_hours)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{tc.clock_out_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">{t.completed}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : tc.lunch_start_timestamp && !tc.lunch_end_timestamp ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-orange-500\">{t.onLunchBreak}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"bg-green-500\">{t.active}</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleEditCard(tc)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t.edit}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\n\t\t\t<Dialog open={!!editingCard} onOpenChange={(open) => !open && setEditingCard(null)}>\n\t\t\t\t<DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>{t.editTimeCard}</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.employeeName}</Label>\n\t\t\t\t\t\t\t<Input value={editingCard ? getUserName(editingCard.user_id) : \"\"} disabled />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.clockInTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editClockIn}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockIn(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.clockOutTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editClockOut}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditClockOut(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.location}</Label>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={editLocation}\n\t\t\t\t\t\t\t\tonChange={(e) => setEditLocation(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder={t.locationPlaceholder}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label>{t.workDescription}</Label>\n\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\tvalue={editWorkDescription}\n\t\t\t\t\t\t\t\tonChange={(e) => setEditWorkDescription(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder={t.descriptionPlaceholder}\n\t\t\t\t\t\t\t\trows={4}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.lunchStartTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editLunchStart}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchStart(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>{t.lunchEndTime}</Label>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"datetime-local\"\n\t\t\t\t\t\t\t\t\tvalue={editLunchEnd}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEditLunchEnd(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setEditingCard(null)}>\n\t\t\t\t\t\t\t{t.cancel}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleSaveEdit}>\n\t\t\t\t\t\t\t{t.saveChanges}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\t\t</div>\n\t);\n}\n"}}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01J8YaQx3QgTYiwyAL3S6PBx","type":"message","role":"assistant","content":[{"type":"text","text":"Perfect! Now let me update the todos and run the type checking:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":5,"cache_creation_input_tokens":118723,"cache_read_input_tokens":16310,"cache_creation":{"ephemeral_5m_input_tokens":118723,"ephemeral_1h_input_tokens":0},"output_tokens":1},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"9635364f-cc94-447d-9c42-b9d3f96e2778"}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01J8YaQx3QgTYiwyAL3S6PBx","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_vrtx_01C6UZhtii4JxEJhVga6d3gW","name":"TodoWrite","input":{"todos":[{"content":"Add User Management - Create/Edit/Delete employees","activeForm":"Adding User Management functionality","status":"completed"},{"content":"Implement Weekly Reports with summary view","activeForm":"Implementing Weekly Reports","status":"completed"},{"content":"Add Overtime Tracking (>40 hours/week)","activeForm":"Adding Overtime Tracking","status":"completed"},{"content":"Add manual time card entry for missed clock ins","activeForm":"Adding manual time card entry","status":"completed"},{"content":"Add Spanish translations for new features","activeForm":"Adding Spanish translations","status":"completed"},{"content":"Run type checking and validation","activeForm":"Running type checking","status":"in_progress"}]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":5,"cache_creation_input_tokens":118723,"cache_read_input_tokens":16310,"cache_creation":{"ephemeral_5m_input_tokens":118723,"ephemeral_1h_input_tokens":0},"output_tokens":250},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"3d1c8c0b-af2f-4e2d-8c59-4de21cb746f3"}
{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_vrtx_01C6UZhtii4JxEJhVga6d3gW","type":"tool_result","content":"Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable"}]},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"751daaae-6c45-4e0d-b65a-006bd428165e","tool_use_result":{"oldTodos":[{"content":"Add User Management - Create/Edit/Delete employees","status":"in_progress","activeForm":"Adding User Management functionality"},{"content":"Implement Weekly Reports with summary view","status":"pending","activeForm":"Implementing Weekly Reports"},{"content":"Add Overtime Tracking (>40 hours/week)","status":"pending","activeForm":"Adding Overtime Tracking"},{"content":"Add manual time card entry for missed clock ins","status":"pending","activeForm":"Adding manual time card entry"},{"content":"Add Spanish translations for new features","status":"pending","activeForm":"Adding Spanish translations"},{"content":"Run type checking and validation","status":"pending","activeForm":"Running type checking"}],"newTodos":[{"content":"Add User Management - Create/Edit/Delete employees","status":"completed","activeForm":"Adding User Management functionality"},{"content":"Implement Weekly Reports with summary view","status":"completed","activeForm":"Implementing Weekly Reports"},{"content":"Add Overtime Tracking (>40 hours/week)","status":"completed","activeForm":"Adding Overtime Tracking"},{"content":"Add manual time card entry for missed clock ins","status":"completed","activeForm":"Adding manual time card entry"},{"content":"Add Spanish translations for new features","status":"completed","activeForm":"Adding Spanish translations"},{"content":"Run type checking and validation","status":"in_progress","activeForm":"Running type checking"}]}}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_019EFt9gyzX3JTDmvtTQTPzP","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_vrtx_019qfGD76DjWhhh5yoTRnpop","name":"Bash","input":{"command":"npm run check:safe","description":"Run TypeScript type checking and ESLint validation","timeout":120000}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":5,"cache_creation_input_tokens":292,"cache_read_input_tokens":135033,"cache_creation":{"ephemeral_5m_input_tokens":292,"ephemeral_1h_input_tokens":0},"output_tokens":100},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"120ad744-b5cf-4294-91a5-94b8513df437"}
{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_vrtx_019qfGD76DjWhhh5yoTRnpop","type":"tool_result","content":"> check:safe\n> timeout 20 npm run check || (echo 'Check timed out after 20 seconds' && exit 1)\n\n\n> check\n> tsgo --noEmit && npm run lint:radix -- --fix && npm run format\n\n\n> lint:radix\n> grep -l -r '<SelectItem' src | xargs eslint --config config/eslint/eslint.radix.config.js --fix\n\n\n> format\n> biome check --write --unsafe\n\nChecked 6 files in 66ms. No fixes applied.","is_error":false}]},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"8c94cc05-3073-409c-8ec9-671094d574f8","tool_use_result":{"stdout":"> check:safe\n> timeout 20 npm run check || (echo 'Check timed out after 20 seconds' && exit 1)\n\n\n> check\n> tsgo --noEmit && npm run lint:radix -- --fix && npm run format\n\n\n> lint:radix\n> grep -l -r '<SelectItem' src | xargs eslint --config config/eslint/eslint.radix.config.js --fix\n\n\n> format\n> biome check --write --unsafe\n\nChecked 6 files in 66ms. No fixes applied.","stderr":"","interrupted":false,"isImage":false}}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01LZyoWeWPm1fdVRSFBG2zXp","type":"message","role":"assistant","content":[{"type":"text","text":"Excellent! All checks passed. Let me mark the final todo as completed:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":238,"cache_read_input_tokens":135325,"cache_creation":{"ephemeral_5m_input_tokens":238,"ephemeral_1h_input_tokens":0},"output_tokens":4},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"1e97ca62-ebe5-42eb-acc8-1e3b59ae1aa7"}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01LZyoWeWPm1fdVRSFBG2zXp","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_vrtx_01MnEVoxKXaCX4xCGxQQh9xw","name":"TodoWrite","input":{"todos":[{"content":"Add User Management - Create/Edit/Delete employees","activeForm":"Adding User Management functionality","status":"completed"},{"content":"Implement Weekly Reports with summary view","activeForm":"Implementing Weekly Reports","status":"completed"},{"content":"Add Overtime Tracking (>40 hours/week)","activeForm":"Adding Overtime Tracking","status":"completed"},{"content":"Add manual time card entry for missed clock ins","activeForm":"Adding manual time card entry","status":"completed"},{"content":"Add Spanish translations for new features","activeForm":"Adding Spanish translations","status":"completed"},{"content":"Run type checking and validation","activeForm":"Running type checking","status":"completed"}]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":238,"cache_read_input_tokens":135325,"cache_creation":{"ephemeral_5m_input_tokens":238,"ephemeral_1h_input_tokens":0},"output_tokens":250},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"6690188e-ab31-4f01-9baf-eefaf449cea5"}
{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_vrtx_01MnEVoxKXaCX4xCGxQQh9xw","type":"tool_result","content":"Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable"}]},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"fffa3ed1-f489-463d-aeaf-6c6a127b71d0","tool_use_result":{"oldTodos":[{"content":"Add User Management - Create/Edit/Delete employees","status":"completed","activeForm":"Adding User Management functionality"},{"content":"Implement Weekly Reports with summary view","status":"completed","activeForm":"Implementing Weekly Reports"},{"content":"Add Overtime Tracking (>40 hours/week)","status":"completed","activeForm":"Adding Overtime Tracking"},{"content":"Add manual time card entry for missed clock ins","status":"completed","activeForm":"Adding manual time card entry"},{"content":"Add Spanish translations for new features","status":"completed","activeForm":"Adding Spanish translations"},{"content":"Run type checking and validation","status":"in_progress","activeForm":"Running type checking"}],"newTodos":[{"content":"Add User Management - Create/Edit/Delete employees","status":"completed","activeForm":"Adding User Management functionality"},{"content":"Implement Weekly Reports with summary view","status":"completed","activeForm":"Implementing Weekly Reports"},{"content":"Add Overtime Tracking (>40 hours/week)","status":"completed","activeForm":"Adding Overtime Tracking"},{"content":"Add manual time card entry for missed clock ins","status":"completed","activeForm":"Adding manual time card entry"},{"content":"Add Spanish translations for new features","status":"completed","activeForm":"Adding Spanish translations"},{"content":"Run type checking and validation","status":"completed","activeForm":"Running type checking"}]}}
{"type":"assistant","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_vrtx_01XNmDqv6MTUueLaghjVrGrZ","type":"message","role":"assistant","content":[{"type":"text","text":"Perfect! I've successfully implemented all three requested features. Here's a comprehensive summary:\n\n## ✅ **All Features Implemented Successfully!**\n\n### **1. User Management** 👥\n\n**Manager Dashboard - Employees Tab:**\n- **Add Employee**: Create new employee accounts with name, email, and role (Employee/Manager)\n- **Edit Employee**: Update existing employee information\n- **Delete Employee**: Remove employees with confirmation dialog\n- **View All Employees**: Table showing all users with their roles\n- **Full CRUD Operations**: Create, Read, Update, Delete for employee records\n\n**How to Use:**\n1. Log in as Manager (Mike Manager)\n2. Click \"Employees\" tab\n3. Click \"Add Employee\" button to create new employees\n4. Click \"Edit\" on any employee to modify their information\n5. Click \"Delete\" to remove employees (with confirmation)\n\n---\n\n### **2. Weekly Reports** 📊\n\n**Manager Dashboard - Reports Tab:**\n- **Week Selection**: Pick any week to view reports (defaults to current week)\n- **Regular Hours**: Shows hours up to 40/week per employee\n- **Overtime Hours**: Automatically calculates hours beyond 40/week\n- **Total Hours**: Sum of regular + overtime\n- **Overtime Alert Badge**: Visual indicator when employees work overtime\n- **Per-Employee Breakdown**: See each employee's hours separately\n\n**Overtime Calculation:**\n- 0-40 hours = Regular hours\n- 40+ hours = Regular (40) + Overtime (excess)\n- Example: 45 hours = 40 regular + 5 overtime\n\n**How to Use:**\n1. Log in as Manager\n2. Click \"Reports\" tab\n3. Select a week using the date picker\n4. View regular/overtime breakdown for all employees\n5. Orange \"Overtime Alert\" badges highlight employees with overtime\n\n---\n\n### **3. Manual Time Card Entry** ✏️\n\n**For Employees:**\n- **\"Add Time Card\" button** in Clock In/Out section\n- Manually add missed shifts\n- Fill in clock in/out times, location, work description, and lunch breaks\n- Perfect for when employees forget to clock in\n\n**For Managers:**\n- **\"Add Time Card\" button** in manager dashboard\n- Select employee from dropdown\n- Add time cards for any employee\n- Edit existing time cards with full control\n- Fix errors or add retroactive entries\n\n**Features:**\n- Pre-filled default times (9 AM - 5 PM today)\n- Optional lunch break times (12 PM - 1 PM by default)\n- Automatic hours calculation with lunch deduction\n- All fields editable\n\n**How to Use (Employee):**\n1. Click \"Add Time Card\" button (top right of Clock In/Out card)\n2. Enter clock in/out times\n3. Add location and work description\n4. Optionally add lunch times\n5. Click \"Save Changes\"\n\n**How to Use (Manager):**\n1. Go to Time Cards tab\n2. Click \"Add Time Card\" button\n3. Select employee from dropdown\n4. Fill in all time details\n5. Save to add to employee's record\n\n---\n\n### **4. Complete Spanish Translation** 🌐\n\nAll new features fully translated:\n- \"Empleados\" (Employees)\n- \"Agregar Empleado\" (Add Employee)\n- \"Informes\" (Reports)\n- \"Informe Semanal\" (Weekly Report)\n- \"Tiempo Extra\" (Overtime)\n- \"Alerta de Tiempo Extra\" (Overtime Alert)\n- \"Agregar Tarjeta\" (Add Time Card)\n- \"Entrada Manual\" (Manual Entry)\n\n---\n\n### **Manager Navigation (3 Tabs):**\n\n1. **Time Cards Tab**\n   - View all employee time cards\n   - Filter by employee/date\n   - Edit any time card\n   - Add manual entries\n   - Summary cards (Total Employees, Hours Today, Hours This Week)\n\n2. **Reports Tab**\n   - Weekly reports with overtime tracking\n   - Regular vs Overtime hours breakdown\n   - Overtime alerts\n   - Week selection\n\n3. **Employees Tab**\n   - Employee management\n   - Add/Edit/Delete employees\n   - View roles and contact info\n\n---\n\n### **Key Improvements:**\n\n✅ **User Management**: Full employee lifecycle management\n✅ **Weekly Reports**: Professional reports with overtime calculation\n✅ **Overtime Tracking**: Automatic 40-hour threshold\n✅ **Manual Entry**: Fix forgotten clock-ins easily\n✅ **Bilingual**: Complete English/Spanish support\n✅ **Type-Safe**: All TypeScript validations passing\n✅ **Production Ready**: Clean, professional UI\n\nThe time tracking system is now enterprise-ready with comprehensive management features!"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":292,"cache_read_input_tokens":135563,"cache_creation":{"ephemeral_5m_input_tokens":292,"ephemeral_1h_input_tokens":0},"output_tokens":1093},"context_management":null},"parent_tool_use_id":null,"session_id":"752928d6-a510-485a-bbfe-46da4a277f96","uuid":"6298d15e-0da1-49d2-92ca-0a10b9c3e9ab"}
{"type":"result","subtype":"success","is_error":false,"duration_ms":259974,"duration_api_ms":254805,"num_turns":6,"result":"Perfect! I've successfully implemented all three requested features. Here's a comprehensive summary:\n\n## ✅ **All Features Implemented Successfully!**\n\n### **1. User Management** 👥\n\n**Manager Dashboard - Employees Tab:**\n- **Add Employee**: Create new employee accounts with name, email, and role (Employee/Manager)\n- **Edit Employee**: Update existing employee information\n- **Delete Employee**: Remove employees with confirmation dialog\n- **View All Employees**: Table showing all users with their roles\n- **Full CRUD Operations**: Create, Read, Update, Delete for employee records\n\n**How to Use:**\n1. Log in as Manager (Mike Manager)\n2. Click \"Employees\" tab\n3. Click \"Add Employee\" button to create new employees\n4. Click \"Edit\" on any employee to modify their information\n5. Click \"Delete\" to remove employees (with confirmation)\n\n---\n\n### **2. Weekly Reports** 📊\n\n**Manager Dashboard - Reports Tab:**\n- **Week Selection**: Pick any week to view reports (defaults to current week)\n- **Regular Hours**: Shows hours up to 40/week per employee\n- **Overtime Hours**: Automatically calculates hours beyond 40/week\n- **Total Hours**: Sum of regular + overtime\n- **Overtime Alert Badge**: Visual indicator when employees work overtime\n- **Per-Employee Breakdown**: See each employee's hours separately\n\n**Overtime Calculation:**\n- 0-40 hours = Regular hours\n- 40+ hours = Regular (40) + Overtime (excess)\n- Example: 45 hours = 40 regular + 5 overtime\n\n**How to Use:**\n1. Log in as Manager\n2. Click \"Reports\" tab\n3. Select a week using the date picker\n4. View regular/overtime breakdown for all employees\n5. Orange \"Overtime Alert\" badges highlight employees with overtime\n\n---\n\n### **3. Manual Time Card Entry** ✏️\n\n**For Employees:**\n- **\"Add Time Card\" button** in Clock In/Out section\n- Manually add missed shifts\n- Fill in clock in/out times, location, work description, and lunch breaks\n- Perfect for when employees forget to clock in\n\n**For Managers:**\n- **\"Add Time Card\" button** in manager dashboard\n- Select employee from dropdown\n- Add time cards for any employee\n- Edit existing time cards with full control\n- Fix errors or add retroactive entries\n\n**Features:**\n- Pre-filled default times (9 AM - 5 PM today)\n- Optional lunch break times (12 PM - 1 PM by default)\n- Automatic hours calculation with lunch deduction\n- All fields editable\n\n**How to Use (Employee):**\n1. Click \"Add Time Card\" button (top right of Clock In/Out card)\n2. Enter clock in/out times\n3. Add location and work description\n4. Optionally add lunch times\n5. Click \"Save Changes\"\n\n**How to Use (Manager):**\n1. Go to Time Cards tab\n2. Click \"Add Time Card\" button\n3. Select employee from dropdown\n4. Fill in all time details\n5. Save to add to employee's record\n\n---\n\n### **4. Complete Spanish Translation** 🌐\n\nAll new features fully translated:\n- \"Empleados\" (Employees)\n- \"Agregar Empleado\" (Add Employee)\n- \"Informes\" (Reports)\n- \"Informe Semanal\" (Weekly Report)\n- \"Tiempo Extra\" (Overtime)\n- \"Alerta de Tiempo Extra\" (Overtime Alert)\n- \"Agregar Tarjeta\" (Add Time Card)\n- \"Entrada Manual\" (Manual Entry)\n\n---\n\n### **Manager Navigation (3 Tabs):**\n\n1. **Time Cards Tab**\n   - View all employee time cards\n   - Filter by employee/date\n   - Edit any time card\n   - Add manual entries\n   - Summary cards (Total Employees, Hours Today, Hours This Week)\n\n2. **Reports Tab**\n   - Weekly reports with overtime tracking\n   - Regular vs Overtime hours breakdown\n   - Overtime alerts\n   - Week selection\n\n3. **Employees Tab**\n   - Employee management\n   - Add/Edit/Delete employees\n   - View roles and contact info\n\n---\n\n### **Key Improvements:**\n\n✅ **User Management**: Full employee lifecycle management\n✅ **Weekly Reports**: Professional reports with overtime calculation\n✅ **Overtime Tracking**: Automatic 40-hour threshold\n✅ **Manual Entry**: Fix forgotten clock-ins easily\n✅ **Bilingual**: Complete English/Spanish support\n✅ **Type-Safe**: All TypeScript validations passing\n✅ **Production Ready**: Clean, professional UI\n\nThe time tracking system is now enterprise-ready with comprehensive management features!","session_id":"752928d6-a510-485a-bbfe-46da4a277f96","total_cost_usd":1.3431541,"usage":{"input_tokens":23,"cache_creation_input_tokens":234710,"cache_read_input_tokens":569706,"output_tokens":18819,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":"standard","cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":234710}},"modelUsage":{"claude-haiku-4-5-20251001":{"inputTokens":3369,"outputTokens":275,"cacheReadInputTokens":0,"cacheCreationInputTokens":0,"webSearchRequests":0,"costUSD":0.004744,"contextWindow":200000},"claude-sonnet-4-5-20250929":{"inputTokens":2,"outputTokens":287,"cacheReadInputTokens":2236,"cacheCreationInputTokens":0,"webSearchRequests":0,"costUSD":0.0049818,"contextWindow":200000},"claude-sonnet-4-5":{"inputTokens":23,"outputTokens":18819,"cacheReadInputTokens":569706,"cacheCreationInputTokens":234710,"webSearchRequests":0,"costUSD":1.3334282999999998,"contextWindow":200000}},"permission_denials":[],"uuid":"78e0dd26-2985-4559-b94b-c798b9f8ff7c"}
